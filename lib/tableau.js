/*! tableau-2.1.0 */
(function(){
/*! BEGIN MscorlibSlim */
var global={};(function(global){"use strict";var ss={__assemblies:{}};ss.initAssembly=function assembly(obj,name,res){res=res||{};obj.name=name;obj.toString=function(){return this.name};obj.__types={};obj.getResourceNames=function(){return Object.keys(res)};obj.getResourceDataBase64=function(name){return res[name]||null};obj.getResourceData=function(name){var r=res[name];return r?ss.dec64(r):null};ss.__assemblies[name]=obj};ss.initAssembly(ss,'mscorlib');ss.getAssemblies=function ss$getAssemblies(){return Object.keys(ss.__assemblies).map(function(n){return ss.__assemblies[n]})};ss.isNullOrUndefined=function ss$isNullOrUndefined(o){return(o===null)||(o===undefined)};ss.isValue=function ss$isValue(o){return(o!==null)&&(o!==undefined)};ss.referenceEquals=function ss$referenceEquals(a,b){return ss.isValue(a)?a===b:!ss.isValue(b)};ss.mkdict=function ss$mkdict(){var a=(arguments.length!=1?arguments:arguments[0]);var r={};for(var i=0;i<a.length;i+=2){r[a[i]]=a[i+1]}return r};ss.clone=function ss$clone(t,o){return o?t.$clone(o):o};ss.coalesce=function ss$coalesce(a,b){return ss.isValue(a)?a:b};ss.isDate=function ss$isDate(obj){return Object.prototype.toString.call(obj)==='[object Date]'};ss.isArray=function ss$isArray(obj){return Object.prototype.toString.call(obj)==='[object Array]'};ss.isTypedArrayType=function ss$isTypedArrayType(type){return['Float32Array','Float64Array','Int8Array','Int16Array','Int32Array','Uint8Array','Uint16Array','Uint32Array','Uint8ClampedArray'].indexOf(ss.getTypeFullName(type))>=0};ss.isArrayOrTypedArray=function ss$isArray(obj){return ss.isArray(obj)||ss.isTypedArrayType(ss.getInstanceType(obj))};ss.getHashCode=function ss$getHashCode(obj){if(!ss.isValue(obj))throw new ss_NullReferenceException('Cannot get hash code of null');else if(typeof(obj.getHashCode)==='function')return obj.getHashCode();else if(typeof(obj)==='boolean'){return obj?1:0}else if(typeof(obj)==='number'){var s=obj.toExponential();s=s.substr(0,s.indexOf('e'));return parseInt(s.replace('.',''),10)&0xffffffff}else if(typeof(obj)==='string'){var res=0;for(var i=0;i<obj.length;i++)res=(res*31+obj.charCodeAt(i))&0xffffffff;return res}else if(ss.isDate(obj)){return obj.valueOf()&0xffffffff}else{return ss.defaultHashCode(obj)}};ss.defaultHashCode=function ss$defaultHashCode(obj){return obj.$__hashCode__||(obj.$__hashCode__=(Math.random()*0x100000000)|0)};ss.equals=function ss$equals(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(a!==ss&&typeof(a.equals)==='function')return a.equals(b);if(ss.isDate(a)&&ss.isDate(b))return a.valueOf()===b.valueOf();else if(typeof(a)==='function'&&typeof(b)==='function')return ss.delegateEquals(a,b);else if(ss.isNullOrUndefined(a)&&ss.isNullOrUndefined(b))return true;else return a===b};ss.compare=function ss$compare(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(typeof(a)==='number'||typeof(a)==='string'||typeof(a)==='boolean')return a<b?-1:(a>b?1:0);else if(ss.isDate(a))return ss.compare(a.valueOf(),b.valueOf());else return a.compareTo(b)};ss.equalsT=function ss$equalsT(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(typeof(a)==='number'||typeof(a)==='string'||typeof(a)==='boolean')return a===b;else if(ss.isDate(a))return a.valueOf()===b.valueOf();else return a.equalsT(b)};ss.staticEquals=function ss$staticEquals(a,b){if(!ss.isValue(a))return!ss.isValue(b);else return ss.isValue(b)?ss.equals(a,b):false};ss.shallowCopy=function ss$shallowCopy(source,target){var keys=Object.keys(source);for(var i=0,l=keys.length;i<l;i++){var k=keys[i];target[k]=source[k]}};ss.isLower=function ss$isLower(c){var s=String.fromCharCode(c);return s===s.toLowerCase()&&s!==s.toUpperCase()};ss.isUpper=function ss$isUpper(c){var s=String.fromCharCode(c);return s!==s.toLowerCase()&&s===s.toUpperCase()};if(typeof(window)=='object'){if(!window.Element){window.Element=function(){};window.Element.isInstanceOfType=function(instance){return instance&&typeof instance.constructor==='undefined'&&typeof instance.tagName==='string'}}window.Element.__typeName='Element'}ss.clearKeys=function ss$clearKeys(d){for(var n in d){if(d.hasOwnProperty(n))delete d[n]}};ss.keyExists=function ss$keyExists(d,key){return d[key]!==undefined};if(!Object.keys){Object.keys=(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object')}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}}())}ss.getKeyCount=function ss$getKeyCount(d){return Object.keys(d).length};ss.__genericCache={};ss._makeGenericTypeName=function ss$_makeGenericTypeName(genericType,typeArguments){var result=genericType.__typeName;for(var i=0;i<typeArguments.length;i++)result+=(i===0?'[':',')+'['+ss.getTypeQName(typeArguments[i])+']';result+=']';return result};ss.makeGenericType=function ss$makeGenericType(genericType,typeArguments){var name=ss._makeGenericTypeName(genericType,typeArguments);return ss.__genericCache[name]||genericType.apply(null,typeArguments)};ss.registerGenericClassInstance=function ss$registerGenericClassInstance(instance,genericType,typeArguments,members,baseType,interfaceTypes){var name=ss._makeGenericTypeName(genericType,typeArguments);ss.__genericCache[name]=instance;instance.__typeName=name;instance.__genericTypeDefinition=genericType;instance.__typeArguments=typeArguments;ss.initClass(instance,genericType.__assembly,members,baseType(),interfaceTypes())};ss.registerGenericInterfaceInstance=function ss$registerGenericInterfaceInstance(instance,genericType,typeArguments,members,baseInterfaces){var name=ss._makeGenericTypeName(genericType,typeArguments);ss.__genericCache[name]=instance;instance.__typeName=name;instance.__genericTypeDefinition=genericType;instance.__typeArguments=typeArguments;ss.initInterface(instance,genericType.__assembly,members,baseInterfaces())};ss.isGenericTypeDefinition=function ss$isGenericTypeDefinition(type){return type.__isGenericTypeDefinition||false};ss.getGenericTypeDefinition=function ss$getGenericTypeDefinition(type){return type.__genericTypeDefinition||null};ss.getGenericParameterCount=function ss$getGenericParameterCount(type){return type.__typeArgumentCount||0};ss.getGenericArguments=function ss$getGenericArguments(type){return type.__typeArguments||null};ss.setMetadata=function ss$_setMetadata(type,metadata){if(metadata.members){for(var i=0;i<metadata.members.length;i++){var m=metadata.members[i];m.typeDef=type;if(m.adder)m.adder.typeDef=type;if(m.remover)m.remover.typeDef=type;if(m.getter)m.getter.typeDef=type;if(m.setter)m.setter.typeDef=type}}type.__metadata=metadata;if(metadata.variance){type.isAssignableFrom=function(source){var check=function(target,type){if(type.__genericTypeDefinition===target.__genericTypeDefinition&&type.__typeArguments.length==target.__typeArguments.length){for(var i=0;i<target.__typeArguments.length;i++){var v=target.__metadata.variance[i],t=target.__typeArguments[i],s=type.__typeArguments[i];switch(v){case 1:if(!ss.isAssignableFrom(t,s))return false;break;case 2:if(!ss.isAssignableFrom(s,t))return false;break;default:if(s!==t)return false}}return true}return false};if(source.__interface&&check(this,source))return true;var ifs=ss.getInterfaces(source);for(var i=0;i<ifs.length;i++){if(ifs[i]===this||check(this,ifs[i]))return true}return false}}};ss.setMetadata=function ss$_setMetadata(type,metadata){};ss.initClass=function ss$initClass(ctor,asm,members,baseType,interfaces){ctor.__class=true;ctor.__assembly=asm;if(!ctor.__typeArguments)asm.__types[ctor.__typeName]=ctor;if(baseType&&baseType!==Object){var f=function(){};f.prototype=baseType.prototype;ctor.prototype=new f;ctor.prototype.constructor=ctor}ss.shallowCopy(members,ctor.prototype);if(interfaces)ctor.__interfaces=interfaces};ss.initGenericClass=function ss$initGenericClass(ctor,asm,typeArgumentCount){ctor.__class=true;ctor.__assembly=asm;asm.__types[ctor.__typeName]=ctor;ctor.__typeArgumentCount=typeArgumentCount;ctor.__isGenericTypeDefinition=true};ss.initInterface=function ss$initInterface(ctor,asm,members,baseInterfaces){ctor.__interface=true;ctor.__assembly=asm;if(!ctor.__typeArguments)asm.__types[ctor.__typeName]=ctor;if(baseInterfaces)ctor.__interfaces=baseInterfaces;ss.shallowCopy(members,ctor.prototype);ctor.isAssignableFrom=function(type){return ss.contains(ss.getInterfaces(type),this)}};ss.initGenericInterface=function ss$initGenericClass(ctor,asm,typeArgumentCount){ctor.__interface=true;ctor.__assembly=asm;asm.__types[ctor.__typeName]=ctor;ctor.__typeArgumentCount=typeArgumentCount;ctor.__isGenericTypeDefinition=true};ss.initEnum=function ss$initEnum(ctor,asm,members,namedValues){ctor.__enum=true;ctor.__assembly=asm;asm.__types[ctor.__typeName]=ctor;ss.shallowCopy(members,ctor.prototype);ctor.getDefaultValue=ctor.createInstance=function(){return namedValues?null:0};ctor.isInstanceOfType=function(instance){return typeof(instance)==(namedValues?'string':'number')}};ss.getBaseType=function ss$getBaseType(type){if(type===Object||type.__interface){return null}else if(Object.getPrototypeOf){return Object.getPrototypeOf(type.prototype).constructor}else{var p=type.prototype;if(Object.prototype.hasOwnProperty.call(p,'constructor')){try{var ownValue=p.constructor;delete p.constructor;return p.constructor}finally{p.constructor=ownValue}}return p.constructor}};ss.getTypeFullName=function ss$getTypeFullName(type){return type.__typeName||type.name||(type.toString().match(/^\s*function\s*([^\s(]+)/)||[])[1]||'Object'};ss.getTypeQName=function ss$getTypeFullName(type){return ss.getTypeFullName(type)+(type.__assembly?', '+type.__assembly.name:'')};ss.getTypeName=function ss$getTypeName(type){var fullName=ss.getTypeFullName(type);var bIndex=fullName.indexOf('[');var nsIndex=fullName.lastIndexOf('.',bIndex>=0?bIndex:fullName.length);return nsIndex>0?fullName.substr(nsIndex+1):fullName};ss.getTypeNamespace=function ss$getTypeNamespace(type){var fullName=ss.getTypeFullName(type);var bIndex=fullName.indexOf('[');var nsIndex=fullName.lastIndexOf('.',bIndex>=0?bIndex:fullName.length);return nsIndex>0?fullName.substr(0,nsIndex):''};ss.getTypeAssembly=function ss$getTypeAssembly(type){if(ss.contains([Date,Number,Boolean,String,Function,Array],type))return ss;else return type.__assembly||null};ss._getAssemblyType=function ss$_getAssemblyType(asm,name){var result=[];if(asm.__types){return asm.__types[name]||null}else{var a=name.split('.');for(var i=0;i<a.length;i++){asm=asm[a[i]];if(!ss.isValue(asm))return null}if(typeof asm!=='function')return null;return asm}};ss.getAssemblyTypes=function ss$getAssemblyTypes(asm){var result=[];if(asm.__types){for(var t in asm.__types){if(asm.__types.hasOwnProperty(t))result.push(asm.__types[t])}}else{var traverse=function(s,n){for(var c in s){if(s.hasOwnProperty(c))traverse(s[c],c)}if(typeof(s)==='function'&&ss.isUpper(n.charCodeAt(0)))result.push(s)};traverse(asm,'')}return result};ss.createAssemblyInstance=function ss$createAssemblyInstance(asm,typeName){var t=ss.getType(typeName,asm);return t?ss.createInstance(t):null};ss.getInterfaces=function ss$getInterfaces(type){if(type.__interfaces)return type.__interfaces;else if(type===Date||type===Number)return[ss_IEquatable,ss_IComparable,ss_IFormattable];else if(type===Boolean||type===String)return[ss_IEquatable,ss_IComparable];else if(type===Array||ss.isTypedArrayType(type))return[ss_IEnumerable,ss_ICollection,ss_IList];else return[]};ss.isInstanceOfType=function ss$isInstanceOfType(instance,type){if(ss.isNullOrUndefined(instance))return false;if(typeof(type.isInstanceOfType)==='function')return type.isInstanceOfType(instance);return ss.isAssignableFrom(type,ss.getInstanceType(instance))};ss.isAssignableFrom=function ss$isAssignableFrom(target,type){return target===type||(typeof(target.isAssignableFrom)==='function'&&target.isAssignableFrom(type))||type.prototype instanceof target};ss.isClass=function Type$isClass(type){return(type.__class==true||type===Array||type===Function||type===RegExp||type===String||type===Error||type===Object)};ss.isEnum=function Type$isEnum(type){return!!type.__enum};ss.isFlags=function Type$isFlags(type){return type.__metadata&&type.__metadata.enumFlags||false};ss.isInterface=function Type$isInterface(type){return!!type.__interface};ss.safeCast=function ss$safeCast(instance,type){if(type===true)return instance;else if(type===false)return null;else return ss.isInstanceOfType(instance,type)?instance:null};ss.cast=function ss$cast(instance,type){if(instance===null||typeof(instance)==='undefined')return instance;else if(type===true||(type!==false&&ss.isInstanceOfType(instance,type)))return instance;throw new ss_InvalidCastException('Cannot cast object to type '+ss.getTypeFullName(type))};ss.getInstanceType=function ss$getInstanceType(instance){if(!ss.isValue(instance))throw new ss_NullReferenceException('Cannot get type of null');try{return instance.constructor}catch(ex){return Object}};ss._getType=function(typeName,asm,re){var outer=!re;re=re||/[[,\]]/g;var last=re.lastIndex,m=re.exec(typeName),tname,targs=[];if(m){tname=typeName.substring(last,m.index);switch(m[0]){case'[':if(typeName[m.index+1]!='[')return null;for(;;){re.exec(typeName);var t=ss._getType(typeName,global,re);if(!t)return null;targs.push(t);m=re.exec(typeName);if(m[0]===']')break;else if(m[0]!==',')return null}m=re.exec(typeName);if(m&&m[0]===','){re.exec(typeName);if(!(asm=ss.__assemblies[(re.lastIndex>0?typeName.substring(m.index+1,re.lastIndex-1):typeName.substring(m.index+1)).trim()]))return null}break;case']':break;case',':re.exec(typeName);if(!(asm=ss.__assemblies[(re.lastIndex>0?typeName.substring(m.index+1,re.lastIndex-1):typeName.substring(m.index+1)).trim()]))return null;break}}else{tname=typeName.substring(last)}if(outer&&re.lastIndex)return null;var t=ss._getAssemblyType(asm,tname.trim());return targs.length?ss.makeGenericType(t,targs):t};ss.getType=function ss$getType(typeName,asm){return typeName?ss._getType(typeName,asm||global):null};ss.getDefaultValue=function ss$getDefaultValue(type){if(typeof(type.getDefaultValue)==='function')return type.getDefaultValue();else if(type===Boolean)return false;else if(type===Date)return new Date(0);else if(type===Number)return 0;return null};ss.createInstance=function ss$createInstance(type){if(typeof(type.createInstance)==='function')return type.createInstance();else if(type===Boolean)return false;else if(type===Date)return new Date(0);else if(type===Number)return 0;else if(type===String)return'';else return new type};var ss_IFormattable=function IFormattable$(){};ss_IFormattable.__typeName='ss.IFormattable';ss.IFormattable=ss_IFormattable;ss.initInterface(ss_IFormattable,ss,{format:null});var ss_IComparable=function IComparable$(){};ss_IComparable.__typeName='ss.IComparable';ss.IComparable=ss_IComparable;ss.initInterface(ss_IComparable,ss,{compareTo:null});var ss_IEquatable=function IEquatable$(){};ss_IEquatable.__typeName='ss.IEquatable';ss.IEquatable=ss_IEquatable;ss.initInterface(ss_IEquatable,ss,{equalsT:null});ss.isNullOrEmptyString=function ss$isNullOrEmptyString(s){return!s||!s.length};if(!String.prototype.trim){String.prototype.trim=function String$trim(){return ss.trimStartString(ss.trimEndString(this))}}ss.trimEndString=function ss$trimEndString(s,chars){return s.replace(chars?new RegExp('['+String.fromCharCode.apply(null,chars)+']+$'):/\s*$/,'')};ss.trimStartString=function ss$trimStartString(s,chars){return s.replace(chars?new RegExp('^['+String.fromCharCode.apply(null,chars)+']+'):/^\s*/,'')};ss.trimString=function ss$trimString(s,chars){return ss.trimStartString(ss.trimEndString(s,chars),chars)};ss.arrayClone=function ss$arrayClone(arr){if(arr.length===1){return[arr[0]]}else{return Array.apply(null,arr)}};if(!Array.prototype.map){Array.prototype.map=function Array$map(callback,instance){var length=this.length;var mapped=new Array(length);for(var i=0;i<length;i++){if(i in this){mapped[i]=callback.call(instance,this[i],i,this)}}return mapped}}if(!Array.prototype.some){Array.prototype.some=function Array$some(callback,instance){var length=this.length;for(var i=0;i<length;i++){if(i in this&&callback.call(instance,this[i],i,this)){return true}}return false}}if(!Array.prototype.forEach){Array.prototype.forEach=function(callback,thisArg){var T,k;if(this==null){throw new TypeError(' this is null or not defined')}var O=Object(this);var len=O.length>>>0;if(typeof callback!=="function"){throw new TypeError(callback+' is not a function')}if(arguments.length>1){T=thisArg}k=0;while(k<len){var kValue;if(k in O){kValue=O[k];callback.call(T,kValue,k,O)}k++}}}if(!Array.prototype.filter){Array.prototype.filter=function(fun){if(this===void 0||this===null){throw new TypeError}var t=Object(this);var len=t.length>>>0;if(typeof fun!=='function'){throw new TypeError}var res=[];var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++){if(i in t){var val=t[i];if(fun.call(thisArg,val,i,t)){res.push(val)}}}return res}}ss._delegateContains=function ss$_delegateContains(targets,object,method){for(var i=0;i<targets.length;i+=2){if(targets[i]===object&&targets[i+1]===method){return true}}return false};ss._mkdel=function ss$_mkdel(targets){var delegate=function(){if(targets.length==2){return targets[1].apply(targets[0],arguments)}else{var clone=ss.arrayClone(targets);for(var i=0;i<clone.length;i+=2){if(ss._delegateContains(targets,clone[i],clone[i+1])){clone[i+1].apply(clone[i],arguments)}}return null}};delegate._targets=targets;return delegate};ss.mkdel=function ss$mkdel(object,method){if(!object){return method}return ss._mkdel([object,method])};ss.delegateCombine=function ss$delegateCombine(delegate1,delegate2){if(!delegate1){if(!delegate2._targets){return ss.mkdel(null,delegate2)}return delegate2}if(!delegate2){if(!delegate1._targets){return ss.mkdel(null,delegate1)}return delegate1}var targets1=delegate1._targets?delegate1._targets:[null,delegate1];var targets2=delegate2._targets?delegate2._targets:[null,delegate2];return ss._mkdel(targets1.concat(targets2))};ss.delegateRemove=function ss$delegateRemove(delegate1,delegate2){if(!delegate1||(delegate1===delegate2)){return null}if(!delegate2){return delegate1}var targets=delegate1._targets;var object=null;var method;if(delegate2._targets){object=delegate2._targets[0];method=delegate2._targets[1]}else{method=delegate2}for(var i=0;i<targets.length;i+=2){if((targets[i]===object)&&(targets[i+1]===method)){if(targets.length==2){return null}var t=ss.arrayClone(targets);t.splice(i,2);return ss._mkdel(t)}}return delegate1};ss.delegateEquals=function ss$delegateEquals(a,b){if(a===b)return true;if(!a._targets&&!b._targets)return false;var ta=a._targets||[null,a],tb=b._targets||[null,b];if(ta.length!=tb.length)return false;for(var i=0;i<ta.length;i++){if(ta[i]!==tb[i])return false}return true};var ss_Enum=function Enum$(){};ss_Enum.__typeName='ss.Enum';ss.Enum=ss_Enum;ss.initClass(ss_Enum,ss,{});ss_Enum.getValues=function Enum$getValues(enumType){var parts=[];var values=enumType.prototype;for(var i in values){if(values.hasOwnProperty(i))parts.push(values[i])}return parts};var ss_IEnumerator=function IEnumerator$(){};ss_IEnumerator.__typeName='ss.IEnumerator';ss.IEnumerator=ss_IEnumerator;ss.initInterface(ss_IEnumerator,ss,{current:null,moveNext:null,reset:null},[ss_IDisposable]);var ss_IEnumerable=function IEnumerable$(){};ss_IEnumerable.__typeName='ss.IEnumerable';ss.IEnumerable=ss_IEnumerable;ss.initInterface(ss_IEnumerable,ss,{getEnumerator:null});ss.getEnumerator=function ss$getEnumerator(obj){return obj.getEnumerator?obj.getEnumerator():new ss_ArrayEnumerator(obj)};var ss_ICollection=function ICollection$(){};ss_ICollection.__typeName='ss.ICollection';ss.ICollection=ss_ICollection;ss.initInterface(ss_ICollection,ss,{get_count:null,add:null,clear:null,contains:null,remove:null});ss.count=function ss$count(obj){return obj.get_count?obj.get_count():obj.length};ss.add=function ss$add(obj,item){if(obj.add)obj.add(item);else if(ss.isArray(obj))obj.push(item);else throw new ss_NotSupportedException};ss.clear=function ss$clear(obj){if(obj.clear)obj.clear();else if(ss.isArray(obj))obj.length=0;else throw new ss_NotSupportedException};ss.remove=function ss$remove(obj,item){if(obj.remove)return obj.remove(item);else if(ss.isArray(obj)){var index=ss.indexOf(obj,item);if(index>=0){obj.splice(index,1);return true}return false}else throw new ss_NotSupportedException};ss.contains=function ss$contains(obj,item){if(obj.contains)return obj.contains(item);else return ss.indexOf(obj,item)>=0};var ss_IEqualityComparer=function IEqualityComparer$(){};ss_IEqualityComparer.__typeName='ss.IEqualityComparer';ss.IEqualityComparer=ss_IEqualityComparer;ss.initInterface(ss_IEqualityComparer,ss,{areEqual:null,getObjectHashCode:null});var ss_IComparer=function IComparer$(){};ss_IComparer.__typeName='ss.IComparer';ss.IComparer=ss_IComparer;ss.initInterface(ss_IComparer,ss,{compare:null});ss.unbox=function ss$unbox(instance){if(!ss.isValue(instance))throw new ss_InvalidOperationException('Nullable object must have a value.');return instance};var ss_Nullable$1=function Nullable$1$(T){var $type=function(){};$type.isInstanceOfType=function(instance){return ss.isInstanceOfType(instance,T)};ss.registerGenericClassInstance($type,ss_Nullable$1,[T],{},function(){return null},function(){return[]});return $type};ss_Nullable$1.__typeName='ss.Nullable$1';ss.Nullable$1=ss_Nullable$1;ss.initGenericClass(ss_Nullable$1,ss,1);ss_Nullable$1.eq=function Nullable$eq(a,b){return!ss.isValue(a)?!ss.isValue(b):(a===b)};ss_Nullable$1.ne=function Nullable$eq(a,b){return!ss.isValue(a)?ss.isValue(b):(a!==b)};ss_Nullable$1.le=function Nullable$le(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<=b};ss_Nullable$1.ge=function Nullable$ge(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>=b};ss_Nullable$1.lt=function Nullable$lt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<b};ss_Nullable$1.gt=function Nullable$gt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>b};ss_Nullable$1.sub=function Nullable$sub(a,b){return ss.isValue(a)&&ss.isValue(b)?a-b:null};ss_Nullable$1.add=function Nullable$add(a,b){return ss.isValue(a)&&ss.isValue(b)?a+b:null};ss_Nullable$1.mod=function Nullable$mod(a,b){return ss.isValue(a)&&ss.isValue(b)?a%b:null};ss_Nullable$1.div=function Nullable$divf(a,b){return ss.isValue(a)&&ss.isValue(b)?a/b:null};ss_Nullable$1.mul=function Nullable$mul(a,b){return ss.isValue(a)&&ss.isValue(b)?a*b:null};ss_Nullable$1.band=function Nullable$band(a,b){return ss.isValue(a)&&ss.isValue(b)?a&b:null};ss_Nullable$1.bor=function Nullable$bor(a,b){return ss.isValue(a)&&ss.isValue(b)?a|b:null};ss_Nullable$1.xor=function Nullable$xor(a,b){return ss.isValue(a)&&ss.isValue(b)?a^b:null};ss_Nullable$1.shl=function Nullable$shl(a,b){return ss.isValue(a)&&ss.isValue(b)?a<<b:null};ss_Nullable$1.srs=function Nullable$srs(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>b:null};ss_Nullable$1.sru=function Nullable$sru(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>>b:null};ss_Nullable$1.and=function Nullable$and(a,b){if(a===true&&b===true)return true;else if(a===false||b===false)return false;else return null};ss_Nullable$1.or=function Nullable$or(a,b){if(a===true||b===true)return true;else if(a===false&&b===false)return false;else return null};ss_Nullable$1.not=function Nullable$not(a){return ss.isValue(a)?!a:null};ss_Nullable$1.neg=function Nullable$neg(a){return ss.isValue(a)?-a:null};ss_Nullable$1.pos=function Nullable$pos(a){return ss.isValue(a)?+a:null};ss_Nullable$1.cpl=function Nullable$cpl(a){return ss.isValue(a)?~a:null};ss_Nullable$1.lift=function Nullable$lift(){for(var i=0;i<arguments.length;i++){if(!ss.isValue(arguments[i]))return null}return arguments[0].apply(null,Array.prototype.slice.call(arguments,1))};var ss_IList=function IList$(){};ss_IList.__typeName='ss.IList';ss.IList=ss_IList;ss.initInterface(ss_IList,ss,{get_item:null,set_item:null,indexOf:null,insert:null,removeAt:null},[ss_ICollection,ss_IEnumerable]);ss.getItem=function ss$getItem(obj,index){return obj.get_item?obj.get_item(index):obj[index]};ss.setItem=function ss$setItem(obj,index,value){obj.set_item?obj.set_item(index,value):(obj[index]=value)};ss.indexOf=function ss$indexOf(obj,item){var itemType=typeof(item);if((!item||typeof(item.equals)!=='function')&&typeof(obj.indexOf)==='function'){return obj.indexOf(item)}else if(ss.isArrayOrTypedArray(obj)){for(var i=0;i<obj.length;i++){if(ss.staticEquals(obj[i],item)){return i}}return-1}else return obj.indexOf(item)};ss.insert=function ss$insert(obj,index,item){if(obj.insert)obj.insert(index,item);else if(ss.isArray(obj))obj.splice(index,0,item);else throw new ss_NotSupportedException};ss.removeAt=function ss$removeAt(obj,index){if(obj.removeAt)obj.removeAt(index);else if(ss.isArray(obj))obj.splice(index,1);else throw new ss_NotSupportedException};var ss_IDictionary=function IDictionary$(){};ss_IDictionary.__typeName='ss.IDictionary';ss.IDictionary=ss_IDictionary;ss.initInterface(ss_IDictionary,ss,{get_item:null,set_item:null,get_keys:null,get_values:null,containsKey:null,add:null,remove:null,tryGetValue:null},[ss_IEnumerable]);var ss_Int32=function Int32$(){};ss_Int32.__typeName='ss.Int32';ss.Int32=ss_Int32;ss.initClass(ss_Int32,ss,{},Object,[ss_IEquatable,ss_IComparable,ss_IFormattable]);ss_Int32.__class=false;ss_Int32.isInstanceOfType=function Int32$isInstanceOfType(instance){return typeof(instance)==='number'&&isFinite(instance)&&Math.round(instance,0)==instance};ss_Int32.getDefaultValue=ss_Int32.createInstance=function Int32$getDefaultValue(){return 0};ss_Int32.div=function Int32$div(a,b){if(!ss.isValue(a)||!ss.isValue(b))return null;if(b===0)throw new ss_DivideByZeroException;return ss_Int32.trunc(a/b)};ss_Int32.trunc=function Int32$trunc(n){return ss.isValue(n)?(n>0?Math.floor(n):Math.ceil(n)):null};ss_Int32.tryParse=function Int32$tryParse(s,result,min,max){result.$=0;if(!/^[+-]?[0-9]+$/.test(s))return 0;var n=parseInt(s,10);if(n<min||n>max)return false;result.$=n;return true};var ss_JsDate=function JsDate$(){};ss_JsDate.__typeName='ss.JsDate';ss.JsDate=ss_JsDate;ss.initClass(ss_JsDate,ss,{},Object,[ss_IEquatable,ss_IComparable]);ss_JsDate.createInstance=function JsDate$createInstance(){return new Date};ss_JsDate.isInstanceOfType=function JsDate$isInstanceOfType(instance){return instance instanceof Date};var ss_ArrayEnumerator=function ArrayEnumerator$(array){this._array=array;this._index=-1};ss_ArrayEnumerator.__typeName='ss.ArrayEnumerator';ss.ArrayEnumerator=ss_ArrayEnumerator;ss.initClass(ss_ArrayEnumerator,ss,{moveNext:function ArrayEnumerator$moveNext(){this._index++;return(this._index<this._array.length)},reset:function ArrayEnumerator$reset(){this._index=-1},current:function ArrayEnumerator$current(){if(this._index<0||this._index>=this._array.length)throw'Invalid operation';return this._array[this._index]},dispose:function ArrayEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_ObjectEnumerator=function ObjectEnumerator$(o){this._keys=Object.keys(o);this._index=-1;this._object=o};ss_ObjectEnumerator.__typeName='ss.ObjectEnumerator';ss.ObjectEnumerator=ss_ObjectEnumerator;ss.initClass(ss_ObjectEnumerator,ss,{moveNext:function ObjectEnumerator$moveNext(){this._index++;return(this._index<this._keys.length)},reset:function ObjectEnumerator$reset(){this._index=-1},current:function ObjectEnumerator$current(){if(this._index<0||this._index>=this._keys.length)throw new ss_InvalidOperationException('Invalid operation');var k=this._keys[this._index];return{key:k,value:this._object[k]}},dispose:function ObjectEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_EqualityComparer=function EqualityComparer$(){};ss_EqualityComparer.__typeName='ss.EqualityComparer';ss.EqualityComparer=ss_EqualityComparer;ss.initClass(ss_EqualityComparer,ss,{areEqual:function EqualityComparer$areEqual(x,y){return ss.staticEquals(x,y)},getObjectHashCode:function EqualityComparer$getObjectHashCode(obj){return ss.isValue(obj)?ss.getHashCode(obj):0}},null,[ss_IEqualityComparer]);ss_EqualityComparer.def=new ss_EqualityComparer;var ss_Comparer=function Comparer$(f){this.f=f};ss_Comparer.__typeName='ss.Comparer';ss.Comparer=ss_Comparer;ss.initClass(ss_Comparer,ss,{compare:function Comparer$compare(x,y){return this.f(x,y)}},null,[ss_IComparer]);ss_Comparer.def=new ss_Comparer(function Comparer$defaultCompare(a,b){if(!ss.isValue(a))return!ss.isValue(b)?0:-1;else if(!ss.isValue(b))return 1;else return ss.compare(a,b)});var ss_IDisposable=function IDisposable$(){};ss_IDisposable.__typeName='ss.IDisposable';ss.IDisposable=ss_IDisposable;ss.initInterface(ss_IDisposable,ss,{dispose:null});var ss_StringBuilder=function StringBuilder$(s){this._parts=(ss.isValue(s)&&s!='')?[s]:[];this.length=ss.isValue(s)?s.length:0};ss_StringBuilder.__typeName='ss.StringBuilder';ss.StringBuilder=ss_StringBuilder;ss.initClass(ss_StringBuilder,ss,{append:function StringBuilder$append(o){if(ss.isValue(o)){var s=o.toString();ss.add(this._parts,s);this.length+=s.length}return this},appendChar:function StringBuilder$appendChar(c){return this.append(String.fromCharCode(c))},appendLine:function StringBuilder$appendLine(s){this.append(s);this.append('\r\n');return this},appendLineChar:function StringBuilder$appendLineChar(c){return this.appendLine(String.fromCharCode(c))},clear:function StringBuilder$clear(){this._parts=[];this.length=0},toString:function StringBuilder$toString(){return this._parts.join('')}});var ss_EventArgs=function EventArgs$(){};ss_EventArgs.__typeName='ss.EventArgs';ss.EventArgs=ss_EventArgs;ss.initClass(ss_EventArgs,ss,{});ss_EventArgs.Empty=new ss_EventArgs;var ss_Exception=function Exception$(message,innerException){this._message=message||'An error occurred.';this._innerException=innerException||null;this._error=new Error};ss_Exception.__typeName='ss.Exception';ss.Exception=ss_Exception;ss.initClass(ss_Exception,ss,{get_message:function Exception$get_message(){return this._message},get_innerException:function Exception$get_innerException(){return this._innerException},get_stack:function Exception$get_stack(){return this._error.stack}});ss_Exception.wrap=function Exception$wrap(o){if(ss.isInstanceOfType(o,ss_Exception)){return o}else if(o instanceof TypeError){return new ss_NullReferenceException(o.message,new ss_JsErrorException(o))}else if(o instanceof RangeError){return new ss_ArgumentOutOfRangeException(null,o.message,new ss_JsErrorException(o))}else if(o instanceof Error){return new ss_JsErrorException(o)}else{return new ss_Exception(o.toString())}};var ss_NotImplementedException=function NotImplementedException$(message,innerException){ss_Exception.call(this,message||'The method or operation is not implemented.',innerException)};ss_NotImplementedException.__typeName='ss.NotImplementedException';ss.NotImplementedException=ss_NotImplementedException;ss.initClass(ss_NotImplementedException,ss,{},ss_Exception);var ss_NotSupportedException=function NotSupportedException$(message,innerException){ss_Exception.call(this,message||'Specified method is not supported.',innerException)};ss_NotSupportedException.__typeName='ss.NotSupportedException';ss.NotSupportedException=ss_NotSupportedException;ss.initClass(ss_NotSupportedException,ss,{},ss_Exception);var ss_AggregateException=function AggregateException$(message,innerExceptions){this.innerExceptions=ss.isValue(innerExceptions)?ss.arrayFromEnumerable(innerExceptions):[];ss_Exception.call(this,message||'One or more errors occurred.',this.innerExceptions.length?this.innerExceptions[0]:null)};ss_AggregateException.__typeName='ss.AggregateException';ss.AggregateException=ss_AggregateException;ss.initClass(ss_AggregateException,ss,{flatten:function AggregateException$flatten(){var inner=[];for(var i=0;i<this.innerExceptions.length;i++){var e=this.innerExceptions[i];if(ss.isInstanceOfType(e,ss_AggregateException)){inner.push.apply(inner,e.flatten().innerExceptions)}else{inner.push(e)}}return new ss_AggregateException(this._message,inner)}},ss_Exception);var ss_PromiseException=function PromiseException(args,message,innerException){ss_Exception.call(this,message||(args.length&&args[0]?args[0].toString():'An error occurred'),innerException);this.arguments=ss.arrayClone(args)};ss_PromiseException.__typeName='ss.PromiseException';ss.PromiseException=ss_PromiseException;ss.initClass(ss_PromiseException,ss,{get_arguments:function PromiseException$get_arguments(){return this._arguments}},ss_Exception);var ss_JsErrorException=function JsErrorException$(error,message,innerException){ss_Exception.call(this,message||error.message,innerException);this.error=error};ss_JsErrorException.__typeName='ss.JsErrorException';ss.JsErrorException=ss_JsErrorException;ss.initClass(ss_JsErrorException,ss,{get_stack:function Exception$get_stack(){return this.error.stack}},ss_Exception);var ss_ArgumentException=function ArgumentException$(message,paramName,innerException){ss_Exception.call(this,message||'Value does not fall within the expected range.',innerException);this.paramName=paramName||null};ss_ArgumentException.__typeName='ss.ArgumentException';ss.ArgumentException=ss_ArgumentException;ss.initClass(ss_ArgumentException,ss,{},ss_Exception);var ss_ArgumentNullException=function ArgumentNullException$(paramName,message,innerException){if(!message){message='Value cannot be null.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException)};ss_ArgumentNullException.__typeName='ss.ArgumentNullException';ss.ArgumentNullException=ss_ArgumentNullException;ss.initClass(ss_ArgumentNullException,ss,{},ss_ArgumentException);var ss_ArgumentOutOfRangeException=function ArgumentOutOfRangeException$(paramName,message,innerException,actualValue){if(!message){message='Value is out of range.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException);this.actualValue=actualValue||null};ss_ArgumentOutOfRangeException.__typeName='ss.ArgumentOutOfRangeException';ss.ArgumentOutOfRangeException=ss_ArgumentOutOfRangeException;ss.initClass(ss_ArgumentOutOfRangeException,ss,{},ss_ArgumentException);var ss_FormatException=function FormatException$(message,innerException){ss_Exception.call(this,message||'Invalid format.',innerException)};ss_FormatException.__typeName='ss.FormatException';ss.FormatException=ss_FormatException;ss.initClass(ss_FormatException,ss,{},ss_Exception);var ss_DivideByZeroException=function DivideByZeroException$(message,innerException){ss_Exception.call(this,message||'Division by 0.',innerException)};ss_DivideByZeroException.__typeName='ss.DivideByZeroException';ss.DivideByZeroException=ss_DivideByZeroException;ss.initClass(ss_DivideByZeroException,ss,{},ss_Exception);var ss_InvalidCastException=function InvalidCastException$(message,innerException){ss_Exception.call(this,message||'The cast is not valid.',innerException)};ss_InvalidCastException.__typeName='ss.InvalidCastException';ss.InvalidCastException=ss_InvalidCastException;ss.initClass(ss_InvalidCastException,ss,{},ss_Exception);var ss_InvalidOperationException=function InvalidOperationException$(message,innerException){ss_Exception.call(this,message||'Operation is not valid due to the current state of the object.',innerException)};ss_InvalidOperationException.__typeName='ss.InvalidOperationException';ss.InvalidOperationException=ss_InvalidOperationException;ss.initClass(ss_InvalidOperationException,ss,{},ss_Exception);var ss_NullReferenceException=function NullReferenceException$(message,innerException){ss_Exception.call(this,message||'Object is null.',innerException)};ss_NullReferenceException.__typeName='ss.NullReferenceException';ss.NullReferenceException=ss_NullReferenceException;ss.initClass(ss_NullReferenceException,ss,{},ss_Exception);var ss_KeyNotFoundException=function KeyNotFoundException$(message,innerException){ss_Exception.call(this,message||'Key not found.',innerException)};ss_KeyNotFoundException.__typeName='ss.KeyNotFoundException';ss.KeyNotFoundException=ss_KeyNotFoundException;ss.initClass(ss_KeyNotFoundException,ss,{},ss_Exception);var ss_AmbiguousMatchException=function AmbiguousMatchException$(message,innerException){ss_Exception.call(this,message||'Ambiguous match.',innerException)};ss_AmbiguousMatchException.__typeName='ss.AmbiguousMatchException';ss.AmbiguousMatchException=ss_AmbiguousMatchException;ss.initClass(ss_AmbiguousMatchException,ss,{},ss_Exception);var ss_IteratorBlockEnumerable=function IteratorBlockEnumerable$(getEnumerator,$this){this._getEnumerator=getEnumerator;this._this=$this};ss_IteratorBlockEnumerable.__typeName='ss.IteratorBlockEnumerable';ss.IteratorBlockEnumerable=ss_IteratorBlockEnumerable;ss.initClass(ss_IteratorBlockEnumerable,ss,{getEnumerator:function IteratorBlockEnumerable$getEnumerator(){return this._getEnumerator.call(this._this)}},null,[ss_IEnumerable]);var ss_IteratorBlockEnumerator=function IteratorBlockEnumerator$(moveNext,getCurrent,dispose,$this){this._moveNext=moveNext;this._getCurrent=getCurrent;this._dispose=dispose;this._this=$this};ss_IteratorBlockEnumerator.__typeName='ss.IteratorBlockEnumerator';ss.IteratorBlockEnumerator=ss_IteratorBlockEnumerator;ss.initClass(ss_IteratorBlockEnumerator,ss,{moveNext:function IteratorBlockEnumerator$moveNext(){try{return this._moveNext.call(this._this)}catch(ex){if(this._dispose)this._dispose.call(this._this);throw ex}},current:function IteratorBlockEnumerator$current(){return this._getCurrent.call(this._this)},reset:function IteratorBlockEnumerator$reset(){throw new ss_NotSupportedException('Reset is not supported.')},dispose:function IteratorBlockEnumerator$dispose(){if(this._dispose)this._dispose.call(this._this)}},null,[ss_IEnumerator,ss_IDisposable]);var ss_Lazy=function Lazy$(valueFactory){this._valueFactory=valueFactory;this.isValueCreated=false};ss_Lazy.__typeName='ss.Lazy';ss.Lazy=ss_Lazy;ss.initClass(ss_Lazy,ss,{value:function Lazy$value(){if(!this.isValueCreated){this._value=this._valueFactory();delete this._valueFactory;this.isValueCreated=true}return this._value}});if(typeof(global.HTMLElement)==='undefined'){global.HTMLElement=Element}if(typeof(global.MessageEvent)==='undefined'){global.MessageEvent=Event}Date.now=Date.now||function(){return+new Date};global.ss=ss})(global);var ss=global.ss;var HTMLElement=global.HTMLElement;var MessageEvent=global.MessageEvent;
/*! BEGIN CoreSlim */
(function(){'dont use strict';var a={};global.tab=global.tab||{};ss.initAssembly(a,'tabcoreslim');var b=function(){};b.__typeName='tab.EscapingUtil';b.escapeHtml=function(e){var f=ss.coalesce(e,'');f=f.replace(new RegExp('&','g'),'&amp;');f=f.replace(new RegExp('<','g'),'&lt;');f=f.replace(new RegExp('>','g'),'&gt;');f=f.replace(new RegExp('"','g'),'&quot;');f=f.replace(new RegExp("'",'g'),'&#39;');f=f.replace(new RegExp('/','g'),'&#47;');return f};global.tab.EscapingUtil=b;var c=function(){};c.__typeName='tab.ScriptEx';global.tab.ScriptEx=c;var d=function(e){this.$0=null;this.$0=e};d.__typeName='tab.WindowHelper';d.get_windowSelf=function(){return window.self};d.get_selection=function(){if(typeof(window['getSelection'])==='function'){return window.getSelection()}else if(typeof(document['getSelection'])==='function'){return document.getSelection()}return null};d.close=function(e){e.close()};d.getOpener=function(e){return e.opener};d.getLocation=function(e){return e.location};d.getPathAndSearch=function(e){return e.location.pathname+e.location.search};d.setLocationHref=function(e,f){e.location.href=f};d.locationReplace=function(e,f){e.location.replace(f)};d.open=function(e,f,g){return window.open(e,f,g)};d.reload=function(e,f){e.location.reload(f)};d.requestAnimationFrame=function(e){return d.$c(e)};d.cancelAnimationFrame=function(e){if(ss.isValue(e)){d.$b(e)}};d.setTimeout=function(e,f){window.setTimeout(e,f)};d.addListener=function(e,f,g){if('addEventListener'in e){e.addEventListener(f,g,false)}else{e.attachEvent('on'+f,g)}};d.removeListener=function(e,f,g){if('removeEventListener'in e){e.removeEventListener(f,g,false)}else{e.detachEvent('on'+f,g)}};d.$0=function(){var e=0;d.$c=function(f){var g=(new Date).getTime();var h=Math.max(0,16-(g-e));e=g+h;var i=window.setTimeout(f,h);return i}};d.clearSelection=function(){var e=d.get_selection();if(ss.isValue(e)){if(typeof(e['removeAllRanges'])==='function'){e.removeAllRanges()}else if(typeof(e['empty'])==='function'){e['empty']()}}};global.tab.WindowHelper=d;ss.initClass(b,a,{});ss.initClass(c,a,{});ss.initClass(d,a,{get_pageXOffset:function(){return d.$7(this.$0)},get_pageYOffset:function(){return d.$8(this.$0)},get_clientWidth:function(){return d.$2(this.$0)},get_clientHeight:function(){return d.$1(this.$0)},get_innerWidth:function(){return d.$4(this.$0)},get_outerWidth:function(){return d.$6(this.$0)},get_innerHeight:function(){return d.$3(this.$0)},get_outerHeight:function(){return d.$5(this.$0)},get_screenLeft:function(){return d.$9(this.$0)},get_screenTop:function(){return d.$a(this.$0)}});(function(){d.$4=null;d.$3=null;d.$2=null;d.$1=null;d.$7=null;d.$8=null;d.$9=null;d.$a=null;d.$6=null;d.$5=null;d.$c=null;d.$b=null;if('innerWidth'in window){d.$4=function(m){return m.innerWidth}}else{d.$4=function(m){return m.document.documentElement.offsetWidth}}if('outerWidth'in window){d.$6=function(m){return m.outerWidth}}else{d.$6=d.$4}if('innerHeight'in window){d.$3=function(m){return m.innerHeight}}else{d.$3=function(m){return m.document.documentElement.offsetHeight}}if('outerHeight'in window){d.$5=function(m){return m.outerHeight}}else{d.$5=d.$3}if('clientWidth'in window){d.$2=function(m){return m['clientWidth']}}else{d.$2=function(m){return m.document.documentElement.clientWidth}}if('clientHeight'in window){d.$1=function(m){return m['clientHeight']}}else{d.$1=function(m){return m.document.documentElement.clientHeight}}if(ss.isValue(window.self.pageXOffset)){d.$7=function(m){return m.pageXOffset}}else{d.$7=function(m){return m.document.documentElement.scrollLeft}}if(ss.isValue(window.self.pageYOffset)){d.$8=function(m){return m.pageYOffset}}else{d.$8=function(m){return m.document.documentElement.scrollTop}}if('screenLeft'in window){d.$9=function(m){return m.screenLeft}}else{d.$9=function(m){return m.screenX}}if('screenTop'in window){d.$a=function(m){return m.screenTop}}else{d.$a=function(m){return m.screenY}}{var e='requestAnimationFrame';var f='cancelAnimationFrame';var g=['ms','moz','webkit','o'];var h=null;var i=null;if(e in window){h=e}if(f in window){i=f}for(var j=0;j<g.length&&(ss.isNullOrUndefined(h)||ss.isNullOrUndefined(i));++j){var k=g[j];var l=k+'RequestAnimationFrame';if(ss.isNullOrUndefined(h)&&l in window){h=l}if(ss.isNullOrUndefined(i)){l=k+'CancelAnimationFrame';if(l in window){i=l}l=k+'CancelRequestAnimationFrame';if(l in window){i=l}}}if(ss.isValue(h)){d.$c=function(m){return window[h](m)}}else{d.$0()}if(ss.isValue(i)){d.$b=function(m){window[i](m)}}else{d.$b=function(m){window.clearTimeout(m)}}}})()})();var tab=global.tab;
/*! API */
(function(){'dont use strict';var a={};global.tab=global.tab||{};global.tableauSoftware=global.tableauSoftware||{};ss.initAssembly(a,'Tableau.JavaScript.Vql.Api');var b=function(){this.$9=0;this.$8={};this.$5={};this.$7={};this.$6={};if(J.hasWindowAddEventListener()){window.addEventListener('message',ss.mkdel(this,this.$0),false)}else if(J.hasDocumentAttachEvent()){var e=ss.mkdel(this,this.$0);document.attachEvent('onmessage',e);window.attachEvent('onmessage',e)}else{window.onmessage=ss.mkdel(this,this.$0)}this.$9=0};b.__typeName='tab.$0';var c=function(){this.$2=null;this.$1$1=null;this.$1$2=null};c.__typeName='tab.$1';var d=function(e,cd){this.$2=null;bl.call(this,e,null);this.$2=cd};d.__typeName='tab.$10';var f=function(e,cd){this.$2=null;bl.call(this,e,null);this.$2=cd};f.__typeName='tab.$2';var g=function(e,cd,ce,cf){this.$3=null;this.$4=null;bl.call(this,e,cd);this.$3=ce;this.$4=cf};g.__typeName='tab.$3';var h=function(){};h.__typeName='tab.$4';var i=function(){};i.__typeName='tab.$5';i.$0=function(e){var cd;if(e instanceof tableauSoftware.Promise){cd=e}else{if(ss.isValue(e)&&typeof(e['valueOf'])==='function'){e=e['valueOf']()}if(i.$1(e)){var ce=new y;e.then(ss.mkdel(ce,ce.resolve),ss.mkdel(ce,ce.reject));cd=ce.get_promise()}else{cd=i.$4(e)}}return cd};i.$2=function(e){return i.$0(e).then(function(cd){return i.$3(cd)},null)};i.$4=function(cd){var ce=new B(function(cf,cg){try{return i.$0((ss.isValue(cf)?cf(cd):cd))}catch(ch){var e=ss.Exception.wrap(ch);return i.$3(e)}});return ce};i.$3=function(cd){var ce=new B(function(cf,cg){try{return(ss.isValue(cg)?i.$0(cg(cd)):i.$3(cd))}catch(ch){var e=ss.Exception.wrap(ch);return i.$3(e)}});return ce};i.$1=function(e){return ss.isValue(e)&&typeof(e['then'])==='function'};var j=function(e){this.$4=null;this.$5=new tab._Collection;this.$6=0;if(z.isArray(e)){var cd=e;for(var ce=0;ce<cd.length;ce++){var cf=cd[ce];if(!ss.isValue(cf.fieldName)){throw I.createInvalidParameter('pair.fieldName')}if(!ss.isValue(cf.value)){throw I.createInvalidParameter('pair.value')}var cg=new bP(cf.fieldName,cf.value);this.$5._add(cg.fieldName,cg)}}else{this.$6=e}};j.__typeName='tab.$6';j.$0=function(e){var cd=new tab._Collection;if(ss.isNullOrUndefined(e)||J.isNullOrEmpty(e.marks)){return cd}for(var ce=0;ce<e.marks.length;ce++){var cf=e.marks[ce];var cg=cf.tupleId;var ch=new bO(cg);cd._add(cg.toString(),ch);for(var ci=0;ci<cf.pairs.length;ci++){var cj=cf.pairs[ci];var ck=J.convertRawValue(cj.value,cj.valueDataType);var cl=new bP(cj.fieldName,ck);cl.formattedValue=cj.formattedValue;if(!ch.$0.$2()._has(cl.fieldName)){ch.$0.$0(cl)}}}return cd};var k=function(e){this.$i=null;this.$h=null;this.$c=null;this.$d=null;this.$b=null;this.$a=null;this.$g=null;this.$f=null;this.$j=null;this.$e=null;this.$h=e.name;this.$c=J.getDataValue(e.currentValue);this.$d=R.convertParameterDataType(e.dataType);this.$b=R.convertParameterAllowableValuesType(e.allowableValuesType);if(ss.isValue(e.allowableValues)&&this.$b==='list'){this.$a=[];for(var cd=0;cd<e.allowableValues.length;cd++){var ce=e.allowableValues[cd];this.$a.push(J.getDataValue(ce))}}if(this.$b==='range'){this.$g=J.getDataValue(e.minValue);this.$f=J.getDataValue(e.maxValue);this.$j=e.stepSize;if((this.$d==='date'||this.$d==='datetime')&&ss.isValue(this.$j)&&ss.isValue(e.dateStepPeriod)){this.$e=R.convertPeriodType(e.dateStepPeriod)}}};k.__typeName='tab.$7';var l=function(){};l.__typeName='tab.$8';l.$2=function(e){return function(cd,ce){if(ss.isValue(cd)){var cf=cd.toString().toUpperCase();var cg=ss.Enum.getValues(e);for(var ch=0;ch<cg.length;ch++){var ci=cg[ch];var cj=ci.toUpperCase();if(ss.referenceEquals(cf,cj)){ce.$=ci;return true}}}ce.$=ss.getDefaultValue(e);return false}};l.$1=function(e){return function(cd,ce){var cf={};if(!l.$2(e).call(null,cd,cf)){throw I.createInvalidParameter(ce)}return cf.$}};l.$0=function(e){return function(cd){var ce={};var cf=l.$2(e).call(null,cd,ce);return cf}};var m=function(e,cd){bl.call(this,e,cd)};m.__typeName='tab.$9';var n=function(){};n.__typeName='tab._ApiBootstrap';n.initialize=function(){p.registerCrossDomainMessageRouter(function(){return new b})};global.tab._ApiBootstrap=n;var o=function(e,cd,ce,cf){this.$2=null;this.$1=null;this.$0=null;this.$3=null;this.$2=e;this.$0=cd;this.$1=ce;this.$3=cf};o.__typeName='tab._ApiCommand';o.generateNextCommandId=function(){var e='cmd'+o.$0;o.$0++;return e};o.parse=function(e){var cd;var ce=e.indexOf(String.fromCharCode(44));if(ce<0){cd=e;return new o(cd,null,null,null)}cd=e.substr(0,ce);var cf;var cg=e.substr(ce+1);ce=cg.indexOf(String.fromCharCode(44));if(ce<0){cf=cg;return new o(cd,cf,null,null)}cf=cg.substr(0,ce);var ch;var ci=cg.substr(ce+1);ce=ci.indexOf(String.fromCharCode(44));if(ce<0){ch=ci;return new o(cd,cf,ch,null)}ch=ci.substr(0,ce);var cj=ci.substr(ce+1);return new o(cd,cf,ch,cj)};global.tab._ApiCommand=o;var p=function(){};p.__typeName='tab._ApiObjectRegistry';p.registerCrossDomainMessageRouter=function(e){return p.$3(bp).call(null,e)};p.getCrossDomainMessageRouter=function(){return p.$2(bp).call(null)};p.disposeCrossDomainMessageRouter=function(){p.$0(bp).call(null)};p.$3=function(e){return function(cd){if(ss.isNullOrUndefined(p.$4)){p.$4={}}var ce=ss.getTypeFullName(e);var cf=p.$4[ce];p.$4[ce]=cd;return cf}};p.$1=function(e){return function(){if(ss.isNullOrUndefined(p.$4)){throw I.createInternalError('No types registered')}var cd=ss.getTypeFullName(e);var ce=p.$4[cd];if(ss.isNullOrUndefined(ce)){throw I.createInternalError("No creation function has been registered for interface type '"+cd+"'.")}var cf=ce();return cf}};p.$2=function(e){return function(){if(ss.isNullOrUndefined(p.$5)){p.$5={}}var cd=ss.getTypeFullName(e);var ce=p.$5[cd];if(ss.isNullOrUndefined(ce)){ce=p.$1(e).call(null);p.$5[cd]=ce}return ce}};p.$0=function(e){return function(){if(ss.isNullOrUndefined(p.$5)){return null}var cd=ss.getTypeFullName(e);var ce=p.$5[cd];delete p.$5[cd];return ce}};global.tab._ApiObjectRegistry=p;var q=function(e,cd,ce){this.$1=null;this.$2=null;this.$0=null;this.$1=e;this.$2=cd;this.$0=ce};q.__typeName='tab._ApiServerNotification';q.deserialize=function(e){var cd=JSON.parse(e);var ce=cd['api.workbookName'];var cf=cd['api.worksheetName'];var cg=cd['api.commandData'];return new q(ce,cf,cg)};global.tab._ApiServerNotification=q;var r=function(e){this.$1=null;this.$0=null;var cd=JSON.parse(e);this.$1=cd['api.commandResult'];this.$0=cd['api.commandData']};r.__typeName='tab._ApiServerResultParser';global.tab._ApiServerResultParser=r;var s=function(){this.$4=[];this.$3={}};s.__typeName='tab._CollectionImpl';global.tab._CollectionImpl=s;var t=function(e,cd,ce,cf){this.$1=null;this.$0=null;this.$3=false;this.$2=0;A.verifyString(e,'Column Field Name');this.$1=e;this.$0=cd;this.$3=ss.coalesce(ce,false);this.$2=cf};t.__typeName='tab._ColumnImpl';global.tab._ColumnImpl=t;var u=function(e,cd,ce){this.$c=null;this.$j=null;this.$l=null;this.$g=null;this.$h=null;this.$i=null;this.$k=null;this.$e=false;this.$d=false;this.$f=false;this.$l=e;this.$h=cd;this.$g=ce;this.$e=false;this.$d=false;this.$f=false};u.__typeName='tab._CustomViewImpl';u._getAsync=function(e){var cd=new tab._Deferred;cd.resolve(e.get__customViewImpl().$5());return cd.get_promise()};u._createNew=function(e,cd,ce,cf){var cg=new u(e,ce.name,cd);cg.$e=ce.isPublic;cg.$k=ce.url;cg.$i=ce.owner.friendlyName;cg.$d=ss.isValue(cf)&&ss.unbox(cf)===ce.id;cg.$j=ce;return cg};u._saveNewAsync=function(e,cd,ce){var cf=new tab._Deferred;var cg={};cg['api.customViewName']=ce;var ch=u.$0('api.SaveNewCustomViewCommand',cf,function(ci){u._processCustomViewUpdate(e,cd,ci,true);var cj=null;if(ss.isValue(e.$p())){cj=e.$p().get_item(0)}cf.resolve(cj)});cd.sendCommand(Object).call(cd,cg,ch);return cf.get_promise()};u._showCustomViewAsync=function(e,cd,ce){var cf=new tab._Deferred;var cg={};if(ss.isValue(ce)){cg['api.customViewParam']=ce}var ch=u.$0('api.ShowCustomViewCommand',cf,function(ci){var cj=e.get_activeCustomView();cf.resolve(cj)});cd.sendCommand(Object).call(cd,cg,ch);return cf.get_promise()};u._makeCurrentCustomViewDefaultAsync=function(e,cd){var ce=new tab._Deferred;var cf={};var cg=u.$0('api.MakeCurrentCustomViewDefaultCommand',ce,function(ch){var ci=e.get_activeCustomView();ce.resolve(ci)});cd.sendCommand(Object).call(cd,cf,cg);return ce.get_promise()};u._getCustomViewsAsync=function(e,cd){var ce=new tab._Deferred;var cf=new(ss.makeGenericType(bg,[Object]))('api.FetchCustomViewsCommand',0,function(cg){u._processCustomViews(e,cd,cg);ce.resolve(e.$i()._toApiCollection())},function(cg,ch){ce.reject(I.create('serverError',ch))});cd.sendCommand(Object).call(cd,null,cf);return ce.get_promise()};u._processCustomViews=function(e,cd,ce){u._processCustomViewUpdate(e,cd,ce,false)};u._processCustomViewUpdate=function(e,cd,ce,cf){if(cf){e.$q(new tab._Collection)}e.$h(null);var cg=null;if(ss.isValue(ce.currentView)){cg=ce.currentView.name}var ch=ce.defaultCustomViewId;if(cf&&ss.isValue(ce.newView)){var ci=u._createNew(e,cd,ce.newView,ch);e.$p()._add(ci.$7(),ci.$5())}e.$o(e.$i());e.$j(new tab._Collection);if(ss.isValue(ce.customViews)){var cj=ce.customViews;if(cj.length>0){for(var ck=0;ck<cj.length;ck++){var cl=u._createNew(e,cd,cj[ck],ch);e.$i()._add(cl.$7(),cl.$5());if(e.$n()._has(cl.$7())){e.$n()._remove(cl.$7())}else if(cf){if(!e.$p()._has(cl.$7())){e.$p()._add(cl.$7(),cl.$5())}}if(ss.isValue(cg)&&ss.referenceEquals(cl.$7(),cg)){e.$h(cl.$5())}}}}};u.$0=function(e,cd,ce){var cf=function(cg,ch){cd.reject(I.create('serverError',ch))};return new(ss.makeGenericType(bg,[Object]))(e,0,ce,cf)};var v=function(e,cd,ce){this.$d=null;this.$f=new tab._Collection;this.$e=new tab._Collection;D.call(this,e,cd,ce)};v.__typeName='tab._DashboardImpl';global.tab._DashboardImpl=v;var w=function(e,cd){this.$3=null;this.$1=new tab._Collection;this.$2=false;this.$0=null;A.verifyString(e,'name');this.$3=e;this.$2=cd};w.__typeName='tab._DataSourceImpl';w.processDataSource=function(e){var cd=new w(e.name,e.isPrimary);var ce=ss.coalesce(e.fields,[]);for(var cf=0;cf<ce.length;cf++){var cg=ce[cf];var ch=R.convertFieldRole(cg.role);var ci=R.convertFieldAggregation(cg.aggregation);var cj=new bL(cd.get_dataSource(),cg.name,ch,ci);cd.addField(cj)}return cd};w.processDataSourcesForWorksheet=function(e){var cd=new tab._Collection;var ce=null;for(var cf=0;cf<e.dataSources.length;cf++){var cg=e.dataSources[cf];var ch=w.processDataSource(cg);if(cg.isPrimary){ce=ch}else{cd._add(cg.name,ch.get_dataSource())}}if(ss.isValue(ce)){cd._addToFirst(ce.get_name(),ce.get_dataSource())}return cd};global.tab._DataSourceImpl=w;var x=function(e,cd,ce,cf){this.$2=null;this.$3=null;this.$4=0;this.$0=null;this.$1=false;this.$3=e;this.$4=ce;this.$0=cf;this.$1=cd;this.$2=(cd?'Summary Data Table':'Underlying Data Table')};x.__typeName='tab._DataTableImpl';x.processGetDataPresModel=function(e){var cd=x.$1(e.dataTable);var ce=x.$0(e.headers);var cf=new x(cd,e.isSummary,cd.length,ce);return new bK(cf)};x.$1=function(e){var cd=[];for(var ce=0;ce<e.length;ce++){var cf=e[ce];var cg=[];for(var ch=0;ch<cf.length;ch++){var ci=cf[ch];cg.push(J.getDataValue(ci))}cd.push(cg)}return cd};x.$0=function(e){var cd=[];for(var ce=0;ce<e.length;ce++){var cf=e[ce];var cg=new t(cf.fieldName,R.convertDataType(cf.dataType),cf.isReferenced,cf.index);cd.push(new bF(cg))}return cd};global.tab._DataTableImpl=x;var y=function(){this.$3=null;this.$5=null;this.$2=[];this.$4=null;this.$3=new B(ss.mkdel(this,this.then));this.$5=ss.mkdel(this,this.$0);this.$4=ss.mkdel(this,this.$1)};y.__typeName='tab._DeferredImpl';global.tab._DeferredImpl=y;var z=function(){};z.__typeName='tab._jQueryShim';z.isFunction=function(e){return z.type(e)==='function'};z.isArray=function(e){if(ss.isValue(Array['isArray'])){return Array['isArray'](e)}return z.type(e)==='array'};z.type=function(e){return(ss.isNullOrUndefined(e)?String(e):(z.$8[z.$d.call(e)]||'object'))};z.trim=function(e){if(ss.isValue(z.$e)){return(ss.isNullOrUndefined(e)?'':z.$e.call(e))}return(ss.isNullOrUndefined(e)?'':e.toString().replace(z.$f,'').replace(z.$g,''))};z.parseJSON=function(e){if(typeof(e)!=='string'||ss.isNullOrUndefined(e)){return null}e=z.trim(e);if(ss.isValue(JSON)&&ss.isValue(JSON['parse'])){return JSON.parse(e)}if(z.$a.test(e.replace(z.$b,'@').replace(z.$c,']').replace(z.$9,''))){return(new Function('return '+e))()}throw new ss.Exception('Invalid JSON: '+e)};global.tab._jQueryShim=z;var A=function(){};A.__typeName='tab._Param';A.verifyString=function(e,cd){if(ss.isNullOrUndefined(e)||e.length===0){throw I.createInternalStringArgumentException(cd)}};A.verifyValue=function(e,cd){if(ss.isNullOrUndefined(e)){throw I.createInternalNullArgumentException(cd)}};global.tab._Param=A;var B=function(e){this.then=null;this.then=e};B.__typeName='tab._PromiseImpl';global.tab._PromiseImpl=B;var C=function(e,cd,ce,cf){this.left=0;this.top=0;this.width=0;this.height=0;this.left=e;this.top=cd;this.width=ce;this.height=cf};C.__typeName='tab._Rect';global.tab._Rect=C;var D=function(e,cd,ce){this.$5=null;this.$1=0;this.$2=false;this.$3=false;this.$7=null;this.$8=null;this.$9=null;this.$a=null;this.$4=null;this.$6=null;this.$b=0;A.verifyValue(e,'sheetInfoImpl');A.verifyValue(cd,'workbookImpl');A.verifyValue(ce,'messagingOptions');this.$5=e.name;this.$1=e.index;this.$2=e.isActive;this.$3=e.isHidden;this.$7=e.sheetType;this.$8=e.size;this.$9=e.url;this.$a=cd;this.$4=ce;this.$b=e.zoneId};D.__typeName='tab._SheetImpl';D.$0=function(e){if(ss.isValue(e)){return J.toInt(e)}return e};D.$1=function(e){var cd=l.$1(bc).call(null,e.behavior,'size.behavior');var ce=e.minSize;if(ss.isValue(ce)){ce=bv.$ctor(D.$0(e.minSize.width),D.$0(e.minSize.height))}var cf=e.maxSize;if(ss.isValue(cf)){cf=bv.$ctor(D.$0(e.maxSize.width),D.$0(e.maxSize.height))}return bt.$ctor(cd,ce,cf)};global.tab._SheetImpl=D;var E=function(){};E.__typeName='tab._SheetInfoImpl';E.$ctor=function(e,cd,ce,cf,cg,ch,ci,cj,ck){var cl=new Object;cl.name=null;cl.index=0;cl.workbook=null;cl.url=null;cl.isHidden=false;cl.sheetType=null;cl.zoneId=0;cl.size=null;cl.isActive=false;cl.name=e;cl.sheetType=cd;cl.index=ce;cl.size=cf;cl.workbook=cg;cl.url=ch;cl.isActive=ci;cl.isHidden=cj;cl.zoneId=ck;return cl};global.tab._SheetInfoImpl=E;var F=function(e,cd,ce,cf,cg){this.$g=null;this.$h=null;this.$i=null;this.$j=null;this.$2$1=null;D.call(this,e,cd,ce);A.verifyValue(cf,'storyPm');A.verifyValue(cg,'findSheetFunc');this.$h=cg;this.update(cf)};F.__typeName='tab._StoryImpl';global.tab._StoryImpl=F;var G=function(e,cd){this.$1=null;this.$3=0;this.$4=false;this.$5=false;this.$2=null;this.$6=null;this.$7=null;this.$8=0;this.$4=e.isActive;this.$5=e.isUpdated;this.$1=e.caption;this.$3=e.index;this.$6=e.parentStoryImpl;this.$8=e.storyPointId;this.$2=cd;if(ss.isValue(cd)){this.$2.set_parentStoryPointImpl(this);if(cd.get_sheetType()==='dashboard'){var ce=this.$2;for(var cf=0;cf<ce.get_worksheets().get__length();cf++){var cg=ce.get_worksheets().get_item(cf);cg._impl.set_parentStoryPointImpl(this)}}}};G.__typeName='tab._StoryPointImpl';G.createContainedSheet=function(e,cd,ce,cf){var cg=R.convertSheetType(e.sheetType);var ch=-1;var ci=bu.createAutomatic();var cj=false;var ck=cf(e.name);var cl=ss.isNullOrUndefined(ck);var cm=(cl?'':ck.getUrl());var cn=E.$ctor(e.name,cg,ch,ci,cd.get_workbook(),cm,cj,cl,e.zoneId);if(e.sheetType==='worksheet'){var co=null;var cp=new N(cn,cd,ce,co);return cp}else if(e.sheetType==='dashboard'){var cq=new v(cn,cd,ce);var cr=M.$0(e.dashboardZones);cq.$c(cr,cf);return cq}else if(e.sheetType==='story'){throw I.createInternalError('Cannot have a story embedded within another story.')}else{throw I.createInternalError("Unknown sheet type '"+e.sheetType+"'")}};global.tab._StoryPointImpl=G;var H=function(){};H.__typeName='tab._StoryPointInfoImpl';H.$ctor=function(e,cd,ce,cf,cg,ch){var ci=new Object;ci.storyPointId=0;ci.parentStoryImpl=null;ci.caption=null;ci.index=0;ci.isActive=false;ci.isUpdated=false;ci.caption=e;ci.index=cd;ci.storyPointId=ce;ci.isActive=cf;ci.isUpdated=cg;ci.parentStoryImpl=ch;return ci};global.tab._StoryPointInfoImpl=H;var I=function(){};I.__typeName='tab._TableauException';I.create=function(e,cd){var ce=new ss.Exception(cd);ce['tableauSoftwareErrorCode']=e;return ce};I.createInternalError=function(e){if(ss.isValue(e)){return I.create('internalError','Internal error. Please contact Tableau support with the following information: '+e)}else{return I.create('internalError','Internal error. Please contact Tableau support')}};I.createInternalNullArgumentException=function(e){return I.createInternalError("Null/undefined argument '"+e+"'.")};I.createInternalStringArgumentException=function(e){return I.createInternalError("Invalid string argument '"+e+"'.")};I.createServerError=function(e){return I.create('serverError',e)};I.createNotActiveSheet=function(){return I.create('notActiveSheet','Operation not allowed on non-active sheet')};I.createInvalidCustomViewName=function(e){return I.create('invalidCustomViewName','Invalid custom view name: '+e)};I.createInvalidParameter=function(e){return I.create('invalidParameter','Invalid parameter: '+e)};I.createInvalidFilterFieldNameOrValue=function(e){return I.create('invalidFilterFieldNameOrValue','Invalid filter field name or value: '+e)};I.createInvalidDateParameter=function(e){return I.create('invalidDateParameter','Invalid date parameter: '+e)};I.createNullOrEmptyParameter=function(e){return I.create('nullOrEmptyParameter','Parameter cannot be null or empty: '+e)};I.createMissingMaxSize=function(){return I.create('missingMaxSize','Missing maxSize for SheetSizeBehavior.ATMOST')};I.createMissingMinSize=function(){return I.create('missingMinSize','Missing minSize for SheetSizeBehavior.ATLEAST')};I.createMissingMinMaxSize=function(){return I.create('missingMinMaxSize','Missing minSize or maxSize for SheetSizeBehavior.RANGE')};I.createInvalidRangeSize=function(){return I.create('invalidSize','Missing minSize or maxSize for SheetSizeBehavior.RANGE')};I.createInvalidSizeValue=function(){return I.create('invalidSize','Size value cannot be less than zero')};I.createInvalidSheetSizeParam=function(){return I.create('invalidSize','Invalid sheet size parameter')};I.createSizeConflictForExactly=function(){return I.create('invalidSize','Conflicting size values for SheetSizeBehavior.EXACTLY')};I.createInvalidSizeBehaviorOnWorksheet=function(){return I.create('invalidSizeBehaviorOnWorksheet','Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets')};I.createNoUrlForHiddenWorksheet=function(){return I.create('noUrlForHiddenWorksheet','Hidden worksheets do not have a URL.')};I.$0=function(e){return I.create('invalidAggregationFieldName',"Invalid aggregation type for field '"+e+"'")};I.createIndexOutOfRange=function(e){return I.create('indexOutOfRange',"Index '"+e+"' is out of range.")};I.createUnsupportedEventName=function(e){return I.create('unsupportedEventName',"Unsupported event '"+e+"'.")};I.createBrowserNotCapable=function(){return I.create('browserNotCapable','This browser is incapable of supporting the Tableau JavaScript API.')};global.tab._TableauException=I;var J=function(){};J.__typeName='tab._Utility';J.isNullOrEmpty=function(e){return ss.isNullOrUndefined(e)||(e['length']||0)<=0};J.isString=function(e){return typeof(e)==='string'};J.isNumber=function(e){return typeof(e)==='number'};J.isDate=function(e){if(typeof(e)==='object'&&ss.isInstanceOfType(e,ss.JsDate)){return true}else if(Object.prototype.toString.call(e)!=='[object Date]'){return false}return!isNaN(e.getTime())};J.isDateValid=function(e){return!isNaN(e.getTime())};J.indexOf=function(e,cd,ce){if(ss.isValue(Array.prototype['indexOf'])){return e['indexOf'](cd,ce)}ce=ce||0;var cf=e.length;if(cf>0){for(var cg=ce;cg<cf;cg++){if(ss.referenceEquals(e[cg],cd)){return cg}}}return-1};J.contains=function(e,cd,ce){var cf=J.indexOf(e,cd,ce);return cf>=0};J.getTopmostWindow=function(){var e=window.self;while(ss.isValue(e.parent)&&!ss.referenceEquals(e.parent,e)){e=e.parent}return e};J.toInt=function(e){if(J.isNumber(e)){return ss.Int32.trunc(e)}var cd=parseInt(e.toString(),10);if(isNaN(cd)){return 0}return cd};J.hasClass=function(e,cd){var ce=new RegExp('[\\n\\t\\r]','g');return ss.isValue(e)&&(' '+e.className+' ').replace(ce,' ').indexOf(' '+cd+' ')>-1};J.findParentWithClassName=function(e,cd,ce){var cf=(ss.isValue(e)?e.parentNode:null);ce=ce||document.body;while(ss.isValue(cf)){if(J.hasClass(cf,cd)){return cf}if(ss.referenceEquals(cf,ce)){cf=null}else{cf=cf.parentNode}}return cf};J.hasJsonParse=function(){return ss.isValue(JSON)&&ss.isValue(JSON.parse)};J.hasWindowPostMessage=function(){return ss.isValue(window.postMessage)};J.isPostMessageSynchronous=function(){if(J.isIE()){var e=new RegExp('(msie) ([\\w.]+)');var cd=e.exec(window.navigator.userAgent.toLowerCase());var ce=cd[2]||'0';var cf=parseInt(ce,10);return cf<=8}return false};J.hasDocumentAttachEvent=function(){return ss.isValue(document.attachEvent)};J.hasWindowAddEventListener=function(){return ss.isValue(window.addEventListener)};J.isElementOfTag=function(e,cd){return ss.isValue(e)&&e.nodeType===1&&ss.referenceEquals(e.tagName.toLowerCase(),cd.toLowerCase())};J.elementToString=function(e){var cd=new ss.StringBuilder;cd.append(e.tagName.toLowerCase());if(!J.isNullOrEmpty(e.id)){cd.append('#').append(e.id)}if(!J.isNullOrEmpty(e.className)){var ce=e.className.split(' ');cd.append('.').append(ce.join('.'))}return cd.toString()};J.tableauGCS=function(e){if(typeof(window['getComputedStyle'])==='function'){return window.getComputedStyle(e)}else{return e['currentStyle']}};J.isIE=function(){return window.navigator.userAgent.indexOf('MSIE')>-1&&ss.isNullOrUndefined(window.opera)};J.isSafari=function(){var e=window.navigator.userAgent;var cd=e.indexOf('Chrome')>=0;return e.indexOf('Safari')>=0&&!cd};J.mobileDetect=function(){var e=window.navigator.userAgent;if(e.indexOf('iPad')!==-1){return true}if(e.indexOf('Android')!==-1){return true}if(e.indexOf('AppleWebKit')!==-1&&e.indexOf('Mobile')!==-1){return true}return false};J.visibleContentRectInDocumentCoordinates=function(e){var cd=J.contentRectInDocumentCoordinates(e);for(var ce=e.parentElement;ss.isValue(ce)&&ss.isValue(ce.parentElement);ce=ce.parentElement){var cf=J.$0(ce).overflow;if(cf==='auto'||cf==='scroll'||cf==='hidden'){cd=cd.intersect(J.contentRectInDocumentCoordinates(ce))}}var cg=J.contentRectInDocumentCoordinates(document.documentElement);var ch=new tab.WindowHelper(window.self);cg.left+=ch.get_pageXOffset();cg.top+=ch.get_pageYOffset();return cd.intersect(cg)};J.contentRectInDocumentCoordinates=function(e){var cd=J.getBoundingClientRect(e);var ce=J.$0(e);var cf=J.toInt(ce.paddingLeft);var cg=J.toInt(ce.paddingTop);var ch=J.toInt(ce.borderLeftWidth);var ci=J.toInt(ce.borderTopWidth);var cj=J.computeContentSize(e);var ck=new tab.WindowHelper(window.self);var cl=cd.left+cf+ch+ck.get_pageXOffset();var cm=cd.top+cg+ci+ck.get_pageYOffset();return new C(cl,cm,cj.width,cj.height)};J.getBoundingClientRect=function(e){var cd=e.getBoundingClientRect();var ce=ss.Int32.trunc(cd.top);var cf=ss.Int32.trunc(cd.left);var cg=ss.Int32.trunc(cd.right);var ch=ss.Int32.trunc(cd.bottom);return new C(cf,ce,cg-cf,ch-ce)};J.convertRawValue=function(e,cd){if(ss.isNullOrUndefined(e)){return null}switch(cd){case'bool':{return e}case'date':case'number':{if(ss.isNullOrUndefined(e)){return Number.NaN}return e}default:case'string':{return e}}};J.getDataValue=function(e){if(ss.isNullOrUndefined(e)){return bk.$ctor(null,null,null)}return bk.$ctor(J.convertRawValue(e.value,e.type),e.formattedValue,e.aliasedValue)};J.serializeDateForServer=function(e){var cd='';if(ss.isValue(e)&&J.isDate(e)){var ce=e.getUTCFullYear();var cf=e.getUTCMonth()+1;var cg=e.getUTCDate();var ch=e.getUTCHours();var ci=e.getUTCMinutes();var cj=e.getUTCSeconds();cd=ce+'-'+cf+'-'+cg+' '+ch+':'+ci+':'+cj}return cd};J.computeContentSize=function(e){var cd=J.$0(e);var ce=parseFloat(cd.paddingLeft);var cf=parseFloat(cd.paddingTop);var cg=parseFloat(cd.paddingRight);var ch=parseFloat(cd.paddingBottom);var ci=e.clientWidth-Math.round(ce+cg);var cj=e.clientHeight-Math.round(cf+ch);return bv.$ctor(ci,cj)};J.$0=function(e){if(typeof(window['getComputedStyle'])==='function'){if(ss.isValue(e.ownerDocument.defaultView.opener)){return e.ownerDocument.defaultView.getComputedStyle(e)}return window.getComputedStyle(e)}else if(ss.isValue(e['currentStyle'])){return e['currentStyle']}return e.style};global.tab._Utility=J;var K=function(){};K.__typeName='tab._VizManagerImpl';K.$4=function(){return K.$5.concat()};K.$0=function(e){K.$3(e);K.$5.push(e)};K.$2=function(e){for(var cd=0,ce=K.$5.length;cd<ce;cd++){if(ss.referenceEquals(K.$5[cd],e)){K.$5.splice(cd,1);break}}};K.$1=function(){for(var e=0,cd=K.$5.length;e<cd;e++){K.$5[e]._impl.$K()}};K.$3=function(e){var cd=e.getParentElement();for(var ce=0,cf=K.$5.length;ce<cf;ce++){if(ss.referenceEquals(K.$5[ce].getParentElement(),cd)){var cg="Another viz is already present in element '"+J.elementToString(cd)+"'.";throw I.create('vizAlreadyInManager',cg)}}};var L=function(e,cd,ce){this.name='';this.host_url=null;this.tabs=false;this.toolbar=false;this.toolBarPosition=null;this.device=null;this.handlerId=null;this.width=null;this.height=null;this.parentElement=null;this.userSuppliedParameters=null;this.staticImageUrl=null;this.fixedSize=false;this.displayStaticImage=false;this.$2=null;this.$1=null;if(ss.isNullOrUndefined(e)||ss.isNullOrUndefined(cd)){throw I.create('noUrlOrParentElementNotFound','URL is empty or Parent element not found')}if(ss.isNullOrUndefined(ce)){ce=new Object;ce.hideTabs=false;ce.hideToolbar=false;ce.onFirstInteractive=null}if(ss.isValue(ce.height)||ss.isValue(ce.width)){this.fixedSize=true;if(J.isNumber(ce.height)){ce.height=ce.height.toString()+'px'}if(J.isNumber(ce.width)){ce.width=ce.width.toString()+'px'}this.height=(ss.isValue(ce.height)?ce.height.toString():null);this.width=(ss.isValue(ce.width)?ce.width.toString():null)}else{this.fixedSize=false}this.displayStaticImage=ce.displayStaticImage||false;this.staticImageUrl=ce.staticImageUrl||'';this.tabs=!(ce.hideTabs||false);this.toolbar=!(ce.hideToolbar||false);this.device=ce.device;this.parentElement=e;this.$1=ce;this.toolBarPosition=ce.toolbarPosition;var cf=cd.split('?');this.$2=cf[0];if(cf.length===2){this.userSuppliedParameters=cf[1]}else{this.userSuppliedParameters=''}var cg=(new RegExp('.*?[^/:]/','')).exec(this.$2);if(ss.isNullOrUndefined(cg)||cg[0].toLowerCase().indexOf('http://')===-1&&cg[0].toLowerCase().indexOf('https://')===-1){throw I.create('invalidUrl','Invalid url')}this.host_url=cg[0].toLowerCase();this.name=this.$2.replace(cg[0],'');this.name=this.name.replace('views/','')};L.__typeName='tab._VizParameters';global.tab._VizParameters=L;var M=function(e,cd,ce){this.$E=null;this.$D=null;this.$y=null;this.$s=null;this.$r=null;this.$A=new tab._Collection;this.$v=false;this.$x=null;this.$t=null;this.$u=new tab._Collection;this.$C=new tab._Collection;this.$B=new tab._Collection;this.$z=null;this.$w=null;this.$D=e;this.$x=cd;this.$5(ce)};M.__typeName='tab._WorkbookImpl';M.$0=function(e){e=ss.coalesce(e,[]);var cd=[];for(var ce=0;ce<e.length;ce++){var cf=e[ce];var cg=R.convertDashboardObjectType(cf.zoneType);var ch=bv.$ctor(cf.width,cf.height);var ci=bs.$ctor(cf.x,cf.y);var cj=cf.name;var ck={name:cj,objectType:cg,position:ci,size:ch,zoneId:cf.zoneId};cd.push(ck)}return cd};M.$2=function(e){if(ss.isNullOrUndefined(e)){return null}if(J.isString(e)){return e}var cd=ss.safeCast(e,bT);if(ss.isValue(cd)){return cd.getName()}var ce=ss.safeCast(e,bU);if(ss.isValue(ce)){return ce.getName()}return null};M.$1=function(e){if(ss.isNullOrUndefined(e)){return bu.createAutomatic()}return bu.fromSizeConstraints(e.sizeConstraints)};M.$4=function(e){var cd=new tab._Collection;for(var ce=0;ce<e.parameters.length;ce++){var cf=e.parameters[ce];var cg=new k(cf);cd._add(cg.$7(),cg.$8())}return cd};M.$3=function(e,cd){for(var ce=0;ce<cd.parameters.length;ce++){var cf=cd.parameters[ce];if(ss.referenceEquals(cf.name,e)){return new k(cf)}}return null};global.tab._WorkbookImpl=M;var N=function(e,cd,ce,cf){this.$G=null;this.$E=null;this.$D=new tab._Collection;this.$F=new tab._Collection;D.call(this,e,cd,ce);this.$E=cf};N.__typeName='tab._WorksheetImpl';N.$2=function(e){var cd=e;if(ss.isValue(cd)&&ss.isValue(cd.errorCode)){var ce=(ss.isValue(cd.additionalInformation)?cd.additionalInformation.toString():'');switch(cd.errorCode){case'invalidFilterFieldName':{return I.create('invalidFilterFieldName',ce)}case'invalidFilterFieldValue':{return I.create('invalidFilterFieldValue',ce)}case'invalidAggregationFieldName':{return I.$0(ce)}default:{return I.createServerError(ce)}}}return null};N.$3=function(e){if(ss.isNullOrUndefined(e)){throw I.createNullOrEmptyParameter('filterOptions')}if(ss.isNullOrUndefined(e.min)&&ss.isNullOrUndefined(e.max)){throw I.create('invalidParameter','At least one of filterOptions.min or filterOptions.max must be specified.')}var cd=new Object;if(ss.isValue(e.min)){cd.min=e.min}if(ss.isValue(e.max)){cd.max=e.max}if(ss.isValue(e.nullOption)){cd.nullOption=l.$1(X).call(null,e.nullOption,'filterOptions.nullOption')}return cd};N.$4=function(e){if(ss.isNullOrUndefined(e)){throw I.createNullOrEmptyParameter('filterOptions')}var cd=new Object;cd.rangeType=l.$1(P).call(null,e.rangeType,'filterOptions.rangeType');cd.periodType=l.$1(ba).call(null,e.periodType,'filterOptions.periodType');if(cd.rangeType==='lastn'||cd.rangeType==='nextn'){if(ss.isNullOrUndefined(e.rangeN)){throw I.create('missingRangeNForRelativeDateFilters','Missing rangeN field for a relative date filter of LASTN or NEXTN.')}cd.rangeN=J.toInt(e.rangeN)}if(ss.isValue(e.anchorDate)){if(!J.isDate(e.anchorDate)||!J.isDateValid(e.anchorDate)){throw I.createInvalidDateParameter('filterOptions.anchorDate')}cd.anchorDate=e.anchorDate}return cd};N.$0=function(e,cd,ce){return new(ss.makeGenericType(bg,[Object]))(e,1,function(cf){var cg=N.$2(cf);if(ss.isNullOrUndefined(cg)){ce.resolve(cd)}else{ce.reject(cg)}},function(cf,cg){if(cf){ce.reject(I.createInvalidFilterFieldNameOrValue(cd))}else{var ch=I.create('filterCannotBePerformed',cg);ce.reject(ch)}})};N.$1=function(e){var cd=e;if(ss.isValue(cd)&&ss.isValue(cd.errorCode)){var ce=(ss.isValue(cd.additionalInformation)?cd.additionalInformation.toString():'');switch(cd.errorCode){case'invalidSelectionFieldName':{return I.create('invalidSelectionFieldName',ce)}case'invalidSelectionValue':{return I.create('invalidSelectionValue',ce)}case'invalidSelectionDate':{return I.create('invalidSelectionDate',ce)}}}return null};global.tab._WorksheetImpl=N;var O=function(){};O.__typeName='tab.ApiDashboardObjectType';global.tab.ApiDashboardObjectType=O;var P=function(){};P.__typeName='tab.ApiDateRangeType';global.tab.ApiDateRangeType=P;var Q=function(){};Q.__typeName='tab.ApiDeviceType';global.tab.ApiDeviceType=Q;var R=function(){};R.__typeName='tab.ApiEnumConverter';R.convertDashboardObjectType=function(e){switch(e){case'blank':{return'blank'}case'image':{return'image'}case'legend':{return'legend'}case'pageFilter':{return'pageFilter'}case'parameterControl':{return'parameterControl'}case'quickFilter':{return'quickFilter'}case'text':{return'text'}case'title':{return'title'}case'webPage':{return'webPage'}case'worksheet':{return'worksheet'}default:{throw I.createInternalError('Unknown ApiCrossDomainDashboardObjectType: '+e)}}};R.convertDateRange=function(e){switch(e){case'curr':{return'curr'}case'last':{return'last'}case'lastn':{return'lastn'}case'next':{return'next'}case'nextn':{return'nextn'}case'todate':{return'todate'}default:{throw I.createInternalError('Unknown ApiCrossDomainDateRangeType: '+e)}}};R.convertFieldAggregation=function(e){switch(e){case'ATTR':{return'ATTR'}case'AVG':{return'AVG'}case'COUNT':{return'COUNT'}case'COUNTD':{return'COUNTD'}case'DAY':{return'DAY'}case'END':{return'END'}case'HOUR':{return'HOUR'}case'INOUT':{return'INOUT'}case'KURTOSIS':{return'KURTOSIS'}case'MAX':{return'MAX'}case'MDY':{return'MDY'}case'MEDIAN':{return'MEDIAN'}case'MIN':{return'MIN'}case'MINUTE':{return'MINUTE'}case'MONTH':{return'MONTH'}case'MONTHYEAR':{return'MONTHYEAR'}case'NONE':{return'NONE'}case'PERCENTILE':{return'PERCENTILE'}case'QUART1':{return'QUART1'}case'QUART3':{return'QUART3'}case'QTR':{return'QTR'}case'SECOND':{return'SECOND'}case'SKEWNESS':{return'SKEWNESS'}case'STDEV':{return'STDEV'}case'STDEVP':{return'STDEVP'}case'SUM':{return'SUM'}case'SUM_XSQR':{return'SUM_XSQR'}case'TRUNC_DAY':{return'TRUNC_DAY'}case'TRUNC_HOUR':{return'TRUNC_HOUR'}case'TRUNC_MINUTE':{return'TRUNC_MINUTE'}case'TRUNC_MONTH':{return'TRUNC_MONTH'}case'TRUNC_QTR':{return'TRUNC_QTR'}case'TRUNC_SECOND':{return'TRUNC_SECOND'}case'TRUNC_WEEK':{return'TRUNC_WEEK'}case'TRUNC_YEAR':{return'TRUNC_YEAR'}case'USER':{return'USER'}case'VAR':{return'VAR'}case'VARP':{return'VARP'}case'WEEK':{return'WEEK'}case'WEEKDAY':{return'WEEKDAY'}case'YEAR':{return'YEAR'}default:{throw I.createInternalError('Unknown ApiCrossDomainFieldAggregationType: '+e)}}};R.convertFieldRole=function(e){switch(e){case'dimension':{return'dimension'}case'measure':{return'measure'}case'unknown':{return'unknown'}default:{throw I.createInternalError('Unknown ApiCrossDomainFieldRoleType: '+e)}}};R.convertFilterType=function(e){switch(e){case'categorical':{return'categorical'}case'hierarchical':{return'hierarchical'}case'quantitative':{return'quantitative'}case'relativedate':{return'relativedate'}default:{throw I.createInternalError('Unknown ApiCrossDomainFilterType: '+e)}}};R.convertParameterAllowableValuesType=function(e){switch(e){case'all':{return'all'}case'list':{return'list'}case'range':{return'range'}default:{throw I.createInternalError('Unknown ApiCrossDomainParameterAllowableValuesType: '+e)}}};R.convertParameterDataType=function(e){switch(e){case'boolean':{return'boolean'}case'date':{return'date'}case'datetime':{return'datetime'}case'float':{return'float'}case'integer':{return'integer'}case'string':{return'string'}default:{throw I.createInternalError('Unknown ApiCrossDomainParameterDataType: '+e)}}};R.convertPeriodType=function(e){switch(e){case'year':{return'year'}case'quarter':{return'quarter'}case'month':{return'month'}case'week':{return'week'}case'day':{return'day'}case'hour':{return'hour'}case'minute':{return'minute'}case'second':{return'second'}default:{throw I.createInternalError('Unknown ApiCrossDomainPeriodType: '+e)}}};R.convertSheetType=function(e){switch(e){case'worksheet':{return'worksheet'}case'dashboard':{return'dashboard'}case'story':{return'story'}default:{throw I.createInternalError('Unknown ApiCrossDomainSheetType: '+e)}}};R.convertDataType=function(e){switch(e){case'boolean':{return'boolean'}case'date':{return'date'}case'datetime':{return'datetime'}case'float':{return'float'}case'integer':{return'integer'}case'string':{return'string'}default:{throw I.createInternalError('Unknown ApiCrossDomainParameterDataType: '+e)}}};global.tab.ApiEnumConverter=R;var S=function(){};S.__typeName='tab.ApiErrorCode';global.tab.ApiErrorCode=S;var T=function(){};T.__typeName='tab.ApiFieldAggregationType';global.tab.ApiFieldAggregationType=T;var U=function(){};U.__typeName='tab.ApiFieldRoleType';global.tab.ApiFieldRoleType=U;var V=function(){};V.__typeName='tab.ApiFilterType';global.tab.ApiFilterType=V;var W=function(){};W.__typeName='tab.ApiFilterUpdateType';global.tab.ApiFilterUpdateType=W;var X=function(){};X.__typeName='tab.ApiNullOption';global.tab.ApiNullOption=X;var Y=function(){};Y.__typeName='tab.ApiParameterAllowableValuesType';global.tab.ApiParameterAllowableValuesType=Y;var Z=function(){};Z.__typeName='tab.ApiParameterDataType';global.tab.ApiParameterDataType=Z;var ba=function(){};ba.__typeName='tab.ApiPeriodType';global.tab.ApiPeriodType=ba;var bb=function(){};bb.__typeName='tab.ApiSelectionUpdateType';global.tab.ApiSelectionUpdateType=bb;var bc=function(){};bc.__typeName='tab.ApiSheetSizeBehavior';global.tab.ApiSheetSizeBehavior=bc;var bd=function(){};bd.__typeName='tab.ApiSheetType';global.tab.ApiSheetType=bd;var be=function(){};be.__typeName='tab.ApiTableauEventName';global.tab.ApiTableauEventName=be;var bf=function(){};bf.__typeName='tab.ApiToolbarPosition';global.tab.ApiToolbarPosition=bf;var bg=function(e){var cd=function(ce,cf,cg,ch){this.$0=null;this.$3=0;this.$2=null;this.$1=null;this.$0=ce;this.$2=cg;this.$3=cf;this.$1=ch};ss.registerGenericClassInstance(cd,bg,[e],{get_commandName:function(){return this.$0},get_successCallback:function(){return this.$2},get_successCallbackTiming:function(){return this.$3},get_errorCallback:function(){return this.$1}},function(){return null},function(){return[]});return cd};bg.__typeName='tab.CommandReturnHandler$1';ss.initGenericClass(bg,a,1);global.tab.CommandReturnHandler$1=bg;var bh=function(e,cd){this.$1=null;this.$0=null;A.verifyValue(e,'router');A.verifyValue(cd,'handler');this.$1=e;this.$0=cd};bh.__typeName='tab.CrossDomainMessagingOptions';global.tab.CrossDomainMessagingOptions=bh;var bi=function(e,cd,ce){this.$2=null;by.call(this,e,cd);this.$2=new f(cd._impl.get__workbookImpl(),ce)};bi.__typeName='tab.CustomViewEvent';global.tab.CustomViewEvent=bi;var bj=function(){};bj.__typeName='tab.DataType';global.tab.DataType=bj;var bk=function(){};bk.__typeName='tab.DataValue';bk.$ctor=function(e,cd,ce){var cf=new Object;cf.value=null;cf.formattedValue=null;cf.value=e;if(J.isNullOrEmpty(ce)){cf.formattedValue=cd}else{cf.formattedValue=ce}return cf};global.tab.DataValue=bk;var bl=function(e,cd){this.$0=null;this.$1=null;this.$0=e;this.$1=cd};bl.__typeName='tab.EventContext';global.tab.EventContext=bl;var bm=function(e,cd,ce,cf,cg){this.$4=null;this.$3=null;bD.call(this,e,cd,ce);this.$4=cg;this.$3=new g(cd._impl.get__workbookImpl(),ce,cf,cg)};bm.__typeName='tab.FilterEvent';global.tab.FilterEvent=bm;var bn=function(e,cd,ce){this.$2=null;by.call(this,e,cd);this.$2=ce};bn.__typeName='tab.FirstVizSizeKnownEvent';global.tab.FirstVizSizeKnownEvent=bn;var bo=function(){};bo.__typeName='tab.ICrossDomainMessageHandler';global.tab.ICrossDomainMessageHandler=bo;var bp=function(){};bp.__typeName='tab.ICrossDomainMessageRouter';global.tab.ICrossDomainMessageRouter=bp;var bq=function(e,cd,ce){this.$3=null;bD.call(this,e,cd,ce);this.$3=new m(cd._impl.get__workbookImpl(),ce)};bq.__typeName='tab.MarksEvent';global.tab.MarksEvent=bq;var br=function(e,cd,ce){this.$2=null;by.call(this,e,cd);this.$2=new d(cd._impl.get__workbookImpl(),ce)};br.__typeName='tab.ParameterEvent';global.tab.ParameterEvent=br;var bs=function(){};bs.__typeName='tab.Point';bs.$ctor=function(e,cd){var ce=new Object;ce.x=0;ce.y=0;ce.x=e;ce.y=cd;return ce};global.tab.Point=bs;var bt=function(){};bt.__typeName='tab.SheetSize';bt.$ctor=function(e,cd,ce){var cf=new Object;cf.behavior=null;cf.minSize=null;cf.maxSize=null;cf.behavior=ss.coalesce(e,'automatic');if(ss.isValue(cd)){cf.minSize=cd}else{delete cf['minSize']}if(ss.isValue(ce)){cf.maxSize=ce}else{delete cf['maxSize']}return cf};global.tab.SheetSize=bt;var bu=function(){};bu.__typeName='tab.SheetSizeFactory';bu.createAutomatic=function(){var e=bt.$ctor('automatic',null,null);return e};bu.fromSizeConstraints=function(e){var cd=e.minHeight;var ce=e.minWidth;var cf=e.maxHeight;var cg=e.maxWidth;var ch='automatic';var ci=null;var cj=null;if(cd===0&&ce===0){if(cf===0&&cg===0){}else{ch='atmost';cj=bv.$ctor(cg,cf)}}else if(cf===0&&cg===0){ch='atleast';ci=bv.$ctor(ce,cd)}else if(cf===cd&&cg===ce&&ce>0){ch='exactly';ci=bv.$ctor(ce,cd);cj=bv.$ctor(ce,cd)}else{ch='range';if(ce===0&&cg===0){cg=2147483647}ci=bv.$ctor(ce,cd);cj=bv.$ctor(cg,cf)}return bt.$ctor(ch,ci,cj)};global.tab.SheetSizeFactory=bu;var bv=function(){};bv.__typeName='tab.Size';bv.$ctor=function(e,cd){var ce=new Object;ce.width=0;ce.height=0;ce.width=e;ce.height=cd;return ce};global.tab.Size=bv;var bw=function(){};bw.__typeName='tab.StoryPointInfoImplUtil';bw.clone=function(e){return H.$ctor(e.caption,e.index,e.storyPointId,e.isActive,e.isUpdated,e.parentStoryImpl)};global.tab.StoryPointInfoImplUtil=bw;var bx=function(e,cd,ce,cf){this.$3=null;this.$2=null;by.call(this,e,cd);this.$3=ce;this.$2=cf};bx.__typeName='tab.StoryPointSwitchEvent';global.tab.StoryPointSwitchEvent=bx;var by=function(e,cd){this.$1=null;this.$0=null;this.$1=cd;this.$0=e};by.__typeName='tab.TableauEvent';global.tab.TableauEvent=by;var bz=function(e,cd,ce,cf){this.$3=null;this.$2=null;by.call(this,e,cd);this.$3=ce;this.$2=cf};bz.__typeName='tab.TabSwitchEvent';global.tab.TabSwitchEvent=bz;var bA=function(e,cd,ce,cf,cg){this.$16=null;this.$1k=null;this.$19=null;this.$1j=null;this.$1i=null;this.$1a=null;this.$1c=null;this.$1n=null;this.$1g=null;this.$1h=null;this.$1f=false;this.$18=false;this.$1d=false;this.$17=false;this.$1e=null;this.$1l=null;this.$1m=null;this.$1b=false;this.$1$1=null;this.$1$2=null;this.$1$3=null;this.$1$4=null;this.$1$5=null;this.$1$6=null;this.$1$7=null;this.$1$8=null;this.$1$9=null;this.$1$10=null;this.$1$11=null;this.$1$12=null;if(!J.hasWindowPostMessage()||!J.hasJsonParse()){throw I.createBrowserNotCapable()}this.$1e=new bh(e,this);this.$1k=cd;if(ss.isNullOrUndefined(ce)||ce.nodeType!==1){ce=document.body}this.$1i=new L(ce,cf,cg);if(ss.isValue(cg)){this.$1g=cg.onFirstInteractive;this.$1h=cg.onFirstVizSizeKnown}};bA.__typeName='tab.VizImpl';global.tab.VizImpl=bA;var bB=function(e,cd,ce){this.$2=null;by.call(this,e,cd);this.$2=ce};bB.__typeName='tab.VizResizeEvent';global.tab.VizResizeEvent=bB;var bC=function(){};bC.__typeName='tab.VizSize';bC.$ctor=function(e,cd){var ce=new Object;ce.sheetSize=null;ce.chromeHeight=0;ce.sheetSize=e;ce.chromeHeight=cd;return ce};global.tab.VizSize=bC;var bD=function(e,cd,ce){this.$2=null;by.call(this,e,cd);this.$2=ce};bD.__typeName='tab.WorksheetEvent';global.tab.WorksheetEvent=bD;var bE=function(e,cd){this.$a=false;this.$9=null;bM.call(this,e,cd);this.$8(cd)};bE.__typeName='tableauSoftware.CategoricalFilter';global.tableauSoftware.CategoricalFilter=bE;var bF=function(e){this.$0=null;this.$0=e};bF.__typeName='tableauSoftware.Column';global.tableauSoftware.Column=bF;var bG=function(e){this._impl=null;this._impl=e};bG.__typeName='tableauSoftware.CustomView';global.tableauSoftware.CustomView=bG;var bH=function(e){this._impl=null;bT.call(this,e)};bH.__typeName='tableauSoftware.Dashboard';global.tableauSoftware.Dashboard=bH;var bI=function(e,cd,ce){this.$2=null;this.$0=null;this.$1=null;if(e.objectType==='worksheet'&&ss.isNullOrUndefined(ce)){throw I.createInternalError('worksheet parameter is required for WORKSHEET objects')}else if(e.objectType!=='worksheet'&&ss.isValue(ce)){throw I.createInternalError('worksheet parameter should be undefined for non-WORKSHEET objects')}this.$2=e;this.$0=cd;this.$1=ce};bI.__typeName='tableauSoftware.DashboardObject';global.tableauSoftware.DashboardObject=bI;var bJ=function(e){this.$0=null;this.$0=e};bJ.__typeName='tableauSoftware.DataSource';global.tableauSoftware.DataSource=bJ;var bK=function(e){this.$0=null;this.$0=e};bK.__typeName='tableauSoftware.DataTable';global.tableauSoftware.DataTable=bK;var bL=function(e,cd,ce,cf){this.$0=null;this.$3=null;this.$2=null;this.$1=null;this.$0=e;this.$3=cd;this.$2=ce;this.$1=cf};bL.__typeName='tableauSoftware.Field';global.tableauSoftware.Field=bL;var bM=function(e,cd){this.$7=null;this.$6=null;this.$1=null;this.$3=null;this.$2=null;this.$5=null;this.$4=null;this.$7=e;this.$0(cd)};bM.__typeName='tableauSoftware.Filter';bM.$0=function(e,cd){switch(cd.filterType){case'categorical':{return new bE(e,cd)}case'relativedate':{return new bS(e,cd)}case'hierarchical':{return new bN(e,cd)}case'quantitative':{return new bR(e,cd)}}return null};bM.$1=function(e,cd){var ce=new tab._Collection;for(var cf=0;cf<cd.filters.length;cf++){var cg=cd.filters[cf];var ch=bM.$0(e,cg);ce._add(cg.caption,ch)}return ce};global.tableauSoftware.Filter=bM;var bN=function(e,cd){this.$9=0;bM.call(this,e,cd);this.$8(cd)};bN.__typeName='tableauSoftware.HierarchicalFilter';global.tableauSoftware.HierarchicalFilter=bN;var bO=function(e){this.$0=null;this.$0=new j(e)};bO.__typeName='tableauSoftware.Mark';global.tableauSoftware.Mark=bO;var bP=function(e,cd){this.fieldName=null;this.value=null;this.formattedValue=null;this.fieldName=e;this.value=cd;this.formattedValue=(ss.isValue(cd)?cd.toString():'')};bP.__typeName='tableauSoftware.Pair';global.tableauSoftware.Pair=bP;var bQ=function(e){this._impl=null;this._impl=e};bQ.__typeName='tableauSoftware.Parameter';global.tableauSoftware.Parameter=bQ;var bR=function(e,cd){this.$a=null;this.$9=null;this.$d=null;this.$c=null;this.$b=false;bM.call(this,e,cd);this.$8(cd)};bR.__typeName='tableauSoftware.QuantitativeFilter';global.tableauSoftware.QuantitativeFilter=bR;var bS=function(e,cd){this.$9=null;this.$b=null;this.$a=0;bM.call(this,e,cd);this.$8(cd)};bS.__typeName='tableauSoftware.RelativeDateFilter';global.tableauSoftware.RelativeDateFilter=bS;var bT=function(e){this._impl=null;A.verifyValue(e,'sheetImpl');this._impl=e};bT.__typeName='tableauSoftware.Sheet';global.tableauSoftware.Sheet=bT;var bU=function(e){this.$0=null;this.$0=e};bU.__typeName='tableauSoftware.SheetInfo';global.tableauSoftware.SheetInfo=bU;var bV=function(e){this._impl=null;bT.call(this,e)};bV.__typeName='tableauSoftware.Story';global.tableauSoftware.Story=bV;var bW=function(e){this.$0=null;this.$0=e};bW.__typeName='tableauSoftware.StoryPoint';global.tableauSoftware.StoryPoint=bW;var bX=function(e){this._impl=null;this._impl=e};bX.__typeName='tableauSoftware.StoryPointInfo';global.tableauSoftware.StoryPointInfo=bX;var bY=function(e,cd,ce,cf){this.$0=0;this.$2=0;this.$3=0;this.$1=null;this.$0=e;this.$2=cd;this.$3=ce;this.$1=ss.coalesce(cf,null)};bY.__typeName='tableauSoftware.Version';bY.getCurrent=function(){return bY.$0};global.tableauSoftware.Version=bY;var bZ=function(e,cd,ce){this._impl=null;var cf=p.getCrossDomainMessageRouter();this._impl=new bA(cf,this,e,cd,ce);this._impl.$4()};bZ.__typeName='tableauSoftware.Viz';global.tableauSoftware.Viz=bZ;var ca=function(){};ca.__typeName='tableauSoftware.VizManager';ca.getVizs=function(){return K.$4()};global.tableauSoftware.VizManager=ca;var cb=function(e){this.$0=null;this.$0=e};cb.__typeName='tableauSoftware.Workbook';global.tableauSoftware.Workbook=cb;var cc=function(e){this._impl=null;bT.call(this,e)};cc.__typeName='tableauSoftware.Worksheet';global.tableauSoftware.Worksheet=cc;ss.initInterface(bp,a,{registerHandler:null,unregisterHandler:null,sendCommand:null});ss.initClass(b,a,{registerHandler:function(e){var cd='handler'+this.$9;if(ss.isValue(e.get_handlerId())||ss.isValue(this.$8[e.get_handlerId()])){throw I.createInternalError("Handler '"+e.get_handlerId()+"' is already registered.")}this.$9++;e.set_handlerId(cd);this.$8[cd]=e;e.add_customViewsListLoad(ss.mkdel(this,this.$2));e.add_stateReadyForQuery(ss.mkdel(this,this.$4))},unregisterHandler:function(e){if(ss.isValue(e.get_handlerId())||ss.isValue(this.$8[e.get_handlerId()])){delete this.$8[e.get_handlerId()];e.remove_customViewsListLoad(ss.mkdel(this,this.$2));e.remove_stateReadyForQuery(ss.mkdel(this,this.$4))}},sendCommand:function(e){return function(cd,ce,cf){var cg=cd.get_iframe();var ch=cd.get_handlerId();if(!J.hasWindowPostMessage()||ss.isNullOrUndefined(cg)||ss.isNullOrUndefined(cg.contentWindow)){return}var ci=o.generateNextCommandId();var cj=this.$5[ch];if(ss.isNullOrUndefined(cj)){cj={};this.$5[ch]=cj}cj[ci]=cf;var ck=cf.get_commandName();if(ck==='api.ShowCustomViewCommand'){var cl=this.$7[ch];if(ss.isNullOrUndefined(cl)){cl=[];this.$7[ch]=cl}cl.push(cf)}var cm=null;if(ss.isValue(ce)){cm=JSON.stringify(ce)}var cn=new o(ck,ci,ch,cm);var co=cn.serialize();if(J.isPostMessageSynchronous()){window.setTimeout(function(){cg.contentWindow.postMessage(co,'*')},0)}else{cg.contentWindow.postMessage(co,'*')}}},$2:function(e){var cd=e.get_handlerId();var ce=this.$7[cd];if(ss.isNullOrUndefined(ce)){return}for(var cf=0;cf<ce.length;cf++){var cg=ce[cf];if(!ss.staticEquals(cg.get_successCallback(),null)){cg.get_successCallback()(null)}}delete this.$7[cd]},$4:function(e){var cd=this.$6[e.get_handlerId()];if(J.isNullOrEmpty(cd)){return}while(cd.length>0){var ce=cd.pop();if(ss.isValue(ce)){ce()}}},$0:function(e){var cd=e;if(ss.isNullOrUndefined(cd.data)){return}var ce=o.parse(cd.data.toString());var cf=ce.get_rawName();var cg=ce.get_handlerId();var ch=this.$8[cg];if(ss.isNullOrUndefined(ch)||!ss.referenceEquals(ch.get_handlerId(),ce.get_handlerId())){ch=new c}if(ce.get_isApiCommandName()){if(ce.get_commandId()==='xdomainSourceId'){ch.handleEventNotification(ce.get_name(),ce.get_parameters());if(ce.get_name()==='api.FirstVizSizeKnownEvent'){cd.source.postMessage('tableau.bootstrap'.toString(),'*')}}else{this.$1(ce)}}else{this.$3(cf,ch)}},$1:function(e){var cd=this.$5[e.get_handlerId()];var ce=(ss.isValue(cd)?cd[e.get_commandId()]:null);if(ss.isNullOrUndefined(ce)){return}delete cd[e.get_commandId()];if(e.get_name()!==ce.get_commandName()){return}var cf=new r(e.get_parameters());var cg=cf.get_data();if(cf.get_result()==='api.success'){switch(ce.get_successCallbackTiming()){case 0:{if(ss.isValue(ce.get_successCallback())){ce.get_successCallback()(cg)}break}case 1:{var ch=function(){if(ss.isValue(ce.get_successCallback())){ce.get_successCallback()(cg)}};var ci=this.$6[e.get_handlerId()];if(ss.isNullOrUndefined(ci)){ci=[];this.$6[e.get_handlerId()]=ci}ci.push(ch);break}default:{throw I.createInternalError('Unknown timing value: '+ce.get_successCallbackTiming())}}}else if(ss.isValue(ce.get_errorCallback())){var cj=cf.get_result()==='api.remotefailed';var ck=(ss.isValue(cg)?cg.toString():'');ce.get_errorCallback()(cj,ck)}},$3:function(e,cd){if(ss.referenceEquals(e,'layoutInfoReq'.toString())){K.$1()}else if(ss.referenceEquals(e,'tableau.completed'.toString())||ss.referenceEquals(e,'completed'.toString())){cd.handleVizLoad()}else if(e==='tableau.listening'){cd.handleVizListening()}}},null,[bp]);ss.initInterface(bo,a,{add_customViewsListLoad:null,remove_customViewsListLoad:null,add_stateReadyForQuery:null,remove_stateReadyForQuery:null,get_iframe:null,get_handlerId:null,set_handlerId:null,handleVizLoad:null,handleVizListening:null,handleEventNotification:null});ss.initClass(c,a,{add_customViewsListLoad:function(e){this.$1$1=ss.delegateCombine(this.$1$1,e)},remove_customViewsListLoad:function(e){this.$1$1=ss.delegateRemove(this.$1$1,e)},add_stateReadyForQuery:function(e){this.$1$2=ss.delegateCombine(this.$1$2,e)},remove_stateReadyForQuery:function(e){this.$1$2=ss.delegateRemove(this.$1$2,e)},get_iframe:function(){return null},get_handlerId:function(){return this.$2},set_handlerId:function(e){this.$2=e},$1:function(){return'*'},handleVizLoad:function(){},handleVizListening:function(){},handleEventNotification:function(e,cd){},$0:function(){this.$1$1(null);this.$1$2(null)}},null,[bo]);ss.initClass(bl,a,{get__workbookImpl:function(){return this.$0},get__worksheetImpl:function(){return this.$1}});ss.initClass(d,a,{get__parameterName:function(){return this.$2}},bl);ss.initClass(f,a,{get__customViewImpl:function(){return this.$2}},bl);ss.initClass(g,a,{get__filterFieldName:function(){return this.$3},$2:function(){return this.$4}},bl);ss.initClass(h,a,{});ss.initClass(i,a,{});ss.initClass(j,a,{$2:function(){return this.$5},$3:function(){return this.$6},$1:function(){if(ss.isNullOrUndefined(this.$4)){this.$4=this.$5._toApiCollection()}return this.$4},$0:function(e){this.$5._add(e.fieldName,e)}});ss.initClass(k,a,{$8:function(){if(ss.isNullOrUndefined(this.$i)){this.$i=new bQ(this)}return this.$i},$7:function(){return this.$h},$2:function(){return this.$c},$3:function(){return this.$d},$1:function(){return this.$b},$0:function(){return this.$a},$6:function(){return this.$g},$5:function(){return this.$f},$9:function(){return this.$j},$4:function(){return this.$e}});ss.initClass(l,a,{});ss.initClass(m,a,{},bl);ss.initClass(n,a,{});ss.initClass(o,a,{get_name:function(){return this.$2},get_handlerId:function(){return this.$1},get_commandId:function(){return this.$0},get_parameters:function(){return this.$3},get_isApiCommandName:function(){return this.get_rawName().indexOf('api.',0)===0},get_rawName:function(){return this.$2.toString()},serialize:function(){var e=[];e.push(this.$2);e.push(this.$0);e.push(this.$1);if(ss.isValue(this.$3)){e.push(this.$3)}var cd=e.join(',');return cd}});ss.initClass(p,a,{});ss.initClass(q,a,{get_workbookName:function(){return this.$1},get_worksheetName:function(){return this.$2},get_data:function(){return this.$0},serialize:function(){var e={};e['api.workbookName']=this.$1;e['api.worksheetName']=this.$2;e['api.commandData']=this.$0;return JSON.stringify(e)}});ss.initClass(r,a,{get_result:function(){return this.$1},get_data:function(){return this.$0}});ss.initClass(s,a,{get__length:function(){return this.$4.length},get__rawArray:function(){return this.$4},get_item:function(e){return this.$4[e]},_get:function(e){var cd=this.$0(e);if(ss.isValue(this.$3[cd])){return this.$3[cd]}return undefined},_has:function(e){return ss.isValue(this._get(e))},_add:function(e,cd){this.$1(e,cd);var ce=this.$0(e);this.$4.push(cd);this.$3[ce]=cd},_addToFirst:function(e,cd){this.$1(e,cd);var ce=this.$0(e);this.$4.unshift(cd);this.$3[ce]=cd},_remove:function(e){var cd=this.$0(e);if(ss.isValue(this.$3[cd])){var ce=this.$3[cd];delete this.$3[cd];for(var cf=0;cf<this.$4.length;cf++){if(ss.referenceEquals(this.$4[cf],ce)){this.$4.splice(cf,1);break}}}},_toApiCollection:function(){var e=this.$4.concat();e.get=ss.mkdel(this,function(cd){return this._get(cd)});e.has=ss.mkdel(this,function(cd){return this._has(cd)});return e},$2:function(e){if(J.isNullOrEmpty(e)){throw new ss.Exception('Null key')}if(this._has(e)){throw new ss.Exception("Duplicate key '"+e+"'")}},$1:function(e,cd){this.$2(e);if(ss.isNullOrUndefined(cd)){throw new ss.Exception('Null item')}},$0:function(e){return'_'+e}});ss.initClass(t,a,{get_fieldName:function(){return this.$1},get_dataType:function(){return this.$0},get_isReferenced:function(){return this.$3},get_index:function(){return this.$2}});ss.initClass(u,a,{$5:function(){if(ss.isNullOrUndefined(this.$c)){this.$c=new bG(this)}return this.$c},$b:function(){return this.$l.get_workbook()},$a:function(){return this.$k},$7:function(){return this.$h},$8:function(e){if(this.$f){throw I.create('staleDataReference','Stale data')}this.$h=e},$9:function(){return this.$i},$3:function(){return this.$e},$4:function(e){if(this.$f){throw I.create('staleDataReference','Stale data')}this.$e=e},$6:function(){return this.$d},$2:function(){if(this.$f||ss.isNullOrUndefined(this.$j)){throw I.create('staleDataReference','Stale data')}this.$j.isPublic=this.$e;this.$j.name=this.$h;var e=new tab._Deferred;var cd={};cd['api.customViewParam']=this.$j;var ce=u.$0('api.UpdateCustomViewCommand',e,ss.mkdel(this,function(cf){u._processCustomViewUpdate(this.$l,this.$g,cf,true);e.resolve(this.$5())}));this.$g.sendCommand(Object).call(this.$g,cd,ce);return e.get_promise()},$1:function(){var e=new tab._Deferred;var cd={};cd['api.customViewParam']=this.$j;var ce=u.$0('api.RemoveCustomViewCommand',e,ss.mkdel(this,function(cf){this.$f=true;u._processCustomViews(this.$l,this.$g,cf);e.resolve(this.$5())}));this.$g.sendCommand(Object).call(this.$g,cd,ce);return e.get_promise()},_showAsync:function(){if(this.$f||ss.isNullOrUndefined(this.$j)){throw I.create('staleDataReference','Stale data')}return u._showCustomViewAsync(this.$l,this.$g,this.$j)},$0:function(e){return!ss.referenceEquals(this.$i,e.$i)||!ss.referenceEquals(this.$k,e.$k)||this.$e!==e.$e||this.$d!==e.$d}});ss.initClass(D,a,{get_sheet:null,get_name:function(){return this.$5},get_index:function(){return this.$1},get_workbookImpl:function(){return this.$a},get_workbook:function(){return this.$a.get_workbook()},get_url:function(){if(this.$3){throw I.createNoUrlForHiddenWorksheet()}return this.$9},get_size:function(){return this.$8},get_isHidden:function(){return this.$3},get_isActive:function(){return this.$2},set_isActive:function(e){this.$2=e},get_isDashboard:function(){return this.$7==='dashboard'},get_isStory:function(){return this.$7==='story'},get_sheetType:function(){return this.$7},get_parentStoryPoint:function(){if(ss.isValue(this.$6)){return this.$6.get_storyPoint()}return null},get_parentStoryPointImpl:function(){return this.$6},set_parentStoryPointImpl:function(e){if(this.$7==='story'){throw I.createInternalError('A story cannot be a child of another story.')}this.$6=e},get_zoneId:function(){return this.$b},get_messagingOptions:function(){return this.$4},changeSizeAsync:function(e){e=D.$1(e);if(this.$7==='worksheet'&&e.behavior!=='automatic'){throw I.createInvalidSizeBehaviorOnWorksheet()}var cd=new tab._Deferred;if(this.$8.behavior===e.behavior&&e.behavior==='automatic'){cd.resolve(e);return cd.get_promise()}var ce=this.$0(e);var cf={};cf['api.setSheetSizeName']=this.$5;cf['api.minWidth']=ce['api.minWidth'];cf['api.minHeight']=ce['api.minHeight'];cf['api.maxWidth']=ce['api.maxWidth'];cf['api.maxHeight']=ce['api.maxHeight'];var cg=new(ss.makeGenericType(bg,[Object]))('api.SetSheetSizeCommand',1,ss.mkdel(this,function(ch){this.get_workbookImpl()._update(ss.mkdel(this,function(){var ci=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();cd.resolve(ci)}))}),function(ch,ci){cd.reject(I.createServerError(ci))});this.sendCommand(Object).call(this,cf,cg);return cd.get_promise()},sendCommand:function(e){return function(cd,ce){this.$4.sendCommand(e).call(this.$4,cd,ce)}},$0:function(e){var cd=null;if(ss.isNullOrUndefined(e)||ss.isNullOrUndefined(e.behavior)||e.behavior!=='automatic'&&ss.isNullOrUndefined(e.minSize)&&ss.isNullOrUndefined(e.maxSize)){throw I.createInvalidSheetSizeParam()}var ce=0;var cf=0;var cg=0;var ch=0;var ci={};ci['api.minWidth']=0;ci['api.minHeight']=0;ci['api.maxWidth']=0;ci['api.maxHeight']=0;if(e.behavior==='automatic'){cd=bt.$ctor('automatic',undefined,undefined)}else if(e.behavior==='atmost'){if(ss.isNullOrUndefined(e.maxSize)||ss.isNullOrUndefined(e.maxSize.width)||ss.isNullOrUndefined(e.maxSize.height)){throw I.createMissingMaxSize()}if(e.maxSize.width<0||e.maxSize.height<0){throw I.createInvalidSizeValue()}ci['api.maxWidth']=e.maxSize.width;ci['api.maxHeight']=e.maxSize.height;cd=bt.$ctor('atmost',undefined,e.maxSize)}else if(e.behavior==='atleast'){if(ss.isNullOrUndefined(e.minSize)||ss.isNullOrUndefined(e.minSize.width)||ss.isNullOrUndefined(e.minSize.height)){throw I.createMissingMinSize()}if(e.minSize.width<0||e.minSize.height<0){throw I.createInvalidSizeValue()}ci['api.minWidth']=e.minSize.width;ci['api.minHeight']=e.minSize.height;cd=bt.$ctor('atleast',e.minSize,undefined)}else if(e.behavior==='range'){if(ss.isNullOrUndefined(e.minSize)||ss.isNullOrUndefined(e.maxSize)||ss.isNullOrUndefined(e.minSize.width)||ss.isNullOrUndefined(e.maxSize.width)||ss.isNullOrUndefined(e.minSize.height)||ss.isNullOrUndefined(e.maxSize.height)){throw I.createMissingMinMaxSize()}if(e.minSize.width<0||e.minSize.height<0||e.maxSize.width<0||e.maxSize.height<0||e.minSize.width>e.maxSize.width||e.minSize.height>e.maxSize.height){throw I.createInvalidRangeSize()}ci['api.minWidth']=e.minSize.width;ci['api.minHeight']=e.minSize.height;ci['api.maxWidth']=e.maxSize.width;ci['api.maxHeight']=e.maxSize.height;cd=bt.$ctor('range',e.minSize,e.maxSize)}else if(e.behavior==='exactly'){if(ss.isValue(e.minSize)&&ss.isValue(e.maxSize)&&ss.isValue(e.minSize.width)&&ss.isValue(e.maxSize.width)&&ss.isValue(e.minSize.height)&&ss.isValue(e.maxSize.height)){ce=e.minSize.width;cf=e.minSize.height;cg=e.maxSize.width;ch=e.maxSize.height;if(ce!==cg||cf!==ch){throw I.createSizeConflictForExactly()}}else if(ss.isValue(e.minSize)&&ss.isValue(e.minSize.width)&&ss.isValue(e.minSize.height)){ce=e.minSize.width;cf=e.minSize.height;cg=ce;ch=cf}else if(ss.isValue(e.maxSize)&&ss.isValue(e.maxSize.width)&&ss.isValue(e.maxSize.height)){cg=e.maxSize.width;ch=e.maxSize.height;ce=cg;cf=ch}ci['api.minWidth']=ce;ci['api.minHeight']=cf;ci['api.maxWidth']=cg;ci['api.maxHeight']=ch;cd=bt.$ctor('exactly',bv.$ctor(ce,cf),bv.$ctor(cg,ch))}this.$8=cd;return ci}});ss.initClass(v,a,{get_sheet:function(){return this.get_dashboard()},get_dashboard:function(){if(ss.isNullOrUndefined(this.$d)){this.$d=new bH(this)}return this.$d},get_worksheets:function(){return this.$f},get_objects:function(){return this.$e},$c:function(e,cd){this.$e=new tab._Collection;this.$f=new tab._Collection;for(var ce=0;ce<e.length;ce++){var cf=e[ce];var cg=null;if(e[ce].objectType==='worksheet'){var ch=cf.name;if(ss.isNullOrUndefined(ch)){continue}var ci=this.$f.get__length();var cj=bu.createAutomatic();var ck=false;var cl=cd(ch);var cm=ss.isNullOrUndefined(cl);var cn=(cm?'':cl.getUrl());var co=E.$ctor(ch,'worksheet',ci,cj,this.get_workbook(),cn,ck,cm,cf.zoneId);var cp=new N(co,this.get_workbookImpl(),this.get_messagingOptions(),this);cg=cp.get_worksheet();this.$f._add(ch,cp.get_worksheet())}var cq=new bI(cf,this.get_dashboard(),cg);this.$e._add(ce.toString(),cq)}}},D);ss.initClass(w,a,{get_dataSource:function(){if(ss.isNullOrUndefined(this.$0)){this.$0=new bJ(this)}return this.$0},get_name:function(){return this.$3},get_fields:function(){return this.$1},get_isPrimary:function(){return this.$2},addField:function(e){this.$1._add(e.getName(),e)}});ss.initClass(x,a,{get_name:function(){return this.$2},get_rows:function(){return this.$3},get_columns:function(){return this.$0},get_totalRowCount:function(){return this.$4},get_isSummaryData:function(){return this.$1}});ss.initClass(y,a,{get_promise:function(){return this.$3},all:function(e){var cd=new y;var ce=e.length;var cf=ce;var cg=[];if(ce===0){cd.resolve(cg);return cd.get_promise()}var ch=function(cj,ck){var cl=i.$0(cj);cl.then(function(cm){cg[ck]=cm;cf--;if(cf===0){cd.resolve(cg)}return null},function(cm){cd.reject(cm);return null})};for(var ci=0;ci<ce;ci++){ch(e[ci],ci)}return cd.get_promise()},then:function(e,cd){return this.$5(e,cd)},resolve:function(e){return this.$4(e)},reject:function(e){return this.$4(i.$3(e))},$0:function(e,cd){var ce=new y;this.$2.push(function(cf){cf.then(e,cd).then(ss.mkdel(ce,ce.resolve),ss.mkdel(ce,ce.reject))});return ce.get_promise()},$1:function(e){var cd=i.$0(e);this.$5=cd.then;this.$4=i.$0;for(var ce=0;ce<this.$2.length;ce++){var cf=this.$2[ce];cf(cd)}this.$2=null;return cd}});ss.initClass(z,a,{});ss.initClass(A,a,{});ss.initClass(B,a,{always:function(e){return this.then(e,e)},otherwise:function(e){return this.then(null,e)}});ss.initClass(C,a,{intersect:function(e){var cd=Math.max(this.left,e.left);var ce=Math.max(this.top,e.top);var cf=Math.min(this.left+this.width,e.left+e.width);var cg=Math.min(this.top+this.height,e.top+e.height);if(cf<=cd||cg<=ce){return new C(0,0,0,0)}return new C(cd,ce,cf-cd,cg-ce)}});ss.initClass(E,a,{},Object);ss.initClass(F,a,{add_activeStoryPointChange:function(e){this.$2$1=ss.delegateCombine(this.$2$1,e)},remove_activeStoryPointChange:function(e){this.$2$1=ss.delegateRemove(this.$2$1,e)},get_activeStoryPointImpl:function(){return this.$g},get_sheet:function(){return this.get_story()},get_story:function(){if(ss.isNullOrUndefined(this.$i)){this.$i=new bV(this)}return this.$i},get_storyPointsInfo:function(){return this.$j},update:function(e){var cd=null;var ce=null;this.$j=this.$j||new Array(e.storyPoints.length);for(var cf=0;cf<e.storyPoints.length;cf++){var cg=e.storyPoints[cf];var ch=cg.caption;var ci=cf===e.activeStoryPointIndex;var cj=H.$ctor(ch,cf,cg.storyPointId,ci,cg.isUpdated,this);if(ss.isNullOrUndefined(this.$j[cf])){this.$j[cf]=new bX(cj)}else if(this.$j[cf]._impl.storyPointId===cj.storyPointId){var ck=this.$j[cf]._impl;ck.caption=cj.caption;ck.index=cj.index;ck.isActive=ci;ck.isUpdated=cj.isUpdated}else{this.$j[cf]=new bX(cj)}if(ci){cd=cg.containedSheetInfo;ce=cj}}var cl=this.$j.length-e.storyPoints.length;this.$j.splice(e.storyPoints.length,cl);var cm=ss.isNullOrUndefined(this.$g)||this.$g.get_storyPointId()!==ce.storyPointId;if(ss.isValue(this.$g)&&cm){this.$g.set_isActive(false)}var cn=this.$g;if(cm){var co=G.createContainedSheet(cd,this.get_workbookImpl(),this.get_messagingOptions(),this.$h);this.$g=new G(ce,co)}else{this.$g.set_isActive(ce.isActive);this.$g.set_isUpdated(ce.isUpdated)}if(cm&&ss.isValue(cn)){this.$d(this.$j[cn.get_index()],this.$g.get_storyPoint())}},activatePreviousStoryPointAsync:function(){return this.$c('api.ActivatePreviousStoryPoint')},activateNextStoryPointAsync:function(){return this.$c('api.ActivateNextStoryPoint')},activateStoryPointAsync:function(e){var cd=new tab._Deferred;if(e<0||e>=this.$j.length){throw I.createIndexOutOfRange(e)}var ce=this.get_activeStoryPointImpl();var cf={};cf['api.storyPointIndex']=e;var cg=new(ss.makeGenericType(bg,[Object]))('api.ActivateStoryPoint',0,ss.mkdel(this,function(ch){this.$e(ce,ch);cd.resolve(this.$g.get_storyPoint())}),function(ch,ci){cd.reject(I.createServerError(ci))});this.sendCommand(Object).call(this,cf,cg);return cd.get_promise()},revertStoryPointAsync:function(e){e=e||this.$g.get_index();if(e<0||e>=this.$j.length){throw I.createIndexOutOfRange(e)}var cd=new tab._Deferred;var ce={};ce['api.storyPointIndex']=e;var cf=new(ss.makeGenericType(bg,[Object]))('api.RevertStoryPoint',0,ss.mkdel(this,function(cg){this.$f(e,cg);cd.resolve(this.$j[e])}),function(cg,ch){cd.reject(I.createServerError(ch))});this.sendCommand(Object).call(this,ce,cf);return cd.get_promise()},$c:function(e){if(e!=='api.ActivatePreviousStoryPoint'&&e!=='api.ActivateNextStoryPoint'){throw I.createInternalError("commandName '"+e+"' is invalid.")}var cd=new tab._Deferred;var ce=this.get_activeStoryPointImpl();var cf={};var cg=new(ss.makeGenericType(bg,[Object]))(e,0,ss.mkdel(this,function(ch){this.$e(ce,ch);cd.resolve(this.$g.get_storyPoint())}),function(ch,ci){cd.reject(I.createServerError(ci))});this.sendCommand(Object).call(this,cf,cg);return cd.get_promise()},$f:function(e,cd){var ce=this.$j[e]._impl;if(ce.storyPointId!==cd.storyPointId){throw I.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+ce.storyPointId+', newStoryPointID='+cd.storyPointId)}ce.caption=cd.caption;ce.isUpdated=cd.isUpdated;if(cd.storyPointId===this.$g.get_storyPointId()){this.$g.set_isUpdated(cd.isUpdated)}},$e:function(e,cd){var ce=cd.index;if(e.get_index()===ce){return}var cf=this.$j[e.get_index()];var cg=this.$j[ce]._impl;var ch=G.createContainedSheet(cd.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this.$h);cg.isActive=true;this.$g=new G(cg,ch);e.set_isActive(false);cf._impl.isActive=false;this.$d(cf,this.$g.get_storyPoint())},$d:function(e,cd){if(!ss.staticEquals(this.$2$1,null)){this.$2$1(e,cd)}}},D);ss.initClass(G,a,{get_caption:function(){return this.$1},get_containedSheetImpl:function(){return this.$2},get_index:function(){return this.$3},get_isActive:function(){return this.$4},set_isActive:function(e){this.$4=e},get_isUpdated:function(){return this.$5},set_isUpdated:function(e){this.$5=e},get_parentStoryImpl:function(){return this.$6},get_storyPoint:function(){if(ss.isNullOrUndefined(this.$7)){this.$7=new bW(this)}return this.$7},get_storyPointId:function(){return this.$8},$0:function(){return H.$ctor(this.$1,this.$3,this.$8,this.$4,this.$5,this.$6)}});ss.initClass(H,a,{},Object);ss.initClass(I,a,{});ss.initClass(J,a,{});ss.initClass(K,a,{});ss.initClass(L,a,{get_url:function(){return this.$0()},get_baseUrl:function(){return this.$2},$0:function(){var e=[];e.push(this.get_baseUrl());e.push('?');if(this.userSuppliedParameters.length>0){e.push(this.userSuppliedParameters);e.push('&')}e.push(':embed=y');e.push('&:showVizHome=n');if(!this.fixedSize){e.push('&:bootstrapWhenNotified=y')}if(!this.tabs){e.push('&:tabs=n')}if(this.displayStaticImage){e.push('&:display_static_image=y')}if(!this.toolbar){e.push('&:toolbar=n')}else if(!ss.isNullOrUndefined(this.toolBarPosition)){e.push('&:toolbar=');e.push(this.toolBarPosition.toString())}if(ss.isValue(this.device)){e.push('&:device=');e.push(this.device.toString())}var cd=this.$1;var ce=new ss.ObjectEnumerator(cd);try{while(ce.moveNext()){var cf=ce.current();if(cf.key!=='embed'&&cf.key!=='height'&&cf.key!=='width'&&cf.key!=='device'&&cf.key!=='autoSize'&&cf.key!=='hideTabs'&&cf.key!=='hideToolbar'&&cf.key!=='onFirstInteractive'&&cf.key!=='onFirstVizSizeKnown'&&cf.key!=='toolbarPosition'&&cf.key!=='instanceIdToClone'&&cf.key!=='display_static_image'){e.push('&');e.push(encodeURIComponent(cf.key));e.push('=');e.push(encodeURIComponent(cf.value.toString()))}}}finally{ce.dispose()}e.push('&:apiID='+this.handlerId);if(ss.isValue(this.$1.instanceIdToClone)){e.push('#'+this.$1.instanceIdToClone)}return e.join('')}});ss.initClass(M,a,{get_workbook:function(){if(ss.isNullOrUndefined(this.$E)){this.$E=new cb(this)}return this.$E},get_viz:function(){return this.$D.$13()},get_publishedSheets:function(){return this.$A},get_name:function(){return this.$y},get_activeSheetImpl:function(){return this.$s},get_activeCustomView:function(){return this.$t},get_isDownloadAllowed:function(){return this.$v},$4:function(e){if(ss.isNullOrUndefined(this.$s)){return null}var cd=M.$2(e);if(ss.isNullOrUndefined(cd)){return null}if(ss.referenceEquals(cd,this.$s.get_name())){return this.$s}if(this.$s.get_isDashboard()){var ce=this.$s;var cf=ce.get_worksheets()._get(cd);if(ss.isValue(cf)){return cf._impl}}return null},_setActiveSheetAsync:function(e){if(J.isNumber(e)){var cd=e;if(cd<this.$A.get__length()&&cd>=0){return this.$1(this.$A.get_item(cd).$0)}else{throw I.createIndexOutOfRange(cd)}}var ce=M.$2(e);var cf=this.$A._get(ce);if(ss.isValue(cf)){return this.$1(cf.$0)}else if(this.$s.get_isDashboard()){var cg=this.$s;var ch=cg.get_worksheets()._get(ce);if(ss.isValue(ch)){this.$r=null;var ci='';if(ch.getIsHidden()){this.$r=ch._impl}else{ci=ch._impl.get_url()}return this.$0(ch._impl.get_name(),ci)}}throw I.create('sheetNotInWorkbook','Sheet is not found in Workbook')},_revertAllAsync:function(){var e=new tab._Deferred;var cd=new(ss.makeGenericType(bg,[Object]))('api.RevertAllCommand',1,function(ce){e.resolve()},function(ce,cf){e.reject(I.createServerError(cf))});this.$d(Object).call(this,null,cd);return e.get_promise()},_update:function(e){this.$5(e)},$1:function(e){return this.$0(e.name,e.url)},$0:function(e,cd){var ce=new tab._Deferred;if(ss.isValue(this.$s)&&ss.referenceEquals(e,this.$s.get_name())){ce.resolve(this.$s.get_sheet());return ce.get_promise()}var cf={};cf['api.switchToSheetName']=e;cf['api.switchToRepositoryUrl']=cd;cf['api.oldRepositoryUrl']=this.$s.get_url();var cg=new(ss.makeGenericType(bg,[Object]))('api.SwitchActiveSheetCommand',0,ss.mkdel(this,function(ch){this.$D.$16=ss.mkdel(this,function(){this.$D.$16=null;ce.resolve(this.$s.get_sheet())})}),function(ch,ci){ce.reject(I.createServerError(ci))});this.$d(Object).call(this,cf,cg);return ce.get_promise()},_updateActiveSheetAsync:function(){var e=new tab._Deferred;var cd={};cd['api.switchToSheetName']=this.$s.get_name();cd['api.switchToRepositoryUrl']=this.$s.get_url();cd['api.oldRepositoryUrl']=this.$s.get_url();var ce=new(ss.makeGenericType(bg,[Object]))('api.UpdateActiveSheetCommand',0,ss.mkdel(this,function(cf){e.resolve(this.$s.get_sheet())}),function(cf,cg){e.reject(I.createServerError(cg))});this.$d(Object).call(this,cd,ce);return e.get_promise()},$d:function(e){return function(cd,ce){this.$x.sendCommand(e).call(this.$x,cd,ce)}},$5:function(e){var cd=new(ss.makeGenericType(bg,[Object]))('api.GetClientInfoCommand',0,ss.mkdel(this,function(ce){this.$a(ce);if(ss.isValue(e)){e()}}),null);this.$d(Object).call(this,null,cd)},$a:function(e){this.$y=e.workbookName;this.$v=e.isDownloadAllowed;this.$D.$L(!e.isAutoUpdate);this.$D.set_instanceId(e.instanceId);this.$3(e);this.$9(e)},$9:function(e){var cd=e.currentSheetName;var ce=this.$A._get(cd);if(ss.isNullOrUndefined(ce)&&ss.isNullOrUndefined(this.$r)){throw I.createInternalError('The active sheet was not specified in baseSheets')}if(ss.isValue(this.$s)&&ss.referenceEquals(this.$s.get_name(),cd)){return}if(ss.isValue(this.$s)){this.$s.set_isActive(false);var cf=this.$A._get(this.$s.get_name());if(ss.isValue(cf)){cf.$0.isActive=false}if(this.$s.get_sheetType()==='story'){var cg=this.$s;cg.remove_activeStoryPointChange(ss.mkdel(this.$D,this.$D.raiseStoryPointSwitch))}}if(ss.isValue(this.$r)){var ch=E.$ctor(this.$r.get_name(),'worksheet',-1,this.$r.get_size(),this.get_workbook(),'',true,true,4294967295);this.$r=null;this.$s=new N(ch,this,this.$x,null)}else{var ci=null;for(var cj=0,ck=e.publishedSheets.length;cj<ck;cj++){if(ss.referenceEquals(e.publishedSheets[cj].name,cd)){ci=e.publishedSheets[cj];break}}if(ss.isNullOrUndefined(ci)){throw I.createInternalError('No base sheet was found corresponding to the active sheet.')}var cl=ss.mkdel(this,function(cp){return this.$A._get(cp)});if(ci.sheetType==='dashboard'){var cm=new v(ce.$0,this,this.$x);this.$s=cm;var cn=M.$0(e.dashboardZones);cm.$c(cn,cl)}else if(ci.sheetType==='story'){var co=new F(ce.$0,this,this.$x,e.story,cl);this.$s=co;co.add_activeStoryPointChange(ss.mkdel(this.$D,this.$D.raiseStoryPointSwitch))}else{this.$s=new N(ce.$0,this,this.$x,null)}ce.$0.isActive=true}this.$s.set_isActive(true)},$3:function(e){var cd=e.publishedSheets;if(ss.isNullOrUndefined(cd)){return}for(var ce=0;ce<cd.length;ce++){var cf=cd[ce];var cg=cf.name;var ch=this.$A._get(cg);var ci=M.$1(cf);if(ss.isNullOrUndefined(ch)){var cj=ss.referenceEquals(cg,e.currentSheetName);var ck=R.convertSheetType(cf.sheetType);var cl=E.$ctor(cg,ck,ce,ci,this.get_workbook(),cf.repositoryUrl,cj,false,4294967295);ch=new bU(cl);this.$A._add(cg,ch)}else{ch.$0.size=ci}}},$i:function(){return this.$u},$j:function(e){this.$u=e},$p:function(){return this.$C},$q:function(e){this.$C=e},$n:function(){return this.$B},$o:function(e){this.$B=e},$g:function(){return this.$t},$h:function(e){this.$t=e},$6:function(){return u._getCustomViewsAsync(this,this.$x)},$f:function(e){if(ss.isNullOrUndefined(e)||J.isNullOrEmpty(e)){return u._showCustomViewAsync(this,this.$x,null)}else{var cd=this.$u._get(e);if(ss.isNullOrUndefined(cd)){var ce=new tab._Deferred;ce.reject(I.createInvalidCustomViewName(e));return ce.get_promise()}return cd._impl._showAsync()}},$c:function(e){if(J.isNullOrEmpty(e)){throw I.createNullOrEmptyParameter('customViewName')}var cd=this.$u._get(e);if(ss.isNullOrUndefined(cd)){var ce=new tab._Deferred;ce.reject(I.createInvalidCustomViewName(e));return ce.get_promise()}return cd._impl.$1()},$b:function(e){if(J.isNullOrEmpty(e)){throw I.createInvalidParameter('customViewName')}return u._saveNewAsync(this,this.$x,e)},$e:function(){return u._makeCurrentCustomViewDefaultAsync(this,this.$x)},$k:function(){return this.$w},$l:function(e){this.$w=e},$m:function(){return this.$z},$8:function(e){var cd=new tab._Deferred;if(ss.isValue(this.$w)){cd.resolve(this.$w.$8());return cd.get_promise()}var ce={};var cf=new(ss.makeGenericType(bg,[Object]))('api.FetchParametersCommand',0,ss.mkdel(this,function(cg){var ch=M.$3(e,cg);this.$w=ch;cd.resolve(ch.$8())}),function(cg,ch){cd.reject(I.createServerError(ch))});this.$d(Object).call(this,ce,cf);return cd.get_promise()},$7:function(){var e=new tab._Deferred;var cd={};var ce=new(ss.makeGenericType(bg,[Object]))('api.FetchParametersCommand',0,ss.mkdel(this,function(cf){this.$z=M.$4(cf);e.resolve(this.$m()._toApiCollection())}),function(cf,cg){e.reject(I.createServerError(cg))});this.$d(Object).call(this,cd,ce);return e.get_promise()},$2:function(e,cd){var ce=new tab._Deferred;var cf=null;if(ss.isValue(this.$z)){if(ss.isNullOrUndefined(this.$z._get(e))){ce.reject(I.createInvalidParameter(e));return ce.get_promise()}cf=this.$z._get(e)._impl;if(ss.isNullOrUndefined(cf)){ce.reject(I.createInvalidParameter(e));return ce.get_promise()}}var cg={};cg['api.setParameterName']=(ss.isValue(this.$z)?cf.$7():e);if(ss.isValue(cd)&&J.isDate(cd)){var ch=cd;var ci=J.serializeDateForServer(ch);cg['api.setParameterValue']=ci}else{cg['api.setParameterValue']=(ss.isValue(cd)?cd.toString():null)}this.$w=null;var cj=new(ss.makeGenericType(bg,[Object]))('api.SetParameterValueCommand',0,ss.mkdel(this,function(ck){if(ss.isNullOrUndefined(ck)){ce.reject(I.create('serverError','server error'));return}if(!ck.isValidPresModel){ce.reject(I.createInvalidParameter(e));return}var cl=new k(ck);this.$w=cl;ce.resolve(cl.$8())}),function(ck,cl){ce.reject(I.createInvalidParameter(e))});this.$d(Object).call(this,cg,cj);return ce.get_promise()}});ss.initClass(N,a,{get_sheet:function(){return this.get_worksheet()},get_worksheet:function(){if(ss.isNullOrUndefined(this.$G)){this.$G=new cc(this)}return this.$G},get_parentDashboardImpl:function(){return this.$E},get_parentDashboard:function(){if(ss.isValue(this.$E)){return this.$E.get_dashboard()}return null},$q:function(){this.$C();var e=new tab._Deferred;var cd={};cd['api.worksheetName']=this.get_name();var ce=new(ss.makeGenericType(bg,[Object]))('api.GetDataSourcesCommand',0,function(cf){var cg=w.processDataSourcesForWorksheet(cf);e.resolve(cg._toApiCollection())},function(cf,cg){e.reject(I.createServerError(cg))});this.sendCommand(Object).call(this,cd,ce);return e.get_promise()},$p:function(e){this.$C();var cd=new tab._Deferred;var ce={};ce['api.dataSourceName']=e;ce['api.worksheetName']=this.get_name();var cf=new(ss.makeGenericType(bg,[Object]))('api.GetDataSourceCommand',0,function(cg){var ch=w.processDataSource(cg);if(ss.isValue(ch)){cd.resolve(ch.get_dataSource())}else{cd.reject(I.createServerError("Data source '"+e+"' not found"))}},function(cg,ch){cd.reject(I.createServerError(ch))});this.sendCommand(Object).call(this,ce,cf);return cd.get_promise()},$C:function(){var e=this.get_isActive();var cd=ss.isValue(this.$E)&&this.$E.get_isActive();var ce=ss.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!e&&!cd&&!ce){throw I.createNotActiveSheet()}},$d:function(e){if(ss.isValue(this.get_parentStoryPointImpl())){var cd={};cd.AVP=this.get_name();cd.XwZ=(ss.isValue(this.get_parentDashboardImpl())?this.$E.get_name():this.get_name());cd.WIZ=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId();cd.Hna=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name();cd.hVl=this.get_parentStoryPointImpl().get_storyPointId();e['api.visualId']=cd}else{e['api.worksheetName']=this.get_name();if(ss.isValue(this.get_parentDashboardImpl())){e['api.dashboardName']=this.get_parentDashboardImpl().get_name()}}},get__filters:function(){return this.$D},set__filters:function(e){this.$D=e},$r:function(e,cd,ce){if(!J.isNullOrEmpty(e)&&!J.isNullOrEmpty(cd)){throw I.createInternalError('Only fieldName OR fieldCaption is allowed, not both.')}ce=ce||new Object;var cf=new tab._Deferred;var cg={};this.$d(cg);if(!J.isNullOrEmpty(cd)&&J.isNullOrEmpty(e)){cg['api.fieldCaption']=cd}if(!J.isNullOrEmpty(e)){cg['api.fieldName']=e}cg['api.filterHierarchicalLevels']=0;cg['api.ignoreDomain']=ce.ignoreDomain||false;var ch=new(ss.makeGenericType(bg,[Object]))('api.GetOneFilterInfoCommand',0,ss.mkdel(this,function(ci){var cj=N.$2(ci);if(ss.isNullOrUndefined(cj)){var ck=ci;var cl=bM.$0(this,ck);cf.resolve(cl)}else{cf.reject(cj)}}),function(ci,cj){cf.reject(I.createServerError(cj))});this.sendCommand(Object).call(this,cg,ch);return cf.get_promise()},$s:function(e){this.$C();e=e||new Object;var cd=new tab._Deferred;var ce={};this.$d(ce);ce['api.ignoreDomain']=e.ignoreDomain||false;var cf=new(ss.makeGenericType(bg,[Object]))('api.GetFiltersListCommand',0,ss.mkdel(this,function(cg){this.set__filters(bM.$1(this,cg));cd.resolve(this.get__filters()._toApiCollection())}),function(cg,ch){cd.reject(I.createServerError(ch))});this.sendCommand(Object).call(this,ce,cf);return cd.get_promise()},$e:function(e,cd,ce,cf){return this.$f(e,cd,ce,cf)},$m:function(e){return this.$n(e)},$i:function(e,cd){var ce=N.$3(cd);return this.$j(e,ce)},$k:function(e,cd){var ce=N.$4(cd);return this.$l(e,ce)},$g:function(e,cd,ce,cf){if(ss.isNullOrUndefined(cd)&&ce!=='all'){throw I.createInvalidParameter('values')}return this.$h(e,cd,ce,cf)},$n:function(e){this.$C();if(J.isNullOrEmpty(e)){throw I.createNullOrEmptyParameter('fieldName')}var cd=new tab._Deferred;var ce={};ce['api.fieldCaption']=e;this.$d(ce);var cf=N.$0('api.ClearFilterCommand',e,cd);this.sendCommand(Object).call(this,ce,cf);return cd.get_promise()},$f:function(e,cd,ce,cf){this.$C();if(J.isNullOrEmpty(e)){throw I.createNullOrEmptyParameter('fieldName')}ce=l.$1(W).call(null,ce,'updateType');var cg=[];if(z.isArray(cd)){for(var ch=0;ch<cd.length;ch++){cg.push(cd[ch].toString())}}else if(ss.isValue(cd)){cg.push(cd.toString())}var ci=new tab._Deferred;var cj={};cj['api.fieldCaption']=e;cj['api.filterUpdateType']=ce;cj['api.exclude']=((ss.isValue(cf)&&cf.isExcludeMode)?true:false);if(ce!=='all'){cj['api.filterCategoricalValues']=cg}this.$d(cj);var ck=N.$0('api.ApplyCategoricalFilterCommand',e,ci);this.sendCommand(Object).call(this,cj,ck);return ci.get_promise()},$j:function(e,cd){this.$C();if(J.isNullOrEmpty(e)){throw I.createNullOrEmptyParameter('fieldName')}if(ss.isNullOrUndefined(cd)){throw I.createNullOrEmptyParameter('filterOptions')}var ce={};ce['api.fieldCaption']=e;if(ss.isValue(cd.min)){if(J.isDate(cd.min)){var cf=cd.min;if(J.isDateValid(cf)){ce['api.filterRangeMin']=J.serializeDateForServer(cf)}else{throw I.createInvalidDateParameter('filterOptions.min')}}else{ce['api.filterRangeMin']=cd.min}}if(ss.isValue(cd.max)){if(J.isDate(cd.max)){var cg=cd.max;if(J.isDateValid(cg)){ce['api.filterRangeMax']=J.serializeDateForServer(cg)}else{throw I.createInvalidDateParameter('filterOptions.max')}}else{ce['api.filterRangeMax']=cd.max}}if(ss.isValue(cd.nullOption)){ce['api.filterRangeNullOption']=cd.nullOption}this.$d(ce);var ch=new tab._Deferred;var ci=N.$0('api.ApplyRangeFilterCommand',e,ch);this.sendCommand(Object).call(this,ce,ci);return ch.get_promise()},$l:function(e,cd){this.$C();if(J.isNullOrEmpty(e)){throw I.createInvalidParameter('fieldName')}else if(ss.isNullOrUndefined(cd)){throw I.createInvalidParameter('filterOptions')}var ce={};ce['api.fieldCaption']=e;if(ss.isValue(cd)){ce['api.filterPeriodType']=cd.periodType;ce['api.filterDateRangeType']=cd.rangeType;if(cd.rangeType==='lastn'||cd.rangeType==='nextn'){if(ss.isNullOrUndefined(cd.rangeN)){throw I.create('missingRangeNForRelativeDateFilters','Missing rangeN field for a relative date filter of LASTN or NEXTN.')}ce['api.filterDateRange']=cd.rangeN}if(ss.isValue(cd.anchorDate)){ce['api.filterDateArchorValue']=J.serializeDateForServer(cd.anchorDate)}}this.$d(ce);var cf=new tab._Deferred;var cg=N.$0('api.ApplyRelativeDateFilterCommand',e,cf);this.sendCommand(Object).call(this,ce,cg);return cf.get_promise()},$h:function(e,cd,ce,cf){this.$C();if(J.isNullOrEmpty(e)){throw I.createNullOrEmptyParameter('fieldName')}ce=l.$1(W).call(null,ce,'updateType');var cg=null;var ch=null;if(z.isArray(cd)){cg=[];var ci=cd;for(var cj=0;cj<ci.length;cj++){cg.push(ci[cj].toString())}}else if(J.isString(cd)){cg=[];cg.push(cd.toString())}else if(ss.isValue(cd)&&ss.isValue(cd['levels'])){var ck=cd['levels'];ch=[];if(z.isArray(ck)){var cl=ck;for(var cm=0;cm<cl.length;cm++){ch.push(cl[cm].toString())}}else{ch.push(ck.toString())}}else if(ss.isValue(cd)){throw I.createInvalidParameter('values')}var cn={};cn['api.fieldCaption']=e;cn['api.filterUpdateType']=ce;cn['api.exclude']=((ss.isValue(cf)&&cf.isExcludeMode)?true:false);if(ss.isValue(cg)){cn['api.filterHierarchicalValues']=JSON.stringify(cg)}if(ss.isValue(ch)){cn['api.filterHierarchicalLevels']=JSON.stringify(ch)}this.$d(cn);var co=new tab._Deferred;var cp=N.$0('api.ApplyHierarchicalFilterCommand',e,co);this.sendCommand(Object).call(this,cn,cp);return co.get_promise()},get_selectedMarks:function(){return this.$F},set_selectedMarks:function(e){this.$F=e},$o:function(){this.$C();var e=new tab._Deferred;var cd={};this.$d(cd);cd['api.filterUpdateType']='replace';var ce=new(ss.makeGenericType(bg,[Object]))('api.SelectMarksCommand',1,function(cf){e.resolve()},function(cf,cg){e.reject(I.createServerError(cg))});this.sendCommand(Object).call(this,cd,ce);return e.get_promise()},$x:function(e,cd,ce){this.$C();if(ss.isNullOrUndefined(e)&&ss.isNullOrUndefined(cd)){return this.$o()}if(J.isString(e)&&(z.isArray(cd)||J.isString(cd)||!l.$0(bb).call(null,cd))){return this.$y(e,cd,ce)}else if(z.isArray(e)){return this.$z(e,cd)}else{return this.$A(e,cd)}},$t:function(){this.$C();var e=new tab._Deferred;var cd={};this.$d(cd);var ce=new(ss.makeGenericType(bg,[Object]))('api.FetchSelectedMarksCommand',0,ss.mkdel(this,function(cf){this.$F=j.$0(cf);e.resolve(this.$F._toApiCollection())}),function(cf,cg){e.reject(I.createServerError(cg))});this.sendCommand(Object).call(this,cd,ce);return e.get_promise()},$y:function(e,cd,ce){var cf=[];var cg=[];var ch=[];var ci=[];var cj=[];var ck=[];this.$w(cf,cg,ch,ci,cj,ck,e,cd);return this.$B(null,cf,cg,ch,ci,cj,ck,ce)},$A:function(e,cd){var ce=e;var cf=[];var cg=[];var ch=[];var ci=[];var cj=[];var ck=[];var cl=new ss.ObjectEnumerator(ce);try{while(cl.moveNext()){var cm=cl.current();if(e.hasOwnProperty(cm.key)){if(!z.isFunction(ce[cm.key])){this.$w(cf,cg,ch,ci,cj,ck,cm.key,cm.value)}}}}finally{cl.dispose()}return this.$B(null,cf,cg,ch,ci,cj,ck,cd)},$z:function(e,cd){var ce=[];var cf=[];var cg=[];var ch=[];var ci=[];var cj=[];var ck=[];for(var cl=0;cl<e.length;cl++){var cm=e[cl];if(ss.isValue(cm.$0.$3())&&cm.$0.$3()>0){ck.push(cm.$0.$3())}else{var cn=cm.$0.$2();for(var co=0;co<cn.get__length();co++){var cp=cn.get_item(co);if(cp.hasOwnProperty('fieldName')&&cp.hasOwnProperty('value')&&!z.isFunction(cp.fieldName)&&!z.isFunction(cp.value)){this.$w(ce,cf,cg,ch,ci,cj,cp.fieldName,cp.value)}}}}return this.$B(ck,ce,cf,cg,ch,ci,cj,cd)},$w:function(e,cd,ce,cf,cg,ch,ci,cj){var ck=cj;if(N.$5.test(ci)){this.$c(ce,cf,ci,cj)}else if(ss.isValue(ck.min)||ss.isValue(ck.max)){var cl=new Object;if(ss.isValue(ck.min)){if(J.isDate(ck.min)){var cm=ck.min;if(J.isDateValid(cm)){cl.min=J.serializeDateForServer(cm)}else{throw I.createInvalidDateParameter('options.min')}}else{cl.min=ck.min}}if(ss.isValue(ck.max)){if(J.isDate(ck.max)){var cn=ck.max;if(J.isDateValid(cn)){cl.max=J.serializeDateForServer(cn)}else{throw I.createInvalidDateParameter('options.max')}}else{cl.max=ck.max}}if(ss.isValue(ck.nullOption)){var co=l.$1(X).call(null,ck.nullOption,'options.nullOption');cl.nullOption=co}else{cl.nullOption='allValues'}var cp=JSON.stringify(cl);this.$c(cg,ch,ci,cp)}else{this.$c(e,cd,ci,cj)}},$c:function(e,cd,ce,cf){var cg=[];if(z.isArray(cf)){var ch=cf;for(var ci=0;ci<ch.length;ci++){cg.push(ch[ci].toString())}}else{cg.push(cf.toString())}cd.push(cg);e.push(ce)},$B:function(e,cd,ce,cf,cg,ch,ci,cj){var ck={};this.$d(ck);cj=l.$1(bb).call(null,cj,'updateType');ck['api.filterUpdateType']=cj;if(!J.isNullOrEmpty(e)){ck['api.tupleIds']=JSON.stringify(e)}if(!J.isNullOrEmpty(cd)&&!J.isNullOrEmpty(ce)){ck['api.categoricalFieldCaption']=JSON.stringify(cd);var cl=[];for(var cm=0;cm<ce.length;cm++){var cn=JSON.stringify(ce[cm]);cl.push(cn)}ck['api.categoricalMarkValues']=JSON.stringify(cl)}if(!J.isNullOrEmpty(cf)&&!J.isNullOrEmpty(cg)){ck['api.hierarchicalFieldCaption']=JSON.stringify(cf);var co=[];for(var cp=0;cp<cg.length;cp++){var cq=JSON.stringify(cg[cp]);co.push(cq)}ck['api.hierarchicalMarkValues']=JSON.stringify(co)}if(!J.isNullOrEmpty(ch)&&!J.isNullOrEmpty(ci)){ck['api.rangeFieldCaption']=JSON.stringify(ch);var cr=[];for(var cs=0;cs<ci.length;cs++){var ct=JSON.stringify(ci[cs]);cr.push(ct)}ck['api.rangeMarkValues']=JSON.stringify(cr)}if(J.isNullOrEmpty(ck['api.tupleIds'])&&J.isNullOrEmpty(ck['api.categoricalFieldCaption'])&&J.isNullOrEmpty(ck['api.hierarchicalFieldCaption'])&&J.isNullOrEmpty(ck['api.rangeFieldCaption'])){throw I.createInvalidParameter('fieldNameOrFieldValuesMap')}var cu=new tab._Deferred;var cv=new(ss.makeGenericType(bg,[Object]))('api.SelectMarksCommand',1,function(cw){var cx=N.$1(cw);if(ss.isNullOrUndefined(cx)){cu.resolve()}else{cu.reject(cx)}},function(cw,cx){cu.reject(I.createServerError(cx))});this.sendCommand(Object).call(this,ck,cv);return cu.get_promise()},$u:function(e){this.$C();var cd=new tab._Deferred;var ce={};this.$d(ce);e=e||new Object;ce['api.ignoreAliases']=ss.coalesce(e.ignoreAliases,false);ce['api.ignoreSelection']=ss.coalesce(e.ignoreSelection,false);ce['api.maxRows']=ss.coalesce(e.maxRows,0);var cf=new(ss.makeGenericType(bg,[Object]))('api.GetSummaryTableCommand',0,function(cg){var ch=cg;var ci=x.processGetDataPresModel(ch);cd.resolve(ci)},function(cg,ch){cd.reject(I.createServerError(ch))});this.sendCommand(Object).call(this,ce,cf);return cd.get_promise()},$v:function(e){this.$C();var cd=new tab._Deferred;var ce={};this.$d(ce);e=e||new Object;ce['api.ignoreAliases']=ss.coalesce(e.ignoreAliases,false);ce['api.ignoreSelection']=ss.coalesce(e.ignoreSelection,false);ce['api.includeAllColumns']=ss.coalesce(e.includeAllColumns,false);ce['api.maxRows']=ss.coalesce(e.maxRows,0);var cf=new(ss.makeGenericType(bg,[Object]))('api.GetUnderlyingTableCommand',0,function(cg){var ch=cg;var ci=x.processGetDataPresModel(ch);cd.resolve(ci)},function(cg,ch){cd.reject(I.createServerError(ch))});this.sendCommand(Object).call(this,ce,cf);return cd.get_promise()}},D);ss.initEnum(O,a,{blank:'blank',worksheet:'worksheet',quickFilter:'quickFilter',parameterControl:'parameterControl',pageFilter:'pageFilter',legend:'legend',title:'title',text:'text',image:'image',webPage:'webPage'},true);ss.initEnum(P,a,{last:'last',lastn:'lastn',next:'next',nextn:'nextn',curr:'curr',todate:'todate'},true);ss.initEnum(Q,a,{default:'default',desktop:'desktop',tablet:'tablet',phone:'phone'},true);ss.initClass(R,a,{});ss.initEnum(S,a,{internalError:'internalError',serverError:'serverError',invalidAggregationFieldName:'invalidAggregationFieldName',invalidParameter:'invalidParameter',invalidUrl:'invalidUrl',staleDataReference:'staleDataReference',vizAlreadyInManager:'vizAlreadyInManager',noUrlOrParentElementNotFound:'noUrlOrParentElementNotFound',invalidFilterFieldName:'invalidFilterFieldName',invalidFilterFieldValue:'invalidFilterFieldValue',invalidFilterFieldNameOrValue:'invalidFilterFieldNameOrValue',filterCannotBePerformed:'filterCannotBePerformed',notActiveSheet:'notActiveSheet',invalidCustomViewName:'invalidCustomViewName',missingRangeNForRelativeDateFilters:'missingRangeNForRelativeDateFilters',missingMaxSize:'missingMaxSize',missingMinSize:'missingMinSize',missingMinMaxSize:'missingMinMaxSize',invalidSize:'invalidSize',invalidSizeBehaviorOnWorksheet:'invalidSizeBehaviorOnWorksheet',sheetNotInWorkbook:'sheetNotInWorkbook',indexOutOfRange:'indexOutOfRange',downloadWorkbookNotAllowed:'downloadWorkbookNotAllowed',nullOrEmptyParameter:'nullOrEmptyParameter',browserNotCapable:'browserNotCapable',unsupportedEventName:'unsupportedEventName',invalidDateParameter:'invalidDateParameter',invalidSelectionFieldName:'invalidSelectionFieldName',invalidSelectionValue:'invalidSelectionValue',invalidSelectionDate:'invalidSelectionDate',noUrlForHiddenWorksheet:'noUrlForHiddenWorksheet',maxVizResizeAttempts:'maxVizResizeAttempts'},true);ss.initEnum(T,a,{SUM:'SUM',AVG:'AVG',MIN:'MIN',MAX:'MAX',STDEV:'STDEV',STDEVP:'STDEVP',VAR:'VAR',VARP:'VARP',COUNT:'COUNT',COUNTD:'COUNTD',MEDIAN:'MEDIAN',ATTR:'ATTR',NONE:'NONE',PERCENTILE:'PERCENTILE',YEAR:'YEAR',QTR:'QTR',MONTH:'MONTH',DAY:'DAY',HOUR:'HOUR',MINUTE:'MINUTE',SECOND:'SECOND',WEEK:'WEEK',WEEKDAY:'WEEKDAY',MONTHYEAR:'MONTHYEAR',MDY:'MDY',END:'END',TRUNC_YEAR:'TRUNC_YEAR',TRUNC_QTR:'TRUNC_QTR',TRUNC_MONTH:'TRUNC_MONTH',TRUNC_WEEK:'TRUNC_WEEK',TRUNC_DAY:'TRUNC_DAY',TRUNC_HOUR:'TRUNC_HOUR',TRUNC_MINUTE:'TRUNC_MINUTE',TRUNC_SECOND:'TRUNC_SECOND',QUART1:'QUART1',QUART3:'QUART3',SKEWNESS:'SKEWNESS',KURTOSIS:'KURTOSIS',INOUT:'INOUT',SUM_XSQR:'SUM_XSQR',USER:'USER'},true);ss.initEnum(U,a,{dimension:'dimension',measure:'measure',unknown:'unknown'},true);ss.initEnum(V,a,{categorical:'categorical',quantitative:'quantitative',hierarchical:'hierarchical',relativedate:'relativedate'},true);ss.initEnum(W,a,{all:'all',replace:'replace',add:'add',remove:'remove'},true);ss.initEnum(X,a,{nullValues:'nullValues',nonNullValues:'nonNullValues',allValues:'allValues'},true);ss.initEnum(Y,a,{all:'all',list:'list',range:'range'},true);ss.initEnum(Z,a,{float:'float',integer:'integer',string:'string',boolean:'boolean',date:'date',datetime:'datetime'},true);ss.initEnum(ba,a,{year:'year',quarter:'quarter',month:'month',week:'week',day:'day',hour:'hour',minute:'minute',second:'second'},true);ss.initEnum(bb,a,{replace:'replace',add:'add',remove:'remove'},true);ss.initEnum(bc,a,{automatic:'automatic',exactly:'exactly',range:'range',atleast:'atleast',atmost:'atmost'},true);ss.initEnum(bd,a,{worksheet:'worksheet',dashboard:'dashboard',story:'story'},true);ss.initEnum(be,a,{customviewload:'customviewload',customviewremove:'customviewremove',customviewsave:'customviewsave',customviewsetdefault:'customviewsetdefault',filterchange:'filterchange',firstinteractive:'firstinteractive',firstvizsizeknown:'firstvizsizeknown',marksselection:'marksselection',parametervaluechange:'parametervaluechange',storypointswitch:'storypointswitch',tabswitch:'tabswitch',vizresize:'vizresize'},true);ss.initEnum(bf,a,{top:'top',bottom:'bottom'},true);ss.initClass(bh,a,{get_router:function(){return this.$1},get_handler:function(){return this.$0},sendCommand:function(e){return function(cd,ce){this.$1.sendCommand(e).call(this.$1,this.$0,cd,ce)}}});ss.initClass(by,a,{getViz:function(){return this.$1},getEventName:function(){return this.$0}});ss.initClass(bi,a,{getCustomViewAsync:function(){var e=new tab._Deferred;var cd=null;if(ss.isValue(this.$2.get__customViewImpl())){cd=this.$2.get__customViewImpl().$5()}e.resolve(cd);return e.get_promise()}},by);ss.initEnum(bj,a,{float:'float',integer:'integer',string:'string',boolean:'boolean',date:'date',datetime:'datetime'},true);ss.initClass(bk,a,{},Object);ss.initClass(bD,a,{getWorksheet:function(){return this.$2.get_worksheet()}},by);ss.initClass(bm,a,{getFieldName:function(){return this.$4},getFilterAsync:function(){return this.$3.get__worksheetImpl().$r(this.$3.get__filterFieldName(),null,null)}},bD);ss.initClass(bn,a,{getVizSize:function(){return this.$2}},by);ss.initClass(bq,a,{getMarksAsync:function(){var e=this.$3.get__worksheetImpl();if(ss.isValue(e.get_selectedMarks())){var cd=new tab._Deferred;return cd.resolve(e.get_selectedMarks()._toApiCollection())}return e.$t()}},bD);ss.initClass(br,a,{getParameterName:function(){return this.$2.get__parameterName()},getParameterAsync:function(){return this.$2.get__workbookImpl().$8(this.$2.get__parameterName())}},by);ss.initClass(bs,a,{},Object);ss.initClass(bt,a,{},Object);ss.initClass(bu,a,{});ss.initClass(bv,a,{},Object);ss.initClass(bw,a,{});ss.initClass(bx,a,{getOldStoryPointInfo:function(){return this.$3},getNewStoryPoint:function(){return this.$2}},by);ss.initClass(bz,a,{getOldSheetName:function(){return this.$3},getNewSheetName:function(){return this.$2}},by);ss.initClass(bA,a,{add_customViewsListLoad:function(e){this.$1$1=ss.delegateCombine(this.$1$1,e)},remove_customViewsListLoad:function(e){this.$1$1=ss.delegateRemove(this.$1$1,e)},add_stateReadyForQuery:function(e){this.$1$2=ss.delegateCombine(this.$1$2,e)},remove_stateReadyForQuery:function(e){this.$1$2=ss.delegateRemove(this.$1$2,e)},$1y:function(e){this.$1$3=ss.delegateCombine(this.$1$3,e)},$1z:function(e){this.$1$3=ss.delegateRemove(this.$1$3,e)},$1w:function(e){this.$1$4=ss.delegateCombine(this.$1$4,e)},$1x:function(e){this.$1$4=ss.delegateRemove(this.$1$4,e)},$1A:function(e){this.$1$5=ss.delegateCombine(this.$1$5,e)},$1B:function(e){this.$1$5=ss.delegateRemove(this.$1$5,e)},$1o:function(e){this.$1$6=ss.delegateCombine(this.$1$6,e)},$1p:function(e){this.$1$6=ss.delegateRemove(this.$1$6,e)},$1s:function(e){this.$1$7=ss.delegateCombine(this.$1$7,e)},$1t:function(e){this.$1$7=ss.delegateRemove(this.$1$7,e)},$1q:function(e){this.$1$8=ss.delegateCombine(this.$1$8,e)},$1r:function(e){this.$1$8=ss.delegateRemove(this.$1$8,e)},$1u:function(e){this.$1$9=ss.delegateCombine(this.$1$9,e)},$1v:function(e){this.$1$9=ss.delegateRemove(this.$1$9,e)},$1E:function(e){this.$1$10=ss.delegateCombine(this.$1$10,e)},$1F:function(e){this.$1$10=ss.delegateRemove(this.$1$10,e)},$1C:function(e){this.$1$11=ss.delegateCombine(this.$1$11,e)},$1D:function(e){this.$1$11=ss.delegateRemove(this.$1$11,e)},$1G:function(e){this.$1$12=ss.delegateCombine(this.$1$12,e)},$1H:function(e){this.$1$12=ss.delegateRemove(this.$1$12,e)},get_handlerId:function(){return this.$1i.handlerId},set_handlerId:function(e){this.$1i.handlerId=e},get_iframe:function(){return this.$19},get_instanceId:function(){return this.$1c},set_instanceId:function(e){this.$1c=e},$13:function(){return this.$1k},$Y:function(){return this.$18},$10:function(){return this.$1d},$Z:function(){return this.$19.style.display==='none'},$11:function(){return this.$1i.parentElement},$12:function(){return this.$1i.get_baseUrl()},$15:function(){return this.$1n.get_workbook()},get__workbookImpl:function(){return this.$1n},$X:function(){return this.$17},$14:function(){return this.$1l},getCurrentUrlAsync:function(){var e=new tab._Deferred;var cd=new(ss.makeGenericType(bg,[String]))('api.GetCurrentUrlCommand',0,function(ce){e.resolve(ce)},function(ce,cf){e.reject(I.createInternalError(cf))});this._sendCommand(String).call(this,null,cd);return e.get_promise()},handleVizListening:function(){this.$8()},handleVizLoad:function(){if(ss.isValue(this.$1j)){this.$1j.style.display='none'}if(ss.isNullOrUndefined(this.$1n)){this.$1n=new M(this,this.$1e,ss.mkdel(this,function(){this.$u(null)}))}else if(!this.$1b){this.$1n._update(ss.mkdel(this,function(){this.$u(null)}))}},$1:function(e){var cd=this.$1l.chromeHeight;var ce=this.$1l.sheetSize;var cf=0;var cg=0;if(ce.behavior==='exactly'){cf=ce.maxSize.width;cg=ce.maxSize.height+cd}else{var ch;var ci;var cj;var ck;switch(ce.behavior){case'range':{ch=ce.minSize.width;ci=ce.maxSize.width;cj=ce.minSize.height+cd;ck=ce.maxSize.height+cd;cf=Math.max(ch,Math.min(ci,e.width));cg=Math.max(cj,Math.min(ck,e.height));break}case'atleast':{ch=ce.minSize.width;cj=ce.minSize.height+cd;cf=Math.max(ch,e.width);cg=Math.max(cj,e.height);break}case'atmost':{ci=ce.maxSize.width;ck=ce.maxSize.height+cd;cf=Math.min(ci,e.width);cg=Math.min(ck,e.height);break}case'automatic':{cf=e.width;cg=Math.max(e.height,cd);break}default:{throw I.createInternalError('Unknown SheetSizeBehavior for viz: '+ce.behavior.toString())}}}return bv.$ctor(cf,cg)},$a:function(){var e;if(ss.isValue(this.$1a)){e=this.$1a;this.$1a=null}else{e=J.computeContentSize(this.$11())}this.$E(e);return this.$1(e)},$G:function(){if(!ss.isValue(this.$1l)){return}var e=this.$a();this.$M(e.width+'px',e.height+'px');var cd=10;for(var ce=0;ce<cd;ce++){var cf=this.$a();if(ss.referenceEquals(JSON.stringify(e),JSON.stringify(cf))){return}e=cf;this.$M(e.width+'px',e.height+'px')}throw I.create('maxVizResizeAttempts','Viz resize limit hit. The calculated iframe size did not stabilize after '+cd+' resizes.')},handleEventNotification:function(e,cd){var ce=q.deserialize(cd);switch(e){case'api.FirstVizSizeKnownEvent':{this.$h(ce);break}case'api.VizInteractiveEvent':{this.$n(ce);break}case'api.MarksSelectionChangedEvent':{this.$j(ce);break}case'api.FilterChangedEvent':{this.$g(ce);break}case'api.ParameterChangedEvent':{this.$k(ce);break}case'api.CustomViewsListLoadedEvent':{this.$f(ce);break}case'api.CustomViewUpdatedEvent':{this.$e(ce);break}case'api.CustomViewRemovedEvent':{this.$c();break}case'api.CustomViewSetDefaultEvent':{this.$d(ce);break}case'api.TabSwitchEvent':{this.$m(ce);break}case'api.StorytellingStateChangedEvent':{this.$l(ce);break}}},addEventListener:function(e,cd){var ce={};if(!l.$2(be).call(null,e,ce)){throw I.createUnsupportedEventName(e.toString())}switch(ce.$){case'marksselection':{this.$1y(cd);break}case'parametervaluechange':{this.$1A(cd);break}case'filterchange':{this.$1w(cd);break}case'customviewload':{this.$1o(cd);break}case'customviewsave':{this.$1s(cd);break}case'customviewremove':{this.$1q(cd);break}case'customviewsetdefault':{this.$1u(cd);break}case'tabswitch':{this.$1E(cd);break}case'storypointswitch':{this.$1C(cd);break}case'vizresize':{this.$1G(cd);break}}},removeEventListener:function(e,cd){var ce={};if(!l.$2(be).call(null,e,ce)){throw I.createUnsupportedEventName(e.toString())}switch(ce.$){case'marksselection':{this.$1z(cd);break}case'parametervaluechange':{this.$1B(cd);break}case'filterchange':{this.$1x(cd);break}case'customviewload':{this.$1p(cd);break}case'customviewsave':{this.$1t(cd);break}case'customviewremove':{this.$1r(cd);break}case'customviewsetdefault':{this.$1v(cd);break}case'tabswitch':{this.$1F(cd);break}case'storypointswitch':{this.$1D(cd);break}case'vizresize':{this.$1H(cd);break}}},$7:function(){if(ss.isValue(this.$19)){this.$19.parentNode.removeChild(this.$19);this.$19=null}K.$2(this.$1k);this.$1e.get_router().unregisterHandler(this);this.$H()},$O:function(){this.$19.style.display='block';this.$19.style.visibility='visible'},$o:function(){this.$19.style.display='none'},$r:function(){this.$19.style.visibility='hidden'},$S:function(){this.$q('showExportImageDialog')},$R:function(e){var cd=this.$W(e);this.$q('showExportDataDialog',cd)},$Q:function(e){var cd=this.$W(e);this.$q('showExportCrosstabDialog',cd)},$T:function(){this.$q('showExportPDFDialog')},$J:function(){var e=new tab._Deferred;var cd=new(ss.makeGenericType(bg,[Object]))('api.RevertAllCommand',1,function(ce){e.resolve()},function(ce,cf){e.reject(I.createServerError(cf))});this._sendCommand(Object).call(this,null,cd);return e.get_promise()},$F:function(){var e=new tab._Deferred;var cd=new(ss.makeGenericType(bg,[Object]))('api.RefreshDataCommand',1,function(ce){e.resolve()},function(ce,cf){e.reject(I.createServerError(cf))});this._sendCommand(Object).call(this,null,cd);return e.get_promise()},$U:function(){this.$q('showShareDialog')},$P:function(){if(this.get__workbookImpl().get_isDownloadAllowed()){this.$q('showDownloadWorkbookDialog')}else{throw I.create('downloadWorkbookNotAllowed','Download workbook is not allowed')}},$v:function(){return this.$p('pauseAutomaticUpdates')},$I:function(){return this.$p('resumeAutomaticUpdates')},$V:function(){return this.$p('toggleAutomaticUpdates')},$N:function(e,cd){this.$E(bv.$ctor(-1,-1));this.$M(e,cd);this.$1n._updateActiveSheetAsync()},$L:function(e){this.$17=e},$3:function(){return this.$1i.parentElement},$4:function(){try{K.$0(this.$1k)}catch(cd){var e=ss.Exception.wrap(cd);this.$7();throw e}if(!this.$1i.fixedSize){this.$1a=J.computeContentSize(this.$11());if(this.$1a.width===0||this.$1a.height===0){this.$1a=bv.$ctor(800,600)}this.$19=this.$5();this.$r();if(this.$1i.displayStaticImage){this.$1j=this.$6(this.$1a);this.$1j.style.display='block'}}else{if(this.$1i.displayStaticImage){this.$1j=this.$6(bv.$ctor(parseInt(this.$1i.width),parseInt(this.$1i.height)));this.$1j.style.display='block'}this.$19=this.$5();this.$O()}if(!J.hasWindowPostMessage()){if(J.isIE()){this.$19['onreadystatechange']=this.$b()}else{this.$19.onload=this.$b()}}this.$1d=!this.$1i.toolbar;this.$18=!this.$1i.tabs;this.$1e.get_router().registerHandler(this);this.$19.src=this.$1i.get_url()},$K:function(){try{if(!J.hasWindowPostMessage()||ss.isNullOrUndefined(this.$19)||!ss.isValue(this.$19.contentWindow)){return}}catch(cf){return}var e=J.visibleContentRectInDocumentCoordinates(this.get_iframe());var cd=J.contentRectInDocumentCoordinates(this.get_iframe());var ce=[];ce.push('layoutInfoResp'.toString());ce.push(e.left-cd.left);ce.push(e.top-cd.top);ce.push(e.width);ce.push(e.height);this.$19.contentWindow.postMessage(ce.join(','),'*')},$8:function(){if(!J.hasWindowPostMessage()||ss.isNullOrUndefined(this.$19)||!ss.isValue(this.$19.contentWindow)){return}this.$19.contentWindow.postMessage('tableau.enableVisibleRectCommunication'.toString(),'*')},_sendCommand:function(e){return function(cd,ce){this.$1e.sendCommand(e).call(this.$1e,cd,ce)}},$B:function(e){if(!ss.staticEquals(this.$1$5,null)){this.$1$5(new br('parametervaluechange',this.$1k,e))}},$w:function(e){this.get__workbookImpl()._update(ss.mkdel(this,function(){if(!ss.staticEquals(this.$1$6,null)){this.$1$6(new bi('customviewload',this.$1k,(ss.isValue(e)?e._impl:null)))}}))},$y:function(e){this.get__workbookImpl()._update(ss.mkdel(this,function(){if(!ss.staticEquals(this.$1$7,null)){this.$1$7(new bi('customviewsave',this.$1k,e._impl))}}))},$x:function(e){if(!ss.staticEquals(this.$1$8,null)){this.$1$8(new bi('customviewremove',this.$1k,e._impl))}},$z:function(e){if(!ss.staticEquals(this.$1$9,null)){this.$1$9(new bi('customviewsetdefault',this.$1k,e._impl))}},$D:function(e,cd){if(!ss.staticEquals(this.$1$10,null)){this.$1$10(new bz('tabswitch',this.$1k,e,cd))}},raiseStoryPointSwitch:function(e,cd){if(!ss.staticEquals(this.$1$11,null)){this.$1$11(new bx('storypointswitch',this.$1k,e,cd))}},$C:function(){if(!ss.staticEquals(this.$1$2,null)){this.$1$2(this)}},$A:function(){if(!ss.staticEquals(this.$1$1,null)){this.$1$1(this)}},$E:function(e){if(!ss.staticEquals(this.$1$12,null)){this.$1$12(new bB('vizresize',this.$1k,e))}},$M:function(e,cd){this.$1i.width=e;this.$1i.height=cd;this.$19.style.width=this.$1i.width;this.$19.style.height=this.$1i.height},$W:function(e){if(ss.isNullOrUndefined(e)){return null}var cd=this.$1n.$4(e);if(ss.isNullOrUndefined(cd)){throw I.createNotActiveSheet()}return cd.get_name()},$p:function(e){if(e!=='pauseAutomaticUpdates'&&e!=='resumeAutomaticUpdates'&&e!=='toggleAutomaticUpdates'){throw I.createInternalError(null)}var cd={};cd['api.invokeCommandName']=e;var ce=new tab._Deferred;var cf=new(ss.makeGenericType(bg,[Object]))('api.InvokeCommandCommand',0,ss.mkdel(this,function(cg){if(ss.isValue(cg)&&ss.isValue(cg.isAutoUpdate)){this.$17=!cg.isAutoUpdate}ce.resolve(this.$17)}),function(cg,ch){ce.reject(I.createServerError(ch))});this._sendCommand(Object).call(this,cd,cf);return ce.get_promise()},$q:function(e,cd){if(e!=='showExportImageDialog'&&e!=='showExportDataDialog'&&e!=='showExportCrosstabDialog'&&e!=='showExportPDFDialog'&&e!=='showShareDialog'&&e!=='showDownloadWorkbookDialog'){throw I.createInternalError(null)}var ce={};ce['api.invokeCommandName']=e;if(ss.isValue(cd)){ce['api.invokeCommandParam']=cd}var cf=new(ss.makeGenericType(bg,[Object]))('api.InvokeCommandCommand',0,null,null);this._sendCommand(Object).call(this,ce,cf)},$h:function(e){var cd=JSON.parse(e.get_data());this.$i(cd)},$n:function(e){if(ss.isValue(this.$1n)&&ss.referenceEquals(this.$1n.get_name(),e.get_workbookName())){this.$u(null)}else{this.$C()}},$j:function(e){if(ss.staticEquals(this.$1$3,null)||!ss.referenceEquals(this.$1n.get_name(),e.get_workbookName())){return}var cd=null;var ce=this.$1n.get_activeSheetImpl();if(ce.get_isStory()){ce=ce.get_activeStoryPointImpl().get_containedSheetImpl()}if(ss.referenceEquals(ce.get_name(),e.get_worksheetName())){cd=ce}else if(ce.get_isDashboard()){var cf=ce;cd=cf.get_worksheets()._get(e.get_worksheetName())._impl}if(ss.isValue(cd)){cd.set_selectedMarks(null);this.$1$3(new bq('marksselection',this.$1k,cd))}},$g:function(e){if(!ss.staticEquals(this.$1$4,null)){if(ss.referenceEquals(this.$1n.get_name(),e.get_workbookName())){var cd=null;var ce=this.$1n.get_activeSheetImpl();if(ss.referenceEquals(ce.get_name(),e.get_worksheetName())){cd=ce}else if(ce.get_isDashboard()){var cf=ce;cd=cf.get_worksheets()._get(e.get_worksheetName())._impl}if(ss.isValue(cd)){var cg=JSON.parse(e.get_data());var ch=cg[0];var ci=cg[1];this.$1$4(new bm('filterchange',this.$1k,cd,ch,ci))}}}},$k:function(e){if(!ss.staticEquals(this.$1$5,null)){if(ss.referenceEquals(this.$1n.get_name(),e.get_workbookName())){this.$1n.$l(null);var cd=e.get_data();this.$B(cd)}}},$f:function(e){var cd=JSON.parse(e.get_data());var ce=ss.mkdel(this,function(){u._processCustomViews(this.$1n,this.$1e,cd)});var cf=ss.mkdel(this,function(){this.$A();if(!ss.staticEquals(this.$1$6,null)&&!cd.customViewLoaded){this.$w(this.$1n.get_activeCustomView())}});if(ss.isNullOrUndefined(this.$1n)){this.$1b=true;this.$1n=new M(this,this.$1e,ss.mkdel(this,function(){ce();this.$u(cf);this.$1b=false}))}else{ce();this.$9(cf)}},$e:function(e){var cd=JSON.parse(e.get_data());if(ss.isNullOrUndefined(this.$1n)){this.$1n=new M(this,this.$1e,null)}if(ss.isValue(this.$1n)){u._processCustomViewUpdate(this.$1n,this.$1e,cd,true)}if(!ss.staticEquals(this.$1$7,null)){var ce=this.$1n.$p()._toApiCollection();for(var cf=0,cg=ce.length;cf<cg;cf++){this.$y(ce[cf])}}},$c:function(){if(!ss.staticEquals(this.$1$8,null)){var e=this.$1n.$n()._toApiCollection();for(var cd=0,ce=e.length;cd<ce;cd++){this.$x(e[cd])}}},$d:function(e){var cd=JSON.parse(e.get_data());if(ss.isValue(this.$1n)){u._processCustomViews(this.$1n,this.$1e,cd)}if(!ss.staticEquals(this.$1$9,null)&&ss.isValue(cd.defaultCustomViewId)){var ce=this.$1n.$i();for(var cf=0;cf<ce.get__length();cf++){var cg=ce.get_item(cf);if(cg.getDefault()){this.$z(cg);break}}}},$m:function(e){this.$1n._update(ss.mkdel(this,function(){if(ss.isValue(this.$16)){this.$16()}if(ss.referenceEquals(this.$1n.get_name(),e.get_workbookName())){var cd=e.get_worksheetName();var ce=e.get_data();this.$D(cd,ce)}this.$u(null)}))},$l:function(e){var cd=this.$1n.get_activeSheetImpl();if(cd.get_sheetType()==='story'){cd.update(JSON.parse(e.get_data()))}},$u:function(e){if(!this.$1f){var cd=this.$1g;window.setTimeout(ss.mkdel(this,function(){if(!ss.staticEquals(cd,null)){cd(new by('firstinteractive',this.$1k))}if(!ss.staticEquals(e,null)){e()}}),0);this.$1f=true}this.$C()},$9:function(e){var cd=new Date;var ce=null;ce=ss.mkdel(this,function(){var cf=new Date;if(this.$1f){e()}else if(cf-cd>300000){throw I.createInternalError('Timed out while waiting for the viz to become interactive')}else{window.setTimeout(ce,10)}});ce()},$2:function(){if(J.isIE()){if(this.$19['readyState']==='complete'){this.handleVizLoad()}}else{this.handleVizLoad()}},$s:function(){window.setTimeout(ss.mkdel(this,this.$2),3000)},$6:function(e){var cd=document.createElement('div');cd.style.background="transparent url('"+this.$1i.staticImageUrl+"') no-repeat scroll 0 0";cd.style.left='8px';cd.style.top=(this.$1i.tabs?'31px':'9px');cd.style.position='absolute';cd.style.width=e.width+'px';cd.style.height=e.height+'px';this.$3().appendChild(cd);return cd},$5:function(){if(ss.isNullOrUndefined(this.$3())){return null}var e=document.createElement('IFrame');e.frameBorder='0';e.setAttribute('allowTransparency','true');e.marginHeight='0';e.marginWidth='0';e.style.display='block';if(this.$1i.fixedSize){e.style.width=this.$1i.width;e.style.height=this.$1i.height}else{e.style.width='1px';e.style.height='1px';e.setAttribute('scrolling','no')}if(J.isSafari()){e.addEventListener('mousewheel',ss.mkdel(this,this.$t),false)}this.$3().appendChild(e);return e},$t:function(e){},$b:function(){return ss.mkdel(this,function(e){this.$s()})},$i:function(e){var cd=bu.fromSizeConstraints(e.sizeConstraints);this.$1l=bC.$ctor(cd,e.chromeHeight);if(ss.isValue(this.$1h)){this.$1h(new bn('firstvizsizeknown',this.$1k,this.$1l))}if(this.$1i.fixedSize){return}this.$G();this.$0();this.$O()},$H:function(){if(ss.isNullOrUndefined(this.$1m)){return}if(J.hasWindowAddEventListener()){window.removeEventListener('resize',this.$1m,false)}else{window.self.detachEvent('onresize',this.$1m)}this.$1m=null},$0:function(){if(ss.isValue(this.$1m)){return}this.$1m=ss.mkdel(this,function(){this.$G()});if(J.hasWindowAddEventListener()){window.addEventListener('resize',this.$1m,false)}else{window.self.attachEvent('onresize',this.$1m)}}},null,[bo]);ss.initClass(bB,a,{getAvailableSize:function(){return this.$2}},by);ss.initClass(bC,a,{},Object);ss.initClass(bM,a,{getFilterType:function(){return this.$6},getFieldName:function(){return this.$1},getWorksheet:function(){return this.$7.get_worksheet()},getFieldAsync:function(){var e=new tab._Deferred;if(ss.isNullOrUndefined(this.$3)){var cd=function(cf){e.reject(cf);return null};var ce=ss.mkdel(this,function(cf){this.$3=new bL(cf,this.$1,this.$5,this.$4);e.resolve(this.$3);return null});this.$7.$p(this.$2).then(ce,cd)}else{window.setTimeout(ss.mkdel(this,function(){e.resolve(this.$3)}),0)}return e.get_promise()},_update:function(e){this.$0(e);this._updateFromJson(e)},_addFieldParams:function(e){},_updateFromJson:null,$0:function(e){this.$1=e.caption;this.$6=R.convertFilterType(e.filterType);this.$3=null;this.$2=e.dataSourceName;this.$5=R.convertFieldRole(ss.coalesce(e.fieldRole,'unknown'));this.$4=R.convertFieldAggregation(ss.coalesce(e.fieldAggregation,'NONE'))}});ss.initClass(bE,a,{getIsExcludeMode:function(){return this.$a},getAppliedValues:function(){return this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$a=e.isExclude;if(ss.isValue(e.appliedValues)){this.$9=[];for(var cd=0;cd<e.appliedValues.length;cd++){var ce=e.appliedValues[cd];this.$9.push(J.getDataValue(ce))}}}},bM);ss.initClass(bF,a,{getFieldName:function(){return this.$0.get_fieldName()},getDataType:function(){return this.$0.get_dataType()},getIsReferenced:function(){return this.$0.get_isReferenced()},getIndex:function(){return this.$0.get_index()}});ss.initClass(bG,a,{getWorkbook:function(){return this._impl.$b()},getUrl:function(){return this._impl.$a()},getName:function(){return this._impl.$7()},setName:function(e){this._impl.$8(e)},getOwnerName:function(){return this._impl.$9()},getAdvertised:function(){return this._impl.$3()},setAdvertised:function(e){this._impl.$4(e)},getDefault:function(){return this._impl.$6()},saveAsync:function(){return this._impl.$2()}});ss.initClass(bT,a,{getName:function(){return this._impl.get_name()},getIndex:function(){return this._impl.get_index()},getWorkbook:function(){return this._impl.get_workbookImpl().get_workbook()},getSize:function(){return this._impl.get_size()},getIsHidden:function(){return this._impl.get_isHidden()},getIsActive:function(){return this._impl.get_isActive()},getSheetType:function(){return this._impl.get_sheetType()},getUrl:function(){return this._impl.get_url()},changeSizeAsync:function(e){return this._impl.changeSizeAsync(e)}});ss.initClass(bH,a,{getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getObjects:function(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function(){return this._impl.get_worksheets()._toApiCollection()}},bT);ss.initClass(bI,a,{getObjectType:function(){return this.$2.objectType},getDashboard:function(){return this.$0},getWorksheet:function(){return this.$1},getPosition:function(){return this.$2.position},getSize:function(){return this.$2.size}});ss.initClass(bJ,a,{getName:function(){return this.$0.get_name()},getFields:function(){return this.$0.get_fields()._toApiCollection()},getIsPrimary:function(){return this.$0.get_isPrimary()}});ss.initClass(bK,a,{getName:function(){return this.$0.get_name()},getData:function(){return this.$0.get_rows()},getColumns:function(){return this.$0.get_columns()},getTotalRowCount:function(){return this.$0.get_totalRowCount()},getIsSummaryData:function(){return this.$0.get_isSummaryData()}});ss.initClass(bL,a,{getDataSource:function(){return this.$0},getName:function(){return this.$3},getRole:function(){return this.$2},getAggregation:function(){return this.$1}});ss.initClass(bN,a,{_addFieldParams:function(e){e['api.filterHierarchicalLevels']=this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$9=e.levels}},bM);ss.initClass(bO,a,{getPairs:function(){return this.$0.$1()}});ss.initClass(bP,a,{});ss.initClass(bQ,a,{getName:function(){return this._impl.$7()},getCurrentValue:function(){return this._impl.$2()},getDataType:function(){return this._impl.$3()},getAllowableValuesType:function(){return this._impl.$1()},getAllowableValues:function(){return this._impl.$0()},getMinValue:function(){return this._impl.$6()},getMaxValue:function(){return this._impl.$5()},getStepSize:function(){return this._impl.$9()},getDateStepPeriod:function(){return this._impl.$4()}});ss.initClass(bR,a,{getMin:function(){return this.$d},getMax:function(){return this.$c},getIncludeNullValues:function(){return this.$b},getDomainMin:function(){return this.$a},getDomainMax:function(){return this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$a=J.getDataValue(e.domainMinValue);this.$9=J.getDataValue(e.domainMaxValue);this.$d=J.getDataValue(e.minValue);this.$c=J.getDataValue(e.maxValue);this.$b=e.includeNullValues}},bM);ss.initClass(bS,a,{getPeriod:function(){return this.$9},getRange:function(){return this.$b},getRangeN:function(){return this.$a},_updateFromJson:function(e){this.$8(e)},$8:function(e){if(ss.isValue(e.periodType)){this.$9=R.convertPeriodType(ss.unbox(e.periodType))}if(ss.isValue(e.rangeType)){this.$b=R.convertDateRange(ss.unbox(e.rangeType))}if(ss.isValue(e.rangeN)){this.$a=ss.unbox(e.rangeN)}}},bM);ss.initClass(bU,a,{getName:function(){return this.$0.name},getSheetType:function(){return this.$0.sheetType},getSize:function(){return this.$0.size},getIndex:function(){return this.$0.index},getUrl:function(){return this.$0.url},getIsActive:function(){return this.$0.isActive},getIsHidden:function(){return this.$0.isHidden},getWorkbook:function(){return this.$0.workbook}});ss.initClass(bV,a,{getActiveStoryPoint:function(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function(e){return this._impl.activateStoryPointAsync(e)},revertStoryPointAsync:function(e){return this._impl.revertStoryPointAsync(e)}},bT);ss.initClass(bW,a,{getCaption:function(){return this.$0.get_caption()},getContainedSheet:function(){return(ss.isValue(this.$0.get_containedSheetImpl())?this.$0.get_containedSheetImpl().get_sheet():null)},getIndex:function(){return this.$0.get_index()},getIsActive:function(){return this.$0.get_isActive()},getIsUpdated:function(){return this.$0.get_isUpdated()},getParentStory:function(){return this.$0.get_parentStoryImpl().get_story()}});ss.initClass(bX,a,{getCaption:function(){return this._impl.caption},getIndex:function(){return this._impl.index},getIsActive:function(){return this._impl.isActive},getIsUpdated:function(){return this._impl.isUpdated},getParentStory:function(){return this._impl.parentStoryImpl.get_story()}});ss.initClass(bY,a,{getMajor:function(){return this.$0},getMinor:function(){return this.$2},getPatch:function(){return this.$3},getMetadata:function(){return this.$1},toString:function(){var e=this.$0+'.'+this.$2+'.'+this.$3;if(ss.isValue(this.$1)&&this.$1.length>0){e+='-'+this.$1}return e}});ss.initClass(bZ,a,{getAreTabsHidden:function(){return this._impl.$Y()},getIsToolbarHidden:function(){return this._impl.$10()},getIsHidden:function(){return this._impl.$Z()},getInstanceId:function(){return this._impl.get_instanceId()},getParentElement:function(){return this._impl.$11()},getUrl:function(){return this._impl.$12()},getVizSize:function(){return this._impl.$14()},getWorkbook:function(){return this._impl.$15()},getAreAutomaticUpdatesPaused:function(){return this._impl.$X()},getCurrentUrlAsync:function(){return this._impl.getCurrentUrlAsync()},addEventListener:function(e,cd){this._impl.addEventListener(e,cd)},removeEventListener:function(e,cd){this._impl.removeEventListener(e,cd)},dispose:function(){this._impl.$7()},show:function(){this._impl.$O()},hide:function(){this._impl.$o()},showExportDataDialog:function(e){this._impl.$R(e)},showExportCrossTabDialog:function(e){this._impl.$Q(e)},showExportImageDialog:function(){this._impl.$S()},showExportPDFDialog:function(){this._impl.$T()},revertAllAsync:function(){return this._impl.$J()},refreshDataAsync:function(){return this._impl.$F()},showShareDialog:function(){this._impl.$U()},showDownloadWorkbookDialog:function(){this._impl.$P()},pauseAutomaticUpdatesAsync:function(){return this._impl.$v()},resumeAutomaticUpdatesAsync:function(){return this._impl.$I()},toggleAutomaticUpdatesAsync:function(){return this._impl.$V()},refreshSize:function(){this._impl.$G()},setFrameSize:function(e,cd){var ce=e;var cf=cd;if(J.isNumber(e)){ce=e.toString()+'px'}if(J.isNumber(cd)){cf=cd.toString()+'px'}this._impl.$N(ce,cf)}});ss.initClass(ca,a,{});ss.initClass(cb,a,{getViz:function(){return this.$0.get_viz()},getPublishedSheetsInfo:function(){return this.$0.get_publishedSheets()._toApiCollection()},getName:function(){return this.$0.get_name()},getActiveSheet:function(){return this.$0.get_activeSheetImpl().get_sheet()},getActiveCustomView:function(){return this.$0.get_activeCustomView()},activateSheetAsync:function(e){return this.$0._setActiveSheetAsync(e)},revertAllAsync:function(){return this.$0._revertAllAsync()},getCustomViewsAsync:function(){return this.$0.$6()},showCustomViewAsync:function(e){return this.$0.$f(e)},removeCustomViewAsync:function(e){return this.$0.$c(e)},rememberCustomViewAsync:function(e){return this.$0.$b(e)},setActiveCustomViewAsDefaultAsync:function(){return this.$0.$e()},getParametersAsync:function(){return this.$0.$7()},changeParameterValueAsync:function(e,cd){return this.$0.$2(e,cd)}});ss.initClass(cc,a,{getParentDashboard:function(){return this._impl.get_parentDashboard()},getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function(){return this._impl.$q()},getFilterAsync:function(e,cd){return this._impl.$r(null,e,cd)},getFiltersAsync:function(e){return this._impl.$s(e)},applyFilterAsync:function(e,cd,ce,cf){return this._impl.$e(e,cd,ce,cf)},clearFilterAsync:function(e){return this._impl.$m(e)},applyRangeFilterAsync:function(e,cd){return this._impl.$i(e,cd)},applyRelativeDateFilterAsync:function(e,cd){return this._impl.$k(e,cd)},applyHierarchicalFilterAsync:function(e,cd,ce,cf){return this._impl.$g(e,cd,ce,cf)},clearSelectedMarksAsync:function(){return this._impl.$o()},selectMarksAsync:function(e,cd,ce){return this._impl.$x(e,cd,ce)},getSelectedMarksAsync:function(){return this._impl.$t()},getSummaryDataAsync:function(e){return this._impl.$u(e)},getUnderlyingDataAsync:function(e){return this._impl.$v(e)}},bT);(function(){o.crossDomainEventNotificationId='xdomainSourceId';o.$0=0})();(function(){K.$5=[]})();(function(){z.$0='array';z.$1='boolean';z.$2='date';z.$3='function';z.$4='number';z.$5='object';z.$6='regexp';z.$7='string';z.$8=ss.mkdict(['[object Boolean]','boolean','[object Number]','number','[object String]','string','[object Function]','function','[object Array]','array','[object Date]','date','[object RegExp]','regexp','[object Object]','object']);z.$e=String.prototype['trim'];z.$d=Object.prototype['toString'];z.$f=new RegExp('^[\\s\\xA0]+');z.$g=new RegExp('[\\s\\xA0]+$');z.$a=new RegExp('^[\\],:{}\\s]*$');z.$b=new RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})','g');z.$c=new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?','g');z.$9=new RegExp('(?:^|:|,)(?:\\s*\\[)+','g')})();(function(){var e=global.tableauSoftware;e.DeviceType={DEFAULT:'default',DESKTOP:'desktop',TABLET:'tablet',PHONE:'phone'};e.DashboardObjectType={BLANK:'blank',WORKSHEET:'worksheet',QUICK_FILTER:'quickFilter',PARAMETER_CONTROL:'parameterControl',PAGE_FILTER:'pageFilter',LEGEND:'legend',TITLE:'title',TEXT:'text',IMAGE:'image',WEB_PAGE:'webPage'};e.DataType={FLOAT:'float',INTEGER:'integer',STRING:'string',BOOLEAN:'boolean',DATE:'date',DATETIME:'datetime'};e.DateRangeType={LAST:'last',LASTN:'lastn',NEXT:'next',NEXTN:'nextn',CURR:'curr',TODATE:'todate'};e.ErrorCode={INTERNAL_ERROR:'internalError',SERVER_ERROR:'serverError',INVALID_AGGREGATION_FIELD_NAME:'invalidAggregationFieldName',INVALID_PARAMETER:'invalidParameter',INVALID_URL:'invalidUrl',STALE_DATA_REFERENCE:'staleDataReference',VIZ_ALREADY_IN_MANAGER:'vizAlreadyInManager',NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:'noUrlOrParentElementNotFound',INVALID_FILTER_FIELDNAME:'invalidFilterFieldName',INVALID_FILTER_FIELDVALUE:'invalidFilterFieldValue',INVALID_FILTER_FIELDNAME_OR_VALUE:'invalidFilterFieldNameOrValue',FILTER_CANNOT_BE_PERFORMED:'filterCannotBePerformed',NOT_ACTIVE_SHEET:'notActiveSheet',INVALID_CUSTOM_VIEW_NAME:'invalidCustomViewName',MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:'missingRangeNForRelativeDateFilters',MISSING_MAX_SIZE:'missingMaxSize',MISSING_MIN_SIZE:'missingMinSize',MISSING_MINMAX_SIZE:'missingMinMaxSize',INVALID_SIZE:'invalidSize',INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:'invalidSizeBehaviorOnWorksheet',SHEET_NOT_IN_WORKBOOK:'sheetNotInWorkbook',INDEX_OUT_OF_RANGE:'indexOutOfRange',DOWNLOAD_WORKBOOK_NOT_ALLOWED:'downloadWorkbookNotAllowed',NULL_OR_EMPTY_PARAMETER:'nullOrEmptyParameter',BROWSER_NOT_CAPABLE:'browserNotCapable',UNSUPPORTED_EVENT_NAME:'unsupportedEventName',INVALID_DATE_PARAMETER:'invalidDateParameter',INVALID_SELECTION_FIELDNAME:'invalidSelectionFieldName',INVALID_SELECTION_VALUE:'invalidSelectionValue',INVALID_SELECTION_DATE:'invalidSelectionDate',NO_URL_FOR_HIDDEN_WORKSHEET:'noUrlForHiddenWorksheet',MAX_VIZ_RESIZE_ATTEMPTS:'maxVizResizeAttempts'};e.FieldAggregationType={SUM:'SUM',AVG:'AVG',MIN:'MIN',MAX:'MAX',STDEV:'STDEV',STDEVP:'STDEVP',VAR:'VAR',VARP:'VARP',COUNT:'COUNT',COUNTD:'COUNTD',MEDIAN:'MEDIAN',ATTR:'ATTR',NONE:'NONE',PERCENTILE:'PERCENTILE',YEAR:'YEAR',QTR:'QTR',MONTH:'MONTH',DAY:'DAY',HOUR:'HOUR',MINUTE:'MINUTE',SECOND:'SECOND',WEEK:'WEEK',WEEKDAY:'WEEKDAY',MONTHYEAR:'MONTHYEAR',MDY:'MDY',END:'END',TRUNC_YEAR:'TRUNC_YEAR',TRUNC_QTR:'TRUNC_QTR',TRUNC_MONTH:'TRUNC_MONTH',TRUNC_WEEK:'TRUNC_WEEK',TRUNC_DAY:'TRUNC_DAY',TRUNC_HOUR:'TRUNC_HOUR',TRUNC_MINUTE:'TRUNC_MINUTE',TRUNC_SECOND:'TRUNC_SECOND',QUART1:'QUART1',QUART3:'QUART3',SKEWNESS:'SKEWNESS',KURTOSIS:'KURTOSIS',INOUT:'INOUT',SUM_XSQR:'SUM_XSQR',USER:'USER'};e.FieldRoleType={DIMENSION:'dimension',MEASURE:'measure',UNKNOWN:'unknown'};e.FilterUpdateType={ALL:'all',REPLACE:'replace',ADD:'add',REMOVE:'remove'};e.FilterType={CATEGORICAL:'categorical',QUANTITATIVE:'quantitative',HIERARCHICAL:'hierarchical',RELATIVEDATE:'relativedate'};e.NullOption={NULL_VALUES:'nullValues',NON_NULL_VALUES:'nonNullValues',ALL_VALUES:'allValues'};e.ParameterAllowableValuesType={ALL:'all',LIST:'list',RANGE:'range'};e.ParameterDataType={FLOAT:'float',INTEGER:'integer',STRING:'string',BOOLEAN:'boolean',DATE:'date',DATETIME:'datetime'};e.PeriodType={YEAR:'year',QUARTER:'quarter',MONTH:'month',WEEK:'week',DAY:'day',HOUR:'hour',MINUTE:'minute',SECOND:'second'};e.SelectionUpdateType={REPLACE:'replace',ADD:'add',REMOVE:'remove'};e.SheetSizeBehavior={AUTOMATIC:'automatic',EXACTLY:'exactly',RANGE:'range',ATLEAST:'atleast',ATMOST:'atmost'};e.SheetType={WORKSHEET:'worksheet',DASHBOARD:'dashboard',STORY:'story'};e.TableauEventName={CUSTOM_VIEW_LOAD:'customviewload',CUSTOM_VIEW_REMOVE:'customviewremove',CUSTOM_VIEW_SAVE:'customviewsave',CUSTOM_VIEW_SET_DEFAULT:'customviewsetdefault',FILTER_CHANGE:'filterchange',FIRST_INTERACTIVE:'firstinteractive',FIRST_VIZ_SIZE_KNOWN:'firstvizsizeknown',MARKS_SELECTION:'marksselection',PARAMETER_VALUE_CHANGE:'parametervaluechange',STORY_POINT_SWITCH:'storypointswitch',TAB_SWITCH:'tabswitch',VIZ_RESIZE:'vizresize'};e.ToolbarPosition={TOP:'top',BOTTOM:'bottom'}})();(function(){p.$4=null;p.$5=null})();(function(){D.noZoneId=4294967295})();(function(){N.$5=new RegExp('\\[[^\\]]+\\]\\.','g')})();(function(){bY.$0=new bY(2,1,0,'null')})()})();window.tableau=window.tableauSoftware=global.tableauSoftware;tableauSoftware.Promise=tab._PromiseImpl;tab._Deferred=tab._DeferredImpl;tab._Collection=tab._CollectionImpl;tab._ApiBootstrap.initialize()})();